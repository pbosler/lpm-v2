<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>LPM: Lagrangian Particle Methods: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LPM: Lagrangian Particle Methods
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">PDE solver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LPM: Lagrangian Particle Methods Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Lagrangian Particle Methods for PDEs</p>
<h1>LPM : Lagrangian Particle Method </h1>
<p>Code associated with</p>
<blockquote class="doxtable">
<p>P. Bosler, J. Kent, R. Krasny, and C. Jablonowski. "A Lagrangian particle method with remeshing for tracer transport on the sphere," submitted to <em>Journal of Computational Physics</em>, 2015. </p>
</blockquote>
<blockquote class="doxtable">
<p>P. Bosler, L. Wang, C. Jablonowski, and R. Krasny. "A Lagrangian particle/panel method for the barotropic vorticity equation on a rotating sphere," <em>Fluid Dynamics Research</em>, 46 : 031406, 2014. </p>
</blockquote>
<blockquote class="doxtable">
<p>P. Bosler, "Particle Methods for Geophysical Flow on the Sphere," PhD Thesis, University of Michigan, 2013. </p>
</blockquote>
<p>The code may be downloaded from <a href="https://github.com/pbosler/lpm-v2">GitHub</a>. <br />
The code's documentation is produced with <a href="http://www.stack.nl/~dimitri/doxygen/">Doxygen</a> and the html version may be found at <code>lpm-v2/doc/html/index.html</code>.</p>
<h1>Design / Use </h1>
<p>The code is organized in an object-oriented style using modern Fortran. Hence, there is a class (Fortran derived data type) that corresponds to every task that the code completes. Generally, each data type has its own module file.<br />
A C++ implementation is in development.</p>
<h2>Base objects </h2>
<p>LPM provides a small library of fundamental modules that are used by the rest of the code.</p>
<ul>
<li>The <a class="el" href="group___number_kinds.html">NumberKinds</a> module defines constants used by the rest of the code, including variable kind definitions and physical constants.</li>
<li>The <a class="el" href="group___output_writer.html">OutputWriter</a> class defines methods for formatting output either for the console or ASCII files.</li>
<li>The <a class="el" href="group___logger.html">Logger module</a> class provides objects and methods for outputting to the console various types of messages from the rest of the LPM code in a parallel computing environment.</li>
<li>The <a class="el" href="group___sphere_geom.html">Spherical Geometry</a> and <a class="el" href="group___plane_geom.html">Planar Geometry</a> modules define geometric formulas for distance and areas.</li>
<li>The <a class="el" href="group___m_p_i_setup.html">MPISetup</a> module provides a type and methods for distribution other objects across MPI ranks.</li>
<li>The <a class="el" href="group___s_t_d_int_vector.html">STDIntVector</a> module provides a data type that mimics the C++ <code>std::vector&lt;int&gt;</code> class to dynamically allocate and resize integer arrays of rank 1</li>
</ul>
<h2>Particles and Fields </h2>
<p>The primary computing objects used by LPM are the Lagrangian particles, defined in the particles module, and the fields, defined in the field module.</p><ul>
<li><a class="el" href="group___particles.html">Particles</a> provide the spatial discretization of a domain and have both physical and Lagrangian coordinates.</li>
<li>A <a class="el" href="group___field.html">Field</a> may be either a scalar or vector field defined on a set of particles; fields are used to store variables (e.g., vorticity, temperature, etc.) on a set of particles.</li>
</ul>
<h2>Mesh objects </h2>
<p>While the dynamics and PDEs are solved by LPM in a ''meshfree'' context, we often find it helpful and efficient to maintain a mesh to organize our particles. Topologically two-dimensional meshes (e.g., spheres and planes) are currently implemented using triangles and quadrilaterals.</p><ul>
<li>The <a class="el" href="group___edges.html">Edges</a> module defines directed edges that connect an origin particle to a destination particle, and have a left face and a right face.</li>
<li>The <a class="el" href="group___faces.html">Faces</a> module defines polyhedral faces that have an associated list of edges and vertices.</li>
<li>The <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> module collects particles, edges, and faces, into a single mesh object. Meshes are initialized from a ''seed'' that is recursively divided until a desired spatial resolution is achieved.</li>
<li><a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> meshes may be adaptively refined using the <a class="el" href="group___refinement.html">Refinement</a> module.</li>
<li>Remesh/remap subroutines depend on a separate scattered data algorithm. Current implementations include <a class="el" href="group___b_i_v_a_r_remesh.html">BIVARRemesh</a> for planar problems and <a class="el" href="group___s_s_r_f_p_a_c_k_remesh.html">SSRFPACKRemesh</a> for spherical problems.</li>
</ul>
<h2>External libraries </h2>
<p>LPM code requires scattered data interpolation or approximation algorithms to perform its remesh/remap step. For planar applications, the bivariate quintic Hermite polynomials of the BIVAR pacakge (H. Akima, <em>ACM TOMS</em>, 1978) are used (<a class="el" href="bivar_8f90.html">bivar.f90</a>). For spherical applications, the cubic Hermite polynomials with exponential tension factors of the STRIPACK/SSRFPACK libraries (Renka, <em>ACM TOMS</em>, 1997) are used (<a class="el" href="stripack_8f.html">stripack.f</a> and <a class="el" href="ssrfpack_8f.html">ssrfpack.f</a>).</p>
<p>Other methods for scattered data approximation are under development.</p>
<h2>PDE types and Solver objects </h2>
<p>PDEs are solved using a ''method of lines'' discretization. A mesh is connected to its relevant variables by a PDE type, e.g., an SWEMesh or a <a class="el" href="group___sphere_b_v_e.html">SphereBVE</a> BVEMesh object. These objects combine a PolyMesh2d for the spatial discretization with the various Fields (e.g., vorticity, temperature) appropriate to the chosen PDE.</p>
<p>Following the spatial discretization given by the particles, the time-ODEs are integrated explicity with 4th order Runge-Kutta by a Solver (e.g., <a class="el" href="group___sphere_b_v_e_solver.html">SphereBVESolver</a>) object appropriate to a particular application, e.g., SWEPlaneSolver or SphereBVESolver.</p>
<ul>
<li>Planar, inviscid, incompressible flow: See <a class="el" href="group___planar_incompressible.html">PlanarIncompressible</a>, <a class="el" href="group___planar_incompressible_solver.html">PlanarIncompressibleSolver</a>, and <a class="el" href="_colliding_dipoles_8f90.html" title="Driver program for the problem of two colliding Lamb dipoles in the plane. ">CollidingDipoles.f90</a></li>
<li>Rotating planar, inviscid, incompressible flow: See <a class="el" href="group___beta_plane.html">BetaPlane</a>, <a class="el" href="group___beta_plane_solver.html">BetaPlaneSolver</a></li>
<li>Spherical Barotropic Vorticity Equation (BVE): See <a class="el" href="group___sphere_b_v_e.html">SphereBVE</a>, <a class="el" href="group___sphere_b_v_e_solver.html">SphereBVESolver</a>, and <a class="el" href="_b_v_e_single_gaussian_vortex_8f90.html" title="Driver program for the problem of a single Gaussian vortex on a rotating sphere. ">BVESingleGaussianVortex.f90</a></li>
<li>Rotating planar Shallow Water Equations (SWE): See <a class="el" href="group___planar_s_w_e.html">PlanarSWE</a>, <a class="el" href="group___s_w_e_plane_solver.html">SWEPlaneSolver</a>, <a class="el" href="_nitsche_strickland_8f90.html" title="Driver program for a planar SWE problem defined by a symmetric vortex and zero initial divergence...">NitscheStrickland.f90</a>, etc.</li>
</ul>
<h2>Application Drivers </h2>
<p>Finally, all of the above objects are assembled by a driver program that solves a specific problem. Within the driver program all initial conditions must be defined.</p>
<p>Run-time user input to driver programs is handled via namelist file, that is typically supplied as the first argument on the command line. See below for more discussion.</p>
<p>It is within these driver programs that the timestepping loop and remeshing procedures are called. See <a class="el" href="_plane_s_w_e_gravity_waves_8f90.html">PlaneSWEGravityWaves.f90</a> or <a class="el" href="_colliding_dipoles_8f90.html" title="Driver program for the problem of two colliding Lamb dipoles in the plane. ">CollidingDipoles.f90</a> for examples.</p>
<h1>Build / Install </h1>
<p>This latest version of LPM is written with support for KitWare's <a href="http://www.cmake.org">CMake</a> cross-platform makefile generator, to aid portability and ease installation for new users.</p>
<p>LPM requires an <a href="http://www.open-mpi.org">OpenMPI</a> distribution for parallel computing.</p>
<p>The environmental variables <code>CC</code>, <code>CXX</code>, and <code>FC</code> specify the compilers. For example, using the bash shell, these variables are set with </p><pre class="fragment">export CC=mpicc
export CXX=mpicxx
export FC=mpifort
</pre><p>LPM is configured in the same shell by navigating to the lpm-v2 root directory and typing mkdir build cd build cmake .. This configures the build for the your compiler version and MPI. Build the LPM software next by typing </p><pre class="fragment">make
</pre><p>then </p><pre class="fragment">make test
</pre><p>to run the unit tests.</p>
<h1>Running applications </h1>
<p>LPM uses Fortran's handy namelist utility to specify run-time input to programs.</p>
<p>To run an application driver, LPM executables may be run with the command </p><pre class="fragment">mpirun -np 6 &lt;LPMfile&gt;.exe  &lt;namelist file&gt;
</pre><p>This would execute the specified .exe file using 6 MPI processes and the input variables defined in the specified namelist file.</p>
<h2>Driver programs </h2>
<p>Each application is defined in its own driver program. Examples include <code><a class="el" href="_colliding_dipoles_8f90.html" title="Driver program for the problem of two colliding Lamb dipoles in the plane. ">CollidingDipoles.f90</a></code>, <code><a class="el" href="_b_v_e_single_gaussian_vortex_8f90.html" title="Driver program for the problem of a single Gaussian vortex on a rotating sphere. ">BVESingleGaussianVortex.f90</a></code>, and <code><a class="el" href="_plane_s_w_e_gravity_waves_8f90.html">PlaneSWEGravityWaves.f90</a></code>. <br />
 Driver programs are organized into three phases:</p><ol type="1">
<li><b>Initialize:</b> The computing environment is defined and initialized using appropriate calls to MPI subroutines. <br />
 User input is read from the appropriate namelist file. <br />
 The initial set of particles and their initial mesh are defined. <br />
 Initial conditions for each variable are defined on the mesh. <br />
 Any initial adaptive refinement is completed. <br />
 The initial conditions are output to data files. <br />
</li>
<li><b>Run:</b> The time step loop resides in the section of the driver. <br />
 Within the timestep loop, an <code>if</code> statement determinces whether or not a particle set needs to be remeshed and/or remapped. <br />
 Remeshing (if necessary) is completed. <br />
 Time is advanced by one time step for each iteration of the loop. <br />
 Time-dependent output is written to a data file. <br />
</li>
<li><b>Finalize:</b> Final output is written to data files. <br />
 Performance and timing data are output to console. <br />
 All LPM objects are deleted and all memory used by the driver is freed.</li>
</ol>
<p>Within the <code>contains</code> section of a driver program, users may insert functions relevant to their application. <br />
In most cases, these functions must conform to the interfaces defined in <a class="el" href="group___number_kinds.html">NumberKinds</a> and <a class="el" href="group___refinement.html">Refinement</a> . <br />
Additionally, since different applications will require different input, each driver requires its own version of the <code>ReadNamelistFile</code> subroutine. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 7 2016 18:18:06 for LPM: Lagrangian Particle Methods by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
