<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>LPM: Lagrangian Particle Method: lpm-v2</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LPM: Lagrangian Particle Method
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">PDE solver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">lpm-v2 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Lagrangian Particle Methods for PDEs</p>
<h1>LPM : Lagrangian Particle Method </h1>
<p>Code associated with</p>
<blockquote class="doxtable">
<p>P. Bosler, J. Kent, R. Krasny, and C. Jablonowski. "A Lagrangian particle method with remeshing for tracer transport on the sphere," submitted to <em>Journal of Computational Physics</em>, 2015. </p>
</blockquote>
<blockquote class="doxtable">
<p>P. Bosler, L. Wang, R. Krasny, and C. Jablonowski. "A Lagrangian particle/panel method for the barotropic vorticity equation on a rotating sphere," <em>Fluid Dynamics Research</em>, 46 : 031406, 2014. </p>
</blockquote>
<blockquote class="doxtable">
<p>P. Bosler, "Particle Methods for Geophysical Flow on the Sphere," PhD Thesis, University of Michigan, 2013. </p>
</blockquote>
<h1>Design / Use </h1>
<p>The code is organized in an object-oriented style using modern Fortran. Hence, there is a class, or Fortran derived data type, that corresponds to every task that the code completes. Generally, each data type has its own module file. A C++ implementation is in development.</p>
<h2>Base objects </h2>
<p>LPM provides a small library of fundamental modules that are used by the rest of the code.</p>
<ul>
<li>The NumberKinds module defines constants used by the rest of the code, including variable kind definitions and physical constants.</li>
<li>The OutputWriter class defines methods for formatting output either for the console or ASCII files.</li>
<li>The Logger class provides objects and methods for outputting to the console various types of messages from the rest of the LPM code in a parallel computing environment.</li>
<li>The SphereGeometry and PlaneGeometry modules define geometric formulas for distance and areas.</li>
</ul>
<h2>Particles and Fields </h2>
<p>The primary computing objects used by LPM are the Lagrangian particles, defined in the particles module, and the fields, defined in the field module.</p><ul>
<li>Particles provide the spatial discretization of a domain and have both physical and Lagrangian coordinates.</li>
<li>Fields are either scalar or vector fields defined on a set of particles; fields are used to store variables (e.g., vorticity, temperature, etc.) on a set of particles.</li>
</ul>
<h2>Mesh objects </h2>
<p>While the dynamics and PDEs are solved by LPM in a ''meshfree'' context, we often find it helpful and efficient to maintain a mesh to organize our particles. Topologically two-dimensional meshes (e.g., spheres and planes) are currently implemented using triangles and quadrilaterals.</p><ul>
<li>The Edges module defines directed edges that connect an origin particle to a destination particle, and have a left face and a right face.</li>
<li>The Faces module defines polyhedral faces that have an associated list of edges and vertices.</li>
<li>The Polymesh2d module collects particles, edges, and faces, into a single mesh object. Meshes are initialized from a ''seed'' that is recursively divided until a desired spatial resolution is achieved.</li>
<li>Polymesh2d meshes may be adaptively refined using the Refinement module.</li>
</ul>
<h2>External libraries </h2>
<p>LPM code requires scattered data interpolation or approximation algorithms to perform its remesh/remap step. For planar applications, the bivariate quintic Hermite polynomials of the BIVAR pacakge (H. Akima, ACM TOM, 1978) are used. For spherical applications, the cubic Hermite polynomials with exponential tension factors of the STRIPACK/SSRFPACK libraries (Renka, ACM TOMS, 1997) are used.</p>
<p>Other methods for scattered data approximation are under development.</p>
<h2>PDE types and Solver objects </h2>
<p>PDEs are solved using a ''method of lines'' discretization. A mesh is connected to its relevant variables by a PDE type, e.g., an SWEMesh or a BVEMesh object. Following the spatial discretization given by the particles, the time-ODEs are integrated explicity with 4th order Runge-Kutta by a Solver object appropriate to a particular application, e.g., SWEPlaneSolver or SphereBVESolver. Examples are the</p>
<h2>Drivers </h2>
<p>Finally, all of the above objects are assembled by a driver program that solves a specific problem. Within the driver program all initial conditions must be defined. It is within these programs that the timestepping loop and remeshing procedures are called. See <a class="el" href="_plane_s_w_e_gravity_waves_8f90.html">PlaneSWEGravityWaves.f90</a> or <a class="el" href="_colliding_dipoles_8f90.html">CollidingDipoles.f90</a> for examples.</p>
<h1>Build / Install </h1>
<p>This latest version of LPM is written with support for KitWare's <a href="http://www.cmake.org">CMake</a> cross-platform makefile generator, to aid portability and ease installation for new users.</p>
<p>The environmental variables <code>CC</code>, <code>CXX</code>, and <code>FC</code> specify the compilers. For example, using the bash shell, these variables are set with </p><pre class="fragment">export CC=mpicc
export CXX=mpicxx
export FC=mpifort
</pre><p>LPM is configured in the same shell by navigating to the lpm-v2 root directory and typing mkdir build cd build cmake .. This configures the build for the your compiler version and MPI. Build the LPM software next by typing </p><pre class="fragment">make
</pre><p>then </p><pre class="fragment">make test
</pre><p>to run the unit tests. To run an application driver, LPM executables may be run with the command </p><pre class="fragment">mpirun -np 6 &lt;LPMfile&gt;.exe
</pre><p>This would execute the specified .exe file using 6 MPI processes. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 5 2016 15:01:45 for LPM: Lagrangian Particle Method by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
