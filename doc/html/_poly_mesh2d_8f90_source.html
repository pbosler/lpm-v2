<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>LPM: Lagrangian Particle Methods: /Users/pabosle/lpm-v2/PolyMesh2d.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LPM: Lagrangian Particle Methods
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">PDE solver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">/Users/pabosle/lpm-v2/PolyMesh2d.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_poly_mesh2d_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="classpolymesh2dmodule.html">    1</a></span>&#160;<span class="keyword">module</span> <a class="code" href="classpolymesh2dmodule.html">polymesh2dmodule</a></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keywordtype">use </span><a class="code" href="classnumberkindsmodule.html">numberkindsmodule</a></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordtype">use </span><a class="code" href="classstdintvectormodule.html">stdintvectormodule</a></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keywordtype">use </span><a class="code" href="classoutputwritermodule.html">outputwritermodule</a></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordtype">use </span><a class="code" href="classloggermodule.html">loggermodule</a></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keywordtype">use </span><a class="code" href="classparticlesmodule.html">particlesmodule</a></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keywordtype">use </span><a class="code" href="classedgesmodule.html">edgesmodule</a></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keywordtype">use </span><a class="code" href="classfacesmodule.html">facesmodule</a></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keywordtype">use </span><a class="code" href="classplanegeommodule.html">planegeommodule</a></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keywordtype">use </span><a class="code" href="classspheregeommodule.html">spheregeommodule</a></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keywordtype">private</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keywordtype">public</span> <a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keywordtype">public</span> <a class="code" href="interfacepolymesh2dmodule_1_1new.html">new</a>, <a class="code" href="interfacepolymesh2dmodule_1_1delete.html">delete</a>, <a class="code" href="interfacepolymesh2dmodule_1_1copy.html">copy</a></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keywordtype">public</span> <a class="code" href="group___poly_mesh2d.html#ga319d43beccd27ec88cfed64503140304">locatefacecontainingpoint</a>, <a class="code" href="group___poly_mesh2d.html#gadf892dde1a232cba2c3a18ad9cf8c724">nearestparticle</a></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keywordtype">public</span> <a class="code" href="group___poly_mesh2d.html#ga11edc13fe65bab9da5046f22850948f4">pointisoutsidemesh</a></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keywordtype">public</span> <a class="code" href="group___poly_mesh2d.html#ga1117b877c1ee6f1d5f023adafdd9c4fc">ccwedgesaroundface</a>, <a class="code" href="group___poly_mesh2d.html#gaec4398a712feb200a284a04c7da490ed">ccwverticesaroundface</a>, <a class="code" href="group___poly_mesh2d.html#gafea011e46aebdf0fe0d921c625d66ee5">ccwadjacentfaces</a></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keywordtype">public</span> <a class="code" href="group___poly_mesh2d.html#gabfb6f53d3285a8e759173d4fc29f20d7">ccwfacesaroundvertex</a></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keywordtype">public</span> <a class="code" href="interfacepolymesh2dmodule_1_1logstats.html">logstats</a>, <a class="code" href="interfacepolymesh2dmodule_1_1printdebuginfo.html">printdebuginfo</a></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keywordtype">public</span> <a class="code" href="group___poly_mesh2d.html#ga80dca1b2be22f127129a06a0723de065">writemeshtomatlab</a>, <a class="code" href="group___poly_mesh2d.html#gac803dbb3b64c4971577efb6a7d1389c2">writemeshtovtkpolydata</a></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keywordtype">public</span> <a class="code" href="group___poly_mesh2d.html#gabe5ac653e50883a2ef9882c4a71db4e3">meshseedstring</a></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keywordtype">public</span> <a class="code" href="group___poly_mesh2d.html#ga468903cecff6b19516047d81fc186715">projectparticlestosphere</a></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keywordtype">public</span> <a class="code" href="group___poly_mesh2d.html#gaa27f9cec0d6def839fbf8d2f388286a9">maxlagrangianvariationperface</a></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structpolymesh2dmodule_1_1polymesh2d.html">   84</a></span>&#160;<span class="keyword">type</span> <a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga3525a5c3502c491f981db69be80ec9d5">   85</a></span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structparticlesmodule_1_1particles.html">particles</a>) :: <a class="code" href="structparticlesmodule_1_1particles.html">particles</a></div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gad59a83c725a756c42e5a17f968e3793c">   86</a></span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structedgesmodule_1_1edges.html">edges</a>) :: <a class="code" href="structedgesmodule_1_1edges.html">edges</a></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga0d07152e8dd391dcde40c6d79fa96b75">   87</a></span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structfacesmodule_1_1faces.html">faces</a>) :: <a class="code" href="structfacesmodule_1_1faces.html">faces</a></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gaf8be0bac0329deffa51b1abefbe6907c">   88</a></span>&#160;    <span class="keywordtype">integer(kint)</span> :: <a class="code" href="group___faces.html#ga3665511c613ed29b874eaaad1ca686a3">facekind</a> = 0</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga4342e4cacab8556ec18b6aea0d79cc5e">   89</a></span>&#160;    <span class="keywordtype">integer(kint)</span> :: <a class="code" href="group___particles.html#gae7a75e01ef357d8fc745565dd883acf8">geomkind</a> = 0</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gaf4f674c5eecaaf0c15c43dcf51a39b65">   90</a></span>&#160;    <span class="keywordtype">integer(kint)</span> :: <a class="code" href="group___poly_mesh2d.html#gaf4f674c5eecaaf0c15c43dcf51a39b65">meshseed</a> = 0</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gac6d0b7794f35292c47d247c65d58582b">   91</a></span>&#160;    <span class="keywordtype">integer(kint)</span> :: <a class="code" href="group___poly_mesh2d.html#gac6d0b7794f35292c47d247c65d58582b">initnest</a> = -1</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga492096c959c5c4ff457619c32a5a5ad0">   92</a></span>&#160;    <span class="keywordtype">integer(kint)</span> :: <a class="code" href="group___poly_mesh2d.html#ga492096c959c5c4ff457619c32a5a5ad0">amrlimit</a> = 0</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga082e5d07a4b57d70132a42b514cdec79">   93</a></span>&#160;    <span class="keywordtype">real(kreal)</span> :: <a class="code" href="group___poly_mesh2d.html#ga082e5d07a4b57d70132a42b514cdec79">t</a> = 0.0_kreal</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">contains</span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga591f98380900bc3ddd2b26a5ccfdb14f">   96</a></span>&#160;        final :: <a class="code" href="group___beta_plane.html#ga84602b5bc0f9100a75064e074f9432fc">deleteprivate</a></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">end type</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="interfacepolymesh2dmodule_1_1new.html">   99</a></span>&#160;<span class="keyword">interface</span> <a class="code" href="interfacepolymesh2dmodule_1_1new.html">new</a></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">module procedure</span> <a class="code" href="group___beta_plane.html#ga4bae2f41688d6493cb2a5aa0b4451c86">newprivate</a></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">end interface</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="interfacepolymesh2dmodule_1_1delete.html">  103</a></span>&#160;<span class="keyword">interface</span> <a class="code" href="interfacepolymesh2dmodule_1_1delete.html">delete</a></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keyword">module procedure</span> <a class="code" href="group___beta_plane.html#ga84602b5bc0f9100a75064e074f9432fc">deleteprivate</a></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keyword">end interface</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="interfacepolymesh2dmodule_1_1copy.html">  107</a></span>&#160;<span class="keyword">interface</span> <a class="code" href="interfacepolymesh2dmodule_1_1copy.html">copy</a></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">module procedure</span> <a class="code" href="group___beta_plane.html#gaabc280102971514bee5e54008a9ee46b">copyprivate</a></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword">end interface</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="interfacepolymesh2dmodule_1_1logstats.html">  111</a></span>&#160;<span class="keyword">interface</span> <a class="code" href="interfacepolymesh2dmodule_1_1logstats.html">logstats</a></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keyword">module procedure</span> <a class="code" href="group___beta_plane.html#ga20c169b731ae61d90e833c9348cd452a">logstatsprivate</a></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keyword">end interface</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="interfacepolymesh2dmodule_1_1printdebuginfo.html">  115</a></span>&#160;<span class="keyword">interface</span> <a class="code" href="interfacepolymesh2dmodule_1_1printdebuginfo.html">printdebuginfo</a></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keyword">module procedure</span> <a class="code" href="group___edges.html#ga336ae9b8908174c080ab8c91bf665ed7">printdebugprivate</a></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">end interface</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">!----------------</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">! Logging</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">!----------------</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga305e7c1903184c4346cd5f7658afaf7f">  124</a></span>&#160;<span class="keywordtype">logical(klog)</span>, <span class="keywordtype">save</span> :: <a class="code" href="group___beta_plane.html#gab330e19580bc40d2bad4d63cf8df3bf1">loginit</a> = .false.</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gaa9f820eee4c8becbe7b08466680394c4">  125</a></span>&#160;<span class="keywordtype">type</span>(<a class="code" href="structloggermodule_1_1logger.html">logger</a>) :: <a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gab227096ab692357489ded8c024125137">  126</a></span>&#160;<span class="keywordtype">character(len=28)</span>, <span class="keywordtype">save</span> :: <a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a> = <span class="stringliteral">&#39;PolyMesh2d&#39;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gab74b7dc96dd07f10de7eeb346a745eda">  127</a></span>&#160;<span class="keywordtype">integer(kint)</span>, <span class="keywordtype">parameter</span> :: <a class="code" href="group___beta_plane.html#ga0487cc8c35598f1803a4558f2f3f706b">loglevel</a> = <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a></div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga67769e413fe9d4aac0cc5c0aad83de2e">  128</a></span>&#160;<span class="keywordtype">character(len=MAX_STRING_LENGTH)</span> :: <a class="code" href="group___beta_plane.html#ga0c09fe438e6ad416b82181c0069ebb8e">logstring</a></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keyword">contains</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gac8fa29434ceb9f6b4960adae477279f2">  135</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___beta_plane.html#ga4bae2f41688d6493cb2a5aa0b4451c86">newprivate</a>(self, meshSeed, initNest, maxNest, amrLimit, ampFactor )</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(out)</span> :: self</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: meshSeed</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: maxNest</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: initNest</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: amrLimit</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">intent(in)</span> :: ampFactor</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">integer(kint)</span> :: nMaxParticles, nMaxVertices, nMaxFaces, nMaxEdges</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i, j, startIndex, nFacesOld</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> ( .NOT. <a class="code" href="group___beta_plane.html#gab330e19580bc40d2bad4d63cf8df3bf1">loginit</a>) call <a class="code" href="_beta_plane_gaussian_vortex_8f90.html#ae520c3b11d9e6c51c35d5cd67b503523">initlogger</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___number_kinds.html#ga7c6975d710b4d578d515c3d3312043fc">procrank</a>)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    self%meshSeed = meshseed</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    self%initNest = initnest</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    self%amrLimit = amrlimit</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> ( meshseed &lt; <a class="code" href="group___number_kinds.html#gaf2cfb545db8575bc18fc6253237e73c7">tri_hex_seed</a> .OR. meshseed &gt; <a class="code" href="group___number_kinds.html#gafdb49bdf25b09548a91b78d18ff15dc8">beta_plane_seed</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>,<a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>, <a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>,<span class="stringliteral">&quot; NewMesh ERROR : invalid meshSeed.&quot;</span>)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    self%faceKind = <a class="code" href="group___poly_mesh2d.html#gafeeb682c17d2f3569c60dc52f8ef3cea">facekindfromseed</a>(meshseed)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    self%geomKind = <a class="code" href="group___poly_mesh2d.html#ga9e3a8f08670e896630624fae230a6073">geomkindfromseed</a>(meshseed)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    nmaxparticles = <a class="code" href="group___poly_mesh2d.html#gacb9154c9633d010075c5c7827de64288">nverticesinmesh</a>(self, maxnest) + <a class="code" href="group___poly_mesh2d.html#ga18991ddade171ee044e7d7dfb2694979">nfacesinmesh</a>(self, maxnest)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    nmaxvertices = 0</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    nmaxfaces = 0</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    nmaxedges = 0</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">do</span> i = 0, maxnest</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        nmaxfaces = nmaxfaces + <a class="code" href="group___poly_mesh2d.html#ga18991ddade171ee044e7d7dfb2694979">nfacesinmesh</a>(self, i)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        nmaxedges = nmaxedges + <a class="code" href="group___poly_mesh2d.html#ga515332a3f22d9fb7b09f408594eec185">nedgesinmesh</a>(self, <a class="code" href="group___poly_mesh2d.html#gacb9154c9633d010075c5c7827de64288">nverticesinmesh</a>(self,i), <a class="code" href="group___poly_mesh2d.html#ga18991ddade171ee044e7d7dfb2694979">nfacesinmesh</a>(self,i) )</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, debug_logging_level,trim(<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>)//<span class="stringliteral">&quot; allocating memory for nParticles = &quot;</span>, nmaxparticles )</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, debug_logging_level,trim(<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>)//<span class="stringliteral">&quot; allocating memory for nEdges = &quot;</span>, nmaxedges )</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, debug_logging_level,trim(<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>)//<span class="stringliteral">&quot; allocating memory for nFaces = &quot;</span>, nmaxfaces )</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, debug_logging_level,trim(<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>)//<span class="stringliteral">&quot; faceKind = &quot;</span>, self%faceKind )</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, debug_logging_level,trim(<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>)//<span class="stringliteral">&quot; geomKind = &quot;</span>, self%geomKind )</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1new.html">new</a>(self%particles, nmaxparticles, self%geomKind )</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1new.html">new</a>(self%edges, nmaxedges)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1new.html">new</a>(self%faces, self%faceKind, nmaxfaces )</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    call <a class="code" href="group___poly_mesh2d.html#ga3afe4155924faf7adf8d9bcadd5dc942">initializemeshfromseed</a>(self, ampfactor)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    startindex = 1</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">do</span> i = 1, initnest</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        nfacesold = self%faces%N</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">do</span> j = startindex, nfacesold</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">if</span> ( self%faceKind == <a class="code" href="group___number_kinds.html#gac5f366e59a1a142274f1abf9a3895188">tri_panel</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                call <a class="code" href="group___faces.html#ga6bb2ead1ad72a0789a4eef0de7d2ac02">dividetriface</a>(self%faces, j, self%particles, self%edges)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordflow">elseif</span> ( self%faceKind == <a class="code" href="group___number_kinds.html#gab3062c50a0b035fca7077f04a8e49329">quad_panel</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                call <a class="code" href="group___faces.html#gaee6c673285b09641f5a63f1f273f92f2">dividequadface</a>(self%faces,j, self%particles, self%edges)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        startindex = nfacesold + 1</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">do</span> i = 1, self%particles%N</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span> ( self%particles%isPassive(i) ) call <a class="code" href="group___particles.html#ga550e2ee3c6c4a9cc0e1c27cfb1071571">sortincidentedgesatparticle</a>( self%particles, i )</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gadd8f0d5baca6a482f0f0629eaea748c5">  199</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___beta_plane.html#ga84602b5bc0f9100a75064e074f9432fc">deleteprivate</a>(self)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(inout)</span> :: self</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1delete.html">delete</a>(self%faces)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1delete.html">delete</a>(self%edges)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1delete.html">delete</a>(self%particles)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">!   self%meshSeed = 0</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">!   self%initNest = 0</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">!   self%amrLimit = 0</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">!   self%geomKind = 0</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">!   self%faceKind = 0</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gaf268fe9ab3e99fedeaa31570ce9817f3">  215</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___beta_plane.html#gaabc280102971514bee5e54008a9ee46b">copyprivate</a>( self, other )</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(inout)</span> :: self</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: other</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    self%meshSeed = other%meshSeed</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    self%initNest = other%initNest</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    self%amrLimit = other%amrLimit</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    self%geomKind = other%geomKind</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    self%faceKind = other%faceKind</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1copy.html">copy</a>(self%particles, other%particles)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1copy.html">copy</a>(self%edges, other%edges)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1copy.html">copy</a>(self%faces, other%faces)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gaa27f9cec0d6def839fbf8d2f388286a9">  231</a></span>&#160;<span class="keyword">function </span><a class="code" href="group___poly_mesh2d.html#gaa27f9cec0d6def839fbf8d2f388286a9">maxlagrangianvariationperface</a>( self )</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">real(kreal)</span> :: MaxLagrangianVariationPerFace</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i, j</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">integer(kint)</span> :: particleIndex</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">dimension(3)</span> :: maxX0, minX0, x0</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordtype">real(kreal)</span> :: testVar</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>) :: faceVerts</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    maxlagrangianvariationperface = 0.0_kreal</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">do</span> i = 1, self%faces%N</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> ( .NOT. self%faces%hasChildren(i) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            particleindex = self%faces%centerParticle(i)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            maxx0 = <a class="code" href="group___particles.html#gad4afc4ad448d5d077be29dd1a7d1cc21">lagcoord</a>(self%particles, particleindex)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            minx0 = <a class="code" href="group___particles.html#gad4afc4ad448d5d077be29dd1a7d1cc21">lagcoord</a>(self%particles, particleindex)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="comment">!call CCWVerticesAroundFace( self, faceVerts, i )</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">do</span> j = 1, self%faceKind</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                x0 = <a class="code" href="group___particles.html#gad4afc4ad448d5d077be29dd1a7d1cc21">lagcoord</a>(self%particles, self%faces%vertices(j,i))</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <span class="keywordflow">if</span> ( x0(1) &lt; minx0(1) ) minx0(1) = x0(1)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="keywordflow">if</span> ( x0(2) &lt; minx0(2) ) minx0(2) = x0(2)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="keywordflow">if</span> ( x0(3) &lt; minx0(3) ) minx0(3) = x0(3)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <span class="keywordflow">if</span> ( x0(1) &gt; maxx0(1) ) maxx0(1) = x0(1)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keywordflow">if</span> ( x0(2) &gt; maxx0(2) ) maxx0(2) = x0(2)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="keywordflow">if</span> ( x0(3) &gt; maxx0(3) ) maxx0(3) = x0(3)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            testvar = sum(maxx0 - minx0)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordflow">if</span> ( testvar &gt; maxlagrangianvariationperface ) maxlagrangianvariationperface = testvar</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keyword">end function </span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga319d43beccd27ec88cfed64503140304">  273</a></span>&#160;<span class="keyword">function </span><a class="code" href="group___poly_mesh2d.html#ga319d43beccd27ec88cfed64503140304">locatefacecontainingpoint</a>(self, queryPt)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">integer(kint)</span> :: locateFaceContainingPoint</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">intent(in)</span> :: queryPt(:)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">integer(kint)</span> :: treeStart</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">integer(kint)</span> :: walkStart</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">!   call LogMessage(log, DEBUG_LOGGING_LEVEL, trim(logkey)//&quot; LocateFaceContainingPoint:&quot;, &quot; entering.&quot;)</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    locatefacecontainingpoint = 0</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    treestart = <a class="code" href="group___poly_mesh2d.html#ga2061ff775ab982970e84df296a749336">nearestrootface</a>(self, querypt)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    walkstart = <a class="code" href="group___poly_mesh2d.html#ga65267322a5536d5acdf15f2ec649f516">locatepointtreesearch</a>(self, querypt, treestart)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    locatefacecontainingpoint = <a class="code" href="group___poly_mesh2d.html#ga5939ae9ed03009c95328b9d189f3a3de">locatepointwalksearch</a>(self, querypt, walkstart)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> ( locatefacecontainingpoint == 0 .OR. locatefacecontainingpoint &gt; self%faces%N ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>, trim(<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>)//<span class="stringliteral">&quot;LocateFaceContainingPoint ERROR : &quot;</span>, <span class="stringliteral">&quot;bad output.&quot;</span>)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keyword">end function</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gadf892dde1a232cba2c3a18ad9cf8c724">  296</a></span>&#160;<span class="keyword">function </span><a class="code" href="group___poly_mesh2d.html#gadf892dde1a232cba2c3a18ad9cf8c724">nearestparticle</a>(self, queryPt)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">integer(kint)</span> :: nearestParticle</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">intent(in)</span> :: queryPt(:)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordtype">integer(kint)</span> :: faceIndex, i</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>) :: faceVerts</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">real(kreal)</span> :: dist, testDist</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    faceindex = <a class="code" href="group___poly_mesh2d.html#ga319d43beccd27ec88cfed64503140304">locatefacecontainingpoint</a>(self, querypt)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    call <a class="code" href="interfacestdintvectormodule_1_1initialize.html">initialize</a>(faceverts)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    call <a class="code" href="group___poly_mesh2d.html#gaec4398a712feb200a284a04c7da490ed">ccwverticesaroundface</a>( self, faceverts, faceindex)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    nearestparticle = self%faces%centerParticle(faceindex)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">if</span> ( self%geomKind == <a class="code" href="group___number_kinds.html#ga8cddcd3d76142fa9d1c20388f293e1d5">sphere_geom</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        dist  = <a class="code" href="interfacespheregeommodule_1_1spheredistance.html">spheredistance</a>( <a class="code" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd">physcoord</a>(self%particles, nearestparticle), querypt)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">do</span> i = 1, faceverts%N</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            testdist = <a class="code" href="interfacespheregeommodule_1_1spheredistance.html">spheredistance</a>( <a class="code" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd">physcoord</a>(self%particles, faceverts%int(i)), querypt)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">if</span> ( testdist &lt; dist ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                dist = testdist</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                nearestparticle = faceverts%int(i)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        dist = <a class="code" href="group___sphere_geom.html#ga842d3856281acd8492c9b00a4804f67b">chorddistance</a>( <a class="code" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd">physcoord</a>(self%particles, nearestparticle), querypt)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">do</span> i = 1, faceverts%N</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            testdist = <a class="code" href="group___sphere_geom.html#ga842d3856281acd8492c9b00a4804f67b">chorddistance</a>( <a class="code" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd">physcoord</a>( self%particles, faceverts%int(i)), querypt)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">if</span> ( testdist &lt; dist ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                dist = testdist</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                nearestparticle = faceverts%int(i)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keyword">end function</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga1117b877c1ee6f1d5f023adafdd9c4fc">  336</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___poly_mesh2d.html#ga1117b877c1ee6f1d5f023adafdd9c4fc">ccwedgesaroundface</a>( self, leafEdges, faceIndex )</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>), <span class="keywordtype">intent(out)</span> :: leafEdges</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: faceIndex</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i, j, nParentEdges</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>) :: edgeLeaves(4)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">!   call LogMessage(log,DEBUG_LOGGING_LEVEL,trim(logKey)//&quot; CCWEdgesAroundFace : &quot;, &quot;entering.&quot;)</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span> ( self%faceKind == <a class="code" href="group___number_kinds.html#gac5f366e59a1a142274f1abf9a3895188">tri_panel</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        nparentedges = 3</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">elseif</span> ( self%faceKind == <a class="code" href="group___number_kinds.html#gab3062c50a0b035fca7077f04a8e49329">quad_panel</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        nparentedges = 4</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">do</span> i = 1, nparentedges</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        call <a class="code" href="group___edges.html#ga1d52efbbd14af28e7b9d83606cd664ce">getleafedgesfromparent</a>( self%edges, self%faces%edges(i,faceindex), edgeleaves(i))</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    call <a class="code" href="interfacestdintvectormodule_1_1initialize.html">initialize</a>(leafedges)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">do</span> i = 1, nparentedges</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">do</span> j = 1, edgeleaves(i)%N</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            call leafedges%pushBack(edgeleaves(i)%int(j))</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gaec4398a712feb200a284a04c7da490ed">  369</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___poly_mesh2d.html#gaec4398a712feb200a284a04c7da490ed">ccwverticesaroundface</a>( self, verts, faceIndex )</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>), <span class="keywordtype">intent(out)</span> :: verts</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: faceIndex</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>) :: leafEdges</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">!   call LogMessage(log,DEBUG_LOGGING_LEVEL,trim(logKey)//&quot; CCWVerticesAroundFace : &quot;, &quot;entering.&quot;)</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    call <a class="code" href="group___poly_mesh2d.html#ga1117b877c1ee6f1d5f023adafdd9c4fc">ccwedgesaroundface</a>(self, leafedges, faceindex)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    call <a class="code" href="interfacestdintvectormodule_1_1initialize.html">initialize</a>(verts)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">do</span> i = 1, leafedges%N</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="group___edges.html#ga03cc8cee87e4a23dbab6d7c95def2a4e">positiveedge</a>(self%edges, faceindex, leafedges%int(i)) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            call verts%pushBack(self%edges%dest(leafedges%int(i)))</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            call verts%pushBack(self%edges%orig(leafedges%int(i)))</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">enddo</span>   </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga468903cecff6b19516047d81fc186715">  395</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___poly_mesh2d.html#ga468903cecff6b19516047d81fc186715">projectparticlestosphere</a>( self, radius )</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(inout)</span> :: self</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">intent(in)</span> :: radius</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">real(kreal)</span> :: scale</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> ( self%geomKind /= <a class="code" href="group___number_kinds.html#ga8cddcd3d76142fa9d1c20388f293e1d5">sphere_geom</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>, trim(<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>)//<span class="stringliteral">&quot; ProjectToSphere ERROR : &quot;</span>, <span class="stringliteral">&quot;invalid geomKind.&quot;</span>)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">do</span> i = 1, self%particles%n</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        scale = radius / sqrt( self%particles%x(i) * self%particles%x(i) + self%particles%y(i) * self%particles%y(i) + &amp;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                     self%particles%z(i) * self%particles%z(i))</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        self%particles%x(i) = self%particles%x(i) * scale</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        self%particles%y(i) = self%particles%y(i) * scale</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        self%particles%z(i) = self%particles%z(i) * scale</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">enddo</span>   </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga11edc13fe65bab9da5046f22850948f4">  420</a></span>&#160;<span class="keyword">function </span><a class="code" href="group___poly_mesh2d.html#ga11edc13fe65bab9da5046f22850948f4">pointisoutsidemesh</a>(self, xVec )</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">logical(klog)</span> :: pointIsOutsideMesh</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">intent(in)</span> :: xVec(:)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">integer(kint)</span> :: faceIndex</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>) :: faceEdges</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>) :: boundaryEdges</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordtype">real(kreal)</span> :: centroid(3), v1(3), v2(3), p(3), q(3), reflection(3)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordtype">real(kreal)</span> :: interiorDist, exteriorDist</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">!   call LogMessage(log,DEBUG_LOGGING_LEVEL,trim(logKey)//&quot; pointIsOutsideMesh : &quot;, &quot;entering.&quot;)</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    pointisoutsidemesh = .false.</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    faceindex = <a class="code" href="group___poly_mesh2d.html#ga319d43beccd27ec88cfed64503140304">locatefacecontainingpoint</a>(self, xvec)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    call <a class="code" href="group___poly_mesh2d.html#ga1117b877c1ee6f1d5f023adafdd9c4fc">ccwedgesaroundface</a>(self, faceedges, faceindex)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    call <a class="code" href="interfacestdintvectormodule_1_1initialize.html">initialize</a>(boundaryedges)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">do</span> i = 1, faceedges%N</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="group___edges.html#ga5b41877544b39672945e644eca1b46f9">onboundary</a>(self%edges, faceedges%int(i) ) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            call boundaryedges%pushback(faceedges%int(i)) </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">!   call LogMessage(log,DEBUG_LOGGING_LEVEL,&quot;pointIsOutsideMesh: n boundary edges = &quot;, boundaryEdges%N)</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    v1 = 0.0_kreal</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    v2 = 0.0_kreal</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> ( boundaryedges%N &gt; 0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        centroid = <a class="code" href="group___faces.html#gaf6e475859ade30ee3b9481340bf46241">facecentroid</a>(self%faces, faceindex, self%particles)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        interiordist = sqrt(sum( (centroid-xvec)*(centroid-xvec)))</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">do</span> i = 1, boundaryedges%N</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            v1 = <a class="code" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd">physcoord</a>(self%particles, self%edges%orig( boundaryedges%int(i) ))</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            v2 = <a class="code" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd">physcoord</a>(self%particles, self%edges%dest( boundaryedges%int(i) ))</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            q = v2 - v1</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            q = q/sqrt(sum(q*q))</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            p = centroid - v1</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            reflection = centroid - 2.0_kreal * (p - sum(p*q)*q)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            exteriordist = sqrt(sum( (reflection-xvec)*(reflection-xvec)))</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">if</span> ( exteriordist &lt; interiordist ) &amp; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                pointisoutsidemesh = .true.</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">!           print *, &quot;centroid = &quot;, centroid, &quot;, reflection = &quot;, reflection</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">enddo</span>       </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keyword">end function</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gafea011e46aebdf0fe0d921c625d66ee5">  471</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___poly_mesh2d.html#gafea011e46aebdf0fe0d921c625d66ee5">ccwadjacentfaces</a>( self, adjFaces, faceIndex )</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>), <span class="keywordtype">intent(out)</span> :: adjFaces</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: faceIndex</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>) :: leafEdges</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">!   call LogMessage(log,DEBUG_LOGGING_LEVEL,trim(logKey)//&quot; CCWAdjacentFaces : &quot;, &quot;entering.&quot;)</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    call <a class="code" href="group___poly_mesh2d.html#ga1117b877c1ee6f1d5f023adafdd9c4fc">ccwedgesaroundface</a>(self, leafedges, faceindex )</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    call <a class="code" href="interfacestdintvectormodule_1_1initialize.html">initialize</a>(adjfaces)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">do</span> i = 1, leafedges%N</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="group___edges.html#ga03cc8cee87e4a23dbab6d7c95def2a4e">positiveedge</a>(self%edges, faceindex, leafedges%int(i)) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            call adjfaces%pushBack(self%edges%rightFace(leafedges%int(i)))</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            call adjfaces%pushBack(self%edges%leftFace(leafedges%int(i)))</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gabfb6f53d3285a8e759173d4fc29f20d7">  500</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___poly_mesh2d.html#gabfb6f53d3285a8e759173d4fc29f20d7">ccwfacesaroundvertex</a>( self, adjFaces, vertexIndex )</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>), <span class="keywordtype">intent(out)</span> :: adjFaces</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: vertexIndex</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>) :: incEdges</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">!   call LogMessage(log,DEBUG_LOGGING_LEVEL,trim(logKey)//&quot; CCWFacesAroundVertex : &quot;, &quot;entering.&quot;)</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">if</span> ( self%particles%area(vertexindex) &gt; 0.0_kreal .OR. self%particles%isActive(vertexindex) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>, <a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>//<span class="stringliteral">&quot; CCWFacesAroundVertex ERROR : &quot;</span>, <span class="stringliteral">&quot; vertices should have 0 area.&quot;</span>)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    call <a class="code" href="interfacestdintvectormodule_1_1initialize.html">initialize</a>(adjfaces)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    call <a class="code" href="interfacestdintvectormodule_1_1initialize.html">initialize</a>(incedges,self%particles%incidentEdges(1:self%particles%nEdges(vertexindex), vertexindex))</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">do</span> i = 1, incedges%N</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">if</span> ( self%edges%orig(incedges%int(i)) == vertexindex ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            call adjfaces%pushBack( self%edges%leftFace( incedges%int(i)))  </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">elseif</span> ( self%edges%dest(incedges%int(i)) == vertexindex) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            call adjfaces%pushBack( self%edges%rightFace(incedges%int(i)))</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keyword">write</span>(<a class="code" href="group___beta_plane.html#ga0c09fe438e6ad416b82181c0069ebb8e">logstring</a>,<span class="stringliteral">&#39;(A,I8,A)&#39;</span>) <span class="stringliteral">&quot; connectivity ERROR at vertex &quot;</span>, vertexindex, <span class="stringliteral">&quot;: has incident edge that does not connect.&quot;</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>,trim(<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>)//<span class="stringliteral">&quot; CCWFacesAroundVertex :&quot;</span>,<a class="code" href="group___beta_plane.html#ga0c09fe438e6ad416b82181c0069ebb8e">logstring</a>)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga2061ff775ab982970e84df296a749336">  535</a></span>&#160;<span class="keyword">function </span><a class="code" href="group___poly_mesh2d.html#ga2061ff775ab982970e84df296a749336">nearestrootface</a>(self, queryPt)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">integer(kint)</span> :: nearestRootFace</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">intent(in)</span> :: queryPt(:)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i, nRootFaces</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordtype">real(kreal)</span> :: dist, testDist, cntd(3)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    nearestrootface = 1</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">!   call LogMessage(log,DEBUG_LOGGING_LEVEL,trim(logKey)//&quot; nearestRootFace : &quot;, &quot;entering.&quot;)</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">select case</span> (self%meshSeed)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordflow">case</span> ( <a class="code" href="group___number_kinds.html#gaf2cfb545db8575bc18fc6253237e73c7">tri_hex_seed</a>, <a class="code" href="group___number_kinds.html#ga640e4ff4348f2124291f7f9229f52a56">cubed_sphere_seed</a> )</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            nrootfaces = 6</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">case</span> ( <a class="code" href="group___number_kinds.html#ga636f1fabdc68cceaed7ec93ead08f5da">quad_rect_seed</a>, <a class="code" href="group___number_kinds.html#ga25b568399757c4e2308aa806733bcd3d">quad_rect_periodic_seed</a>, <a class="code" href="group___number_kinds.html#ga35dcc64ada6c741826a800207006de61">polar_disc_seed</a>, <a class="code" href="group___number_kinds.html#gafdb49bdf25b09548a91b78d18ff15dc8">beta_plane_seed</a>)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            nrootfaces = 4</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">case</span> ( <a class="code" href="group___number_kinds.html#ga35a21a5cba53195488e52439e87ac646">icos_tri_sphere_seed</a>)</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            nrootfaces = 20</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">end select</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    cntd = <a class="code" href="group___faces.html#gaf6e475859ade30ee3b9481340bf46241">facecentroid</a>(self%faces, 1, self%particles)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span> ( self%geomKind == <a class="code" href="group___number_kinds.html#ga8cddcd3d76142fa9d1c20388f293e1d5">sphere_geom</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        dist = <a class="code" href="interfacespheregeommodule_1_1spheredistance.html">spheredistance</a>( cntd, querypt)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keywordflow">do</span> i = 2, nrootfaces</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            cntd = <a class="code" href="group___faces.html#gaf6e475859ade30ee3b9481340bf46241">facecentroid</a>(self%faces, i, self%particles)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            testdist = <a class="code" href="interfacespheregeommodule_1_1spheredistance.html">spheredistance</a>( cntd, querypt )</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordflow">if</span> ( testdist &lt; dist ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                dist = testdist</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                nearestrootface = i</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        dist = sqrt(sum( (cntd-querypt)*(cntd-querypt)))</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">do</span> i = 2, nrootfaces</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            cntd = <a class="code" href="group___faces.html#gaf6e475859ade30ee3b9481340bf46241">facecentroid</a>(self%faces, i, self%particles)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            testdist = sqrt(sum( (cntd-querypt)*(cntd-querypt)))</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="keywordflow">if</span> ( testdist &lt; dist ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                dist = testdist</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                nearestrootface = i</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">enddo</span>       </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="keyword">end function</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gafeeb682c17d2f3569c60dc52f8ef3cea">  583</a></span>&#160;<span class="keyword">function </span><a class="code" href="group___poly_mesh2d.html#gafeeb682c17d2f3569c60dc52f8ef3cea">facekindfromseed</a>( seed )</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordtype">integer(kint)</span> :: FaceKindFromSeed</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: seed</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    facekindfromseed = 0</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">select case</span> (seed)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">case</span> ( <a class="code" href="group___number_kinds.html#gaf2cfb545db8575bc18fc6253237e73c7">tri_hex_seed</a>, <a class="code" href="group___number_kinds.html#ga35a21a5cba53195488e52439e87ac646">icos_tri_sphere_seed</a>)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            facekindfromseed = <a class="code" href="group___number_kinds.html#gac5f366e59a1a142274f1abf9a3895188">tri_panel</a></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">case</span> ( <a class="code" href="group___number_kinds.html#ga636f1fabdc68cceaed7ec93ead08f5da">quad_rect_seed</a>, <a class="code" href="group___number_kinds.html#ga25b568399757c4e2308aa806733bcd3d">quad_rect_periodic_seed</a>, <a class="code" href="group___number_kinds.html#ga35dcc64ada6c741826a800207006de61">polar_disc_seed</a>, <a class="code" href="group___number_kinds.html#ga640e4ff4348f2124291f7f9229f52a56">cubed_sphere_seed</a>, <a class="code" href="group___number_kinds.html#gafdb49bdf25b09548a91b78d18ff15dc8">beta_plane_seed</a>)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            facekindfromseed = <a class="code" href="group___number_kinds.html#gab3062c50a0b035fca7077f04a8e49329">quad_panel</a></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">end select</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keyword">end function</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga9e3a8f08670e896630624fae230a6073">  598</a></span>&#160;<span class="keyword">function </span><a class="code" href="group___poly_mesh2d.html#ga9e3a8f08670e896630624fae230a6073">geomkindfromseed</a>( seed )</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordtype">integer(kint)</span> :: GeomKindFromSeed</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: seed</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    geomkindfromseed = 0</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">select case</span> (seed)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#gaf2cfb545db8575bc18fc6253237e73c7">tri_hex_seed</a>, <a class="code" href="group___number_kinds.html#ga636f1fabdc68cceaed7ec93ead08f5da">quad_rect_seed</a>, <a class="code" href="group___number_kinds.html#ga25b568399757c4e2308aa806733bcd3d">quad_rect_periodic_seed</a>, <a class="code" href="group___number_kinds.html#ga35dcc64ada6c741826a800207006de61">polar_disc_seed</a>, <a class="code" href="group___number_kinds.html#gafdb49bdf25b09548a91b78d18ff15dc8">beta_plane_seed</a>)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            geomkindfromseed = <a class="code" href="group___number_kinds.html#ga37240f10dd8db77f985349602bd8844f">planar_geom</a></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga35a21a5cba53195488e52439e87ac646">icos_tri_sphere_seed</a>, <a class="code" href="group___number_kinds.html#ga640e4ff4348f2124291f7f9229f52a56">cubed_sphere_seed</a>)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            geomkindfromseed = <a class="code" href="group___number_kinds.html#ga8cddcd3d76142fa9d1c20388f293e1d5">sphere_geom</a></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">end select</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="keyword">end function</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga65267322a5536d5acdf15f2ec649f516">  618</a></span>&#160;<span class="keyword">recursive function </span><a class="code" href="group___poly_mesh2d.html#ga65267322a5536d5acdf15f2ec649f516">locatepointtreesearch</a>( self, queryPt, index ) result(faceIndex)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordtype">integer(kint)</span> :: faceIndex</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">intent(in)</span> :: queryPt(:)</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: index</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordtype">real(kreal)</span> :: dist, testDist, cntd(3)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i, nearestChild</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    faceindex = 0</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">!   call LogMessage(log,DEBUG_LOGGING_LEVEL,trim(logKey)//&quot; locatePointTreeSearch : &quot;, &quot;entering.&quot;)</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    dist = 1.0d20</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    nearestchild = 0</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    cntd = 0.0_kreal</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">if</span> ( self%faces%hasChildren(index) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">do</span> i = 1, 4</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            cntd = <a class="code" href="group___faces.html#gaf6e475859ade30ee3b9481340bf46241">facecentroid</a>(self%faces, self%faces%children(i,index), self%particles)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="keywordflow">if</span> ( self%geomKind == <a class="code" href="group___number_kinds.html#ga8cddcd3d76142fa9d1c20388f293e1d5">sphere_geom</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                testdist = <a class="code" href="interfacespheregeommodule_1_1spheredistance.html">spheredistance</a>( querypt, cntd )</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                testdist = sqrt(sum( (querypt-cntd)*(querypt-cntd)))</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">if</span> ( testdist &lt; dist ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                nearestchild = self%faces%children(i,index)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                dist = testdist</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        faceindex = <a class="code" href="group___poly_mesh2d.html#ga65267322a5536d5acdf15f2ec649f516">locatepointtreesearch</a>( self, querypt, nearestchild)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        faceindex = index</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">endif</span>   </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="keyword">end function</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga5939ae9ed03009c95328b9d189f3a3de">  660</a></span>&#160;<span class="keyword">recursive function </span><a class="code" href="group___poly_mesh2d.html#ga5939ae9ed03009c95328b9d189f3a3de">locatepointwalksearch</a>(self, queryPt, index) result(faceIndex)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordtype">integer(kint)</span> :: faceIndex</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">intent(in)</span> :: queryPt(:)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: index</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordtype">real(kreal)</span> :: dist, testDist, cntd(3)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structstdintvectormodule_1_1stdintvector.html">stdintvector</a>) :: adjFaces</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordtype">integer(kint)</span> :: currentFace, i</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">!   call LogMessage(log,DEBUG_LOGGING_LEVEL,trim(logKey)//&quot; locatePointWalkSearch : &quot;, &quot;entering.&quot;)</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">if</span> ( self%faces%hasChildren(index) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>, <a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>//<span class="stringliteral">&quot; locatePointWalkSearch ERROR:&quot;</span>,<span class="stringliteral">&quot; expected a leaf face.&quot;</span>)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    faceindex = 0</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    currentface = index</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    cntd = <a class="code" href="group___faces.html#gaf6e475859ade30ee3b9481340bf46241">facecentroid</a>(self%faces, index, self%particles)  </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> ( self%geomKind == <a class="code" href="group___number_kinds.html#ga8cddcd3d76142fa9d1c20388f293e1d5">sphere_geom</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        dist = <a class="code" href="interfacespheregeommodule_1_1spheredistance.html">spheredistance</a>( cntd, querypt)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        dist = sqrt(sum( (cntd - querypt)*(cntd-querypt)))</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    call <a class="code" href="group___poly_mesh2d.html#gafea011e46aebdf0fe0d921c625d66ee5">ccwadjacentfaces</a>(self, adjfaces, currentface)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">do</span> i = 1, adjfaces%N</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordflow">if</span> ( adjfaces%int(i) &gt; 0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            cntd = <a class="code" href="group___faces.html#gaf6e475859ade30ee3b9481340bf46241">facecentroid</a>( self%faces, adjfaces%int(i), self%particles )</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="keywordflow">if</span> ( self%GeomKind == <a class="code" href="group___number_kinds.html#ga8cddcd3d76142fa9d1c20388f293e1d5">sphere_geom</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                testdist = <a class="code" href="interfacespheregeommodule_1_1spheredistance.html">spheredistance</a>( cntd, querypt)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                testdist = sqrt(sum( (cntd - querypt)*(cntd-querypt) ))</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keywordflow">endif</span>   </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keywordflow">if</span> ( testdist &lt; dist ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                dist = testdist</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                currentface = adjfaces%int(i)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> ( currentface == index ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        faceindex = currentface</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        faceindex = <a class="code" href="group___poly_mesh2d.html#ga5939ae9ed03009c95328b9d189f3a3de">locatepointwalksearch</a>( self, querypt, currentface )</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">endif</span>   </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keyword">end function</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gacb9154c9633d010075c5c7827de64288">  717</a></span>&#160;<span class="keyword">function </span><a class="code" href="group___poly_mesh2d.html#gacb9154c9633d010075c5c7827de64288">nverticesinmesh</a>( self, initNest )</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordtype">integer(kint)</span> :: nVerticesInMesh</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: initNest</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i, result</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    result = 0</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">select case</span> ( self%meshSeed)</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keywordflow">case</span> ( <a class="code" href="group___number_kinds.html#gaf2cfb545db8575bc18fc6253237e73c7">tri_hex_seed</a> ) </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <span class="keywordflow">do</span> i = 2**initnest + 1, 2**(initnest+1)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                result = result + i</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            result = 2*result + 2**(initnest+1)+1</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">case</span> ( <a class="code" href="group___number_kinds.html#ga636f1fabdc68cceaed7ec93ead08f5da">quad_rect_seed</a>, <a class="code" href="group___number_kinds.html#ga25b568399757c4e2308aa806733bcd3d">quad_rect_periodic_seed</a>, <a class="code" href="group___number_kinds.html#gafdb49bdf25b09548a91b78d18ff15dc8">beta_plane_seed</a>) </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            result = 3</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordflow">do</span> i = 1, initnest</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                result = result + 2**i</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            result = result*result</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keywordflow">case</span> ( <a class="code" href="group___number_kinds.html#ga35a21a5cba53195488e52439e87ac646">icos_tri_sphere_seed</a>) </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            result = 2 + 10 * 4 ** initnest</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">case</span> ( <a class="code" href="group___number_kinds.html#ga640e4ff4348f2124291f7f9229f52a56">cubed_sphere_seed</a> ) </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            result = 2 + 6 * 4 ** initnest</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">end select</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    nverticesinmesh = result</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="keyword">end function</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga18991ddade171ee044e7d7dfb2694979">  750</a></span>&#160;<span class="keyword">function </span><a class="code" href="group___poly_mesh2d.html#ga18991ddade171ee044e7d7dfb2694979">nfacesinmesh</a>( self, initNest )</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordtype">integer(kint)</span> :: nFacesInMesh</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: initNest</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    nfacesinmesh = 0</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">select case</span> (self%meshSeed)</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#gaf2cfb545db8575bc18fc6253237e73c7">tri_hex_seed</a>)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            nfacesinmesh = 6 * 4 ** initnest</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga636f1fabdc68cceaed7ec93ead08f5da">quad_rect_seed</a>, <a class="code" href="group___number_kinds.html#ga25b568399757c4e2308aa806733bcd3d">quad_rect_periodic_seed</a>, <a class="code" href="group___number_kinds.html#gafdb49bdf25b09548a91b78d18ff15dc8">beta_plane_seed</a>)</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            nfacesinmesh = 4 * 4 ** initnest</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga35a21a5cba53195488e52439e87ac646">icos_tri_sphere_seed</a>)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            nfacesinmesh = 20 * 4 ** initnest</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga640e4ff4348f2124291f7f9229f52a56">cubed_sphere_seed</a>)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            nfacesinmesh = 6 * 4 ** initnest</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">end select</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="keyword">end function</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div>
<div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga515332a3f22d9fb7b09f408594eec185">  774</a></span>&#160;<span class="keyword">function </span><a class="code" href="group___poly_mesh2d.html#ga515332a3f22d9fb7b09f408594eec185">nedgesinmesh</a>( self, nVertices, nFaces )</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordtype">integer(kint)</span> :: nEdgesInMesh</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: nVertices</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: nFaces</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    nedgesinmesh = 0</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">select case</span> (self%geomKind)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga37240f10dd8db77f985349602bd8844f">planar_geom</a>)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            nedgesinmesh = nfaces + nvertices - 1</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga8cddcd3d76142fa9d1c20388f293e1d5">sphere_geom</a>)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            nedgesinmesh = nfaces + nvertices - 2</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">end select</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="keyword">end function</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga3afe4155924faf7adf8d9bcadd5dc942">  795</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___poly_mesh2d.html#ga3afe4155924faf7adf8d9bcadd5dc942">initializemeshfromseed</a>( self, ampFactor )</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(inout)</span> :: self</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">intent(in)</span> :: ampFactor</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordtype">character(len=56)</span> :: seedFilename</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordtype">integer(kint)</span> :: nSeedParticles, nSeedEdges, nSeedFaces, nSeedVerts</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">allocatable</span> :: seedXYZ(:,:)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">allocatable</span> :: seedEdgeOrigs(:), seedEdgeDests(:), seedEdgeLefts(:), seedEdgeRights(:)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">allocatable</span> :: seedFaceVerts(:,:), seedFaceEdges(:,:), seedVertexDegree(:)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">select case</span> ( self%meshSeed )</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#gaf2cfb545db8575bc18fc6253237e73c7">tri_hex_seed</a>)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            nseedparticles = 13</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            nseededges = 12</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            nseedfaces = 6</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            nseedverts = 7</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">!           self%faceKind = TRI_PANEL</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">!           self%geomKind = PLANAR_GEOM</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            seedfilename = <span class="stringliteral">&quot;triHexSeed.dat&quot;</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga636f1fabdc68cceaed7ec93ead08f5da">quad_rect_seed</a>)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            nseedparticles = 13</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            nseededges = 12</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            nseedfaces = 4</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            nseedverts = 9</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">!           self%faceKind = QUAD_PANEL</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">!           self%geomKind = PLANAR_GEOM</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            seedfilename = <span class="stringliteral">&quot;quadRectSeed.dat&quot;</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga35dcc64ada6c741826a800207006de61">polar_disc_seed</a>)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>,<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>,<span class="stringliteral">&quot; initMeshFromSeed ERROR : seed not implemented.&quot;</span>)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga25b568399757c4e2308aa806733bcd3d">quad_rect_periodic_seed</a>)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            nseedparticles = 13</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            nseededges = 12</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            nseedfaces = 4</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            nseedverts = 9</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>,<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>,<span class="stringliteral">&quot; initMeshFromSeed ERROR : seed not implemented.&quot;</span>)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga35a21a5cba53195488e52439e87ac646">icos_tri_sphere_seed</a>)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            nseedparticles = 32</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            nseededges = 30</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            nseedfaces = 20</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            nseedverts = 12</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">!           self%faceKind = TRI_PANEL</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">!           self%geomKind = SPHERE_GEOM</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            seedfilename = <span class="stringliteral">&quot;icosTriSeed.dat&quot;</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga640e4ff4348f2124291f7f9229f52a56">cubed_sphere_seed</a>)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            nseedparticles = 14</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            nseededges = 12</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            nseedfaces = 6</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            nseedverts = 8</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">!           self%faceKind = QUAD_PANEL</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">!           self%geomKind = SPHERE_GEOM</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            seedfilename = <span class="stringliteral">&quot;cubedSphereSeed.dat&quot;</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#gafdb49bdf25b09548a91b78d18ff15dc8">beta_plane_seed</a>)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            nseedparticles = 13</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            nseededges = 12</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            nseedfaces = 4</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            nseedverts = 9</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            seedfilename = <span class="stringliteral">&quot;betaPlaneSeed.dat&quot;</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">end select</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keyword">allocate</span>(seedxyz(3,nseedparticles))</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keyword">allocate</span>(seededgeorigs(nseededges))</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keyword">allocate</span>(seededgedests(nseededges))</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keyword">allocate</span>(seededgelefts(nseededges))</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keyword">allocate</span>(seededgerights(nseededges))</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keyword">allocate</span>(seedvertexdegree(nseedverts))</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">if</span> ( self%faceKind == <a class="code" href="group___number_kinds.html#gac5f366e59a1a142274f1abf9a3895188">tri_panel</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keyword">allocate</span>(seedfaceverts(3,nseedfaces))</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keyword">allocate</span>(seedfaceedges(3,nseedfaces))</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">elseif</span> ( self%faceKind == <a class="code" href="group___number_kinds.html#gab3062c50a0b035fca7077f04a8e49329">quad_panel</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keyword">allocate</span>(seedfaceverts(4,nseedfaces))</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keyword">allocate</span>(seedfaceedges(4,nseedfaces))</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    call <a class="code" href="group___poly_mesh2d.html#ga12657c955905ee8e5450ba9861b3ae38">readseedfile</a>(self, seedfilename, nseedparticles, nseededges, nseedfaces, seedxyz, seededgeorigs, seededgedests, &amp;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                      seededgelefts, seededgerights, seedfaceverts, seedfaceedges, seedvertexdegree)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                      </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">if</span> ( self%meshSeed == <a class="code" href="group___number_kinds.html#ga35a21a5cba53195488e52439e87ac646">icos_tri_sphere_seed</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keywordflow">do</span> i = 1, 20</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            seedxyz(:,12+i) = <a class="code" href="group___sphere_geom.html#ga84b61f121a82f260ac48915a6826663f">spheretricenter</a>( seedxyz(:,seedfaceverts(1,i)), seedxyz(:,seedfaceverts(2,i)), &amp;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                                               seedxyz(:,seedfaceverts(3,i)) )</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">elseif</span> ( self%meshSeed == <a class="code" href="group___number_kinds.html#gafdb49bdf25b09548a91b78d18ff15dc8">beta_plane_seed</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">do</span> i = 1, 13</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            seedxyz(1,i) = 0.5_kreal * seedxyz(1,i) + 0.5_kreal</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            seedxyz(2,i) = 0.5_kreal * seedxyz(2,i) </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordflow">enddo</span>       </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    seedxyz = ampfactor * seedxyz</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">!   initialize mesh with seed data</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">do</span> i = 1, nseedparticles</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        call <a class="code" href="group___particles.html#gaf5dfbd586cef1f9579376c4624c65b02">insertparticle</a>( self%particles, seedxyz(:,i), seedxyz(:,i))</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">if</span> ( self%particles%N /= nseedparticles ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>, <a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>//<span class="stringliteral">&quot; initMeshFromSeed ERROR : &quot;</span>,<span class="stringliteral">&quot; particles%N.&quot;</span>)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">do</span> i = 1, nseededges</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        call <a class="code" href="group___edges.html#ga8102d56956d485a8dff75cb6d44d9195">insertedge</a>( self%Edges, self%particles, seededgeorigs(i), seededgedests(i), seededgelefts(i), seededgerights(i))</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span> ( self%edges%N /= nseededges ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>, <a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>//<span class="stringliteral">&quot; initMeshFromSeed ERROR : &quot;</span>,<span class="stringliteral">&quot; edges%N.&quot;</span>)</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">do</span> i = 1, nseedfaces</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        call <a class="code" href="group___faces.html#gabe57e9083f933fd8fde83ca63c10ed27">insertface</a>( self%Faces, nseedverts + i, seedfaceverts(:,i), seedfaceedges(:,i))</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        call <a class="code" href="group___particles.html#ga97eb338e7996e4802d747fd46ae6a298">makeparticleactive</a>( self%particles, nseedverts +i)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordflow">if</span> ( self%faces%N /= nseedfaces ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>, <a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>//<span class="stringliteral">&quot; initMeshFromSeed ERROR : &quot;</span>,<span class="stringliteral">&quot; faces%N.&quot;</span>)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    self%faces%N_Active = nseedfaces</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">if</span> ( self%faceKind == <a class="code" href="group___number_kinds.html#gac5f366e59a1a142274f1abf9a3895188">tri_panel</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordflow">do</span> i = 1, nseedfaces</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            self%particles%area( self%faces%centerParticle(i) ) = <a class="code" href="group___faces.html#gacf7e3c70546c5d562a5a2de19f8553df">trifacearea</a>( self%faces, i, self%particles)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">elseif</span> ( self%faceKind == <a class="code" href="group___number_kinds.html#gab3062c50a0b035fca7077f04a8e49329">quad_panel</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keywordflow">do</span> i = 1, nseedfaces</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            self%particles%area( self%faces%centerParticle(i) ) = <a class="code" href="group___faces.html#ga6a872b75ce2c75e9f4d39c2ec44a367e">quadfacearea</a>( self%faces, i, self%particles)</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="comment">!   initialize dual information</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">do</span> i = 1, nseedverts</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="keywordflow">if</span> ( self%particles%nEdges(i) /= seedvertexdegree(i) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <span class="keyword">write</span>(<a class="code" href="group___beta_plane.html#ga0c09fe438e6ad416b82181c0069ebb8e">logstring</a>,*) <span class="stringliteral">&quot; dual connectivity error at vertex &quot;</span>, i</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>, <a class="code" href="group___logger.html#ga81b6e629b304bffe7abdd8de4a80e18e">warning_logging_level</a>,<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>//<span class="stringliteral">&quot; initFromSeed WARNING: &quot;</span>,<a class="code" href="group___beta_plane.html#ga0c09fe438e6ad416b82181c0069ebb8e">logstring</a>)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        call <a class="code" href="group___particles.html#ga550e2ee3c6c4a9cc0e1c27cfb1071571">sortincidentedgesatparticle</a>( self%particles, i )</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keyword">deallocate</span>(seedxyz)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keyword">deallocate</span>(seededgeorigs)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keyword">deallocate</span>(seededgedests)</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keyword">deallocate</span>(seededgelefts)</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keyword">deallocate</span>(seededgerights)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keyword">deallocate</span>(seedfaceverts)</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keyword">deallocate</span>(seedfaceedges)</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga12657c955905ee8e5450ba9861b3ae38">  956</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___poly_mesh2d.html#ga12657c955905ee8e5450ba9861b3ae38">readseedfile</a>( self, seedFilename, nParticles, nEdges, nFaces, seedXYZ, &amp;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                         seededgeorigs, seededgedests, seededgelefts, seededgerights, &amp;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                         seedfaceverts, seedfaceedges, seedvertexdegree )</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: seedFilename</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: nParticles, nEdges, nFaces</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordtype">real(kreal)</span>, <span class="keywordtype">intent(out)</span> :: seedXYZ(3,nparticles)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(out)</span> :: seedEdgeOrigs(nedges)</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(out)</span> :: seedEdgeDests(nedges)</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(out)</span> :: seedEdgeLefts(nedges)</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(out)</span> :: seedEdgeRights(nedges)</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(inout)</span> :: seedFaceVerts(:,:)</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(inout)</span> :: seedFaceEdges(:,:)</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(out)</span> :: seedVertexDegree(nparticles - nfaces)</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordtype">character(len=56)</span> :: tempString                          </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordtype">integer(kint)</span> :: i, readStat</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keyword">open</span>(unit=<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,file=seedfilename,status=<span class="stringliteral">&#39;OLD&#39;</span>,action=<span class="stringliteral">&#39;READ&#39;</span>,iostat=readstat)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span> ( readstat /= 0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(<a class="code" href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">log</a>,<a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>,<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>,<span class="stringliteral">&quot; cannot open seed file.&quot;</span>)</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="comment">!   read root particle positions</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) tempstring</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">if</span> ( self%geomKind == <a class="code" href="group___number_kinds.html#ga37240f10dd8db77f985349602bd8844f">planar_geom</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keywordflow">do</span> i = 1, nparticles</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) seedxyz(1,i), seedxyz(2,i)</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="keywordflow">if</span> ( self%meshSeed == <a class="code" href="group___number_kinds.html#ga35a21a5cba53195488e52439e87ac646">icos_tri_sphere_seed</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="keywordflow">do</span> i = 1, 12</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) seedxyz(1,i), seedxyz(2,i), seedxyz(3,i)</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keywordflow">do</span> i = 1, nparticles</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) seedxyz(1,i), seedxyz(2,i), seedxyz(3,i)</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">!   read root edges</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) tempstring</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">do</span> i = 1, nedges</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) seededgeorigs(i), seededgedests(i), seededgelefts(i), seededgerights(i)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="comment">!   adjust to fortran (base index = 1, not 0)</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    seededgeorigs = seededgeorigs + 1</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    seededgedests = seededgedests + 1</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    seededgelefts = seededgelefts + 1</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    seededgerights = seededgerights + 1</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="comment">!   read root faces</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) tempstring</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordflow">if</span> ( self%faceKind == <a class="code" href="group___number_kinds.html#gac5f366e59a1a142274f1abf9a3895188">tri_panel</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keywordflow">do</span> i = 1, nfaces</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) seedfaceverts(1,i), seedfaceverts(2,i), seedfaceverts(3,i)</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) tempstring</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <span class="keywordflow">do</span> i =1, nfaces</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) seedfaceedges(1,i), seedfaceedges(2,i), seedfaceedges(3,i)</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">elseif</span> ( self%faceKind == <a class="code" href="group___number_kinds.html#gab3062c50a0b035fca7077f04a8e49329">quad_panel</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <span class="keywordflow">do</span> i = 1, nfaces</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) seedfaceverts(1,i), seedfaceverts(2,i), seedfaceverts(3,i), seedfaceverts(4,i)</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) tempstring</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="keywordflow">do</span> i =1, nfaces</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) seedfaceedges(1,i), seedfaceedges(2,i), seedfaceedges(3,i), seedfaceedges(4,i)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">!   adjust to fortran (base index = 1)</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    seedfaceedges = seedfaceedges + 1</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    seedfaceverts = seedfaceverts + 1</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">!   read vertex degree</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) tempstring</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">do</span> i = 1, nparticles - nfaces</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <span class="keyword">read</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>,*) seedvertexdegree(i)</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">enddo</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keyword">close</span>(<a class="code" href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">read_unit</a>)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga80dca1b2be22f127129a06a0723de065"> 1049</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___poly_mesh2d.html#ga80dca1b2be22f127129a06a0723de065">writemeshtomatlab</a>( self, fileunit )</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: fileunit</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    call <a class="code" href="group___particles.html#ga99c4e2d0644382ee76091d7f5e695614">writeparticlestomatlab</a>(self%particles, fileunit)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    call <a class="code" href="group___edges.html#gad66ce7949274bca33fe7123d9ee2e229">writeedgestomatlab</a>(self%edges, fileunit)</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    call <a class="code" href="group___faces.html#ga4c3811ba7df19b43915c3fd70ceaa16d">writefacestomatlab</a>(self%faces, fileunit)</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div>
<div class="line"><a name="l01061"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gac648e9d399ac68a778b278787f54355e"> 1061</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___beta_plane.html#ga20c169b731ae61d90e833c9348cd452a">logstatsprivate</a>(self, aLog)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structloggermodule_1_1logger.html">logger</a>), <span class="keywordtype">intent(inout)</span> :: aLog</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(alog, <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a>, <a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>, <span class="stringliteral">&quot;PolyMesh Stats:&quot;</span> )</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    call <a class="code" href="interfaceoutputwritermodule_1_1startsection.html">startsection</a>(alog)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    call <a class="code" href="group___poly_mesh2d.html#gabe5ac653e50883a2ef9882c4a71db4e3">meshseedstring</a>(<a class="code" href="group___beta_plane.html#ga0c09fe438e6ad416b82181c0069ebb8e">logstring</a>, self%meshSeed)</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(alog, <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a>, <span class="stringliteral">&quot;meshSeed = &quot;</span>, trim(<a class="code" href="group___beta_plane.html#ga0c09fe438e6ad416b82181c0069ebb8e">logstring</a>))</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">if</span> ( self%geomKind == <a class="code" href="group___number_kinds.html#ga37240f10dd8db77f985349602bd8844f">planar_geom</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(alog, <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a>, <span class="stringliteral">&quot;geomKind = &quot;</span>, <span class="stringliteral">&quot;PLANAR_GEOM&quot;</span>)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">elseif</span> ( self%geomKind == <a class="code" href="group___number_kinds.html#ga8cddcd3d76142fa9d1c20388f293e1d5">sphere_geom</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(alog, <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a>, <span class="stringliteral">&quot;geomKind = &quot;</span>, <span class="stringliteral">&quot;SPHERE_GEOM&quot;</span>)</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">elseif</span> ( self%geomKind == <a class="code" href="group___number_kinds.html#ga6f381220923147ab7b90625d35ed17d1">euclidean_3d</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(alog, <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a>, <span class="stringliteral">&quot;geomKind = &quot;</span>, <span class="stringliteral">&quot;EUCLIDEAN_3D&quot;</span>)</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(alog, <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a>, <span class="stringliteral">&quot;geomKind = &quot;</span>, <span class="stringliteral">&quot;invalid geomKind.&quot;</span>)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(alog, <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a>, <span class="stringliteral">&quot;initNest = &quot;</span>, self%initNest)</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(alog, <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a>, <span class="stringliteral">&quot;amrLimit = &quot;</span>, self%amrLimit)</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(alog, <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a>, <span class="stringliteral">&quot;max Edge len = &quot;</span>, <a class="code" href="group___edges.html#gae1df14f49a6c66b9c7383b4b591f0f43">maxedgelength</a>(self%edges, self%particles) )</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(alog, <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a>, <span class="stringliteral">&quot;min Edge len = &quot;</span>, <a class="code" href="group___edges.html#gad2d36ea3105ac6652300c5a35f451978">minedgelength</a>(self%edges, self%particles) )</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    call <a class="code" href="interfaceloggermodule_1_1logmessage.html">logmessage</a>(alog, <a class="code" href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">trace_logging_level</a>, <span class="stringliteral">&quot;avg Edge len = &quot;</span>, <a class="code" href="group___edges.html#ga8d513bf915a852368881033ffc2d6e8c">avgedgelength</a>(self%edges, self%particles) )</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1logstats.html">logstats</a>(self%particles, alog)</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1logstats.html">logstats</a>(self%edges, alog)</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1logstats.html">logstats</a>(self%faces, alog)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    call <a class="code" href="interfaceoutputwritermodule_1_1endsection.html">endsection</a>(alog)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gac803dbb3b64c4971577efb6a7d1389c2"> 1093</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___poly_mesh2d.html#gac803dbb3b64c4971577efb6a7d1389c2">writemeshtovtkpolydata</a>( self, fileunit, title )</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: fileunit</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">optional</span> :: title</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="keywordflow">if</span> ( <span class="keyword">present</span>(title) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        call <a class="code" href="group___particles.html#gace4db7f6a46e05fbcde2d1b53de3d602">writevtkpoints</a>(self%particles, fileunit, title)</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        call <a class="code" href="group___particles.html#gace4db7f6a46e05fbcde2d1b53de3d602">writevtkpoints</a>(self%particles, fileunit)</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    call <a class="code" href="group___faces.html#gaccf09c7b0e4d09609e2332db6595fef9">writefacestovtkpolygons</a>( self%faces, fileunit )</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    call <a class="code" href="group___output_writer.html#gac1138b013ddbabcd097387f0b2108edb">writevtkpointdatasectionheader</a>(fileunit, self%particles%N)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    call <a class="code" href="group___particles.html#ga0f39d7be727a5229816c5e1d1e3e531a">writevtklagcoords</a>(self%particles, fileunit )</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    call <a class="code" href="group___faces.html#ga8fb7d3a1d52c5e3833987e29590c9845">writefaceareatovtkcelldata</a>(self%faces, self%particles, fileunit)   </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div>
<div class="line"><a name="l01114"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#ga8e3fe75fcac251c24be41b95c102488d"> 1114</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___edges.html#ga336ae9b8908174c080ab8c91bf665ed7">printdebugprivate</a>( self ) </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2d</a>), <span class="keywordtype">intent(in)</span> :: self</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="group___s_t_d_int_vector.html#gac9b58809dfdbc98ef87a4992e441b5fb">print</a> *, <span class="stringliteral">&quot;PolyMesh2d DEBUG info : &quot;</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <a class="code" href="group___s_t_d_int_vector.html#gac9b58809dfdbc98ef87a4992e441b5fb">print</a> *, <span class="stringliteral">&quot;meshSeed = &quot;</span>, self%meshSeed</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <a class="code" href="group___s_t_d_int_vector.html#gac9b58809dfdbc98ef87a4992e441b5fb">print</a> *, <span class="stringliteral">&quot;geomKind = &quot;</span>, self%geomKind</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <a class="code" href="group___s_t_d_int_vector.html#gac9b58809dfdbc98ef87a4992e441b5fb">print</a> *, <span class="stringliteral">&quot;initNest = &quot;</span>, self%initNest</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <a class="code" href="group___s_t_d_int_vector.html#gac9b58809dfdbc98ef87a4992e441b5fb">print</a> *, <span class="stringliteral">&quot;amrLimit = &quot;</span>, self%amrLimit</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1printdebuginfo.html">printdebuginfo</a>( self%particles )</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1printdebuginfo.html">printdebuginfo</a>( self%edges )</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    call <a class="code" href="interfacepolymesh2dmodule_1_1printdebuginfo.html">printdebuginfo</a>( self%faces )</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div>
<div class="line"><a name="l01129"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gabe5ac653e50883a2ef9882c4a71db4e3"> 1129</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="group___poly_mesh2d.html#gabe5ac653e50883a2ef9882c4a71db4e3">meshseedstring</a>( seedString, msInt )</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(inout)</span> :: seedString</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: msInt</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordflow">select case</span> (msint)</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#gaf2cfb545db8575bc18fc6253237e73c7">tri_hex_seed</a> )</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            <span class="keyword">write</span>(seedstring,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&quot;TRI_HEX_SEED&quot;</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga636f1fabdc68cceaed7ec93ead08f5da">quad_rect_seed</a>)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            <span class="keyword">write</span>(seedstring,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&quot;QUAD_RECT_SEED&quot;</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga25b568399757c4e2308aa806733bcd3d">quad_rect_periodic_seed</a>)</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            <span class="keyword">write</span>(seedstring,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&quot;QUAD_RECT_PERIODIC_SEED&quot;</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga35dcc64ada6c741826a800207006de61">polar_disc_seed</a>)</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            <span class="keyword">write</span>(seedstring,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&quot;POLAR_DISC_SEED&quot;</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga35a21a5cba53195488e52439e87ac646">icos_tri_sphere_seed</a>)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <span class="keyword">write</span>(seedstring,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&quot;ICOS_TRI_SPHERE_SEED&quot;</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#ga640e4ff4348f2124291f7f9229f52a56">cubed_sphere_seed</a>)</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keyword">write</span>(seedstring,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&quot;CUBED_SPHERE_SEED&quot;</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <span class="keywordflow">case</span> (<a class="code" href="group___number_kinds.html#gafdb49bdf25b09548a91b78d18ff15dc8">beta_plane_seed</a>)</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            <span class="keyword">write</span>(seedstring,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&quot;BETA_PLANE_SEED&quot;</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="keywordflow">        case default</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="keyword">write</span>(seedstring,<span class="stringliteral">&#39;(A)&#39;</span>) <span class="stringliteral">&quot;invalid seed&quot;</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordflow">end select</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01157"></a><span class="lineno"><a class="line" href="group___poly_mesh2d.html#gaad1fd171271a20088cb0c60d76fdeab5"> 1157</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="_beta_plane_gaussian_vortex_8f90.html#ae520c3b11d9e6c51c35d5cd67b503523">initlogger</a>(aLog,rank)</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">! Initialize a logger for this module and processor</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structloggermodule_1_1logger.html">logger</a>), <span class="keywordtype">intent(out)</span> :: aLog</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordtype">integer(kint)</span>, <span class="keywordtype">intent(in)</span> :: rank</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keyword">write</span>(<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>,<span class="stringliteral">&#39;(A,A,I0.2,A)&#39;</span>) trim(<a class="code" href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">logkey</a>),<span class="stringliteral">&#39;_&#39;</span>,rank,<span class="stringliteral">&#39; : &#39;</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordflow">if</span> ( rank == 0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        call <a class="code" href="interfacepolymesh2dmodule_1_1new.html">new</a>(alog,<a class="code" href="group___beta_plane.html#ga0487cc8c35598f1803a4558f2f3f706b">loglevel</a>)</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        call <a class="code" href="interfacepolymesh2dmodule_1_1new.html">new</a>(alog,<a class="code" href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">error_logging_level</a>)</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <a class="code" href="group___beta_plane.html#gab330e19580bc40d2bad4d63cf8df3bf1">loginit</a> = .true.</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="keyword">end subroutine</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keyword">end module</span></div>
<div class="ttc" id="group___poly_mesh2d_html_gaf4f674c5eecaaf0c15c43dcf51a39b65"><div class="ttname"><a href="group___poly_mesh2d.html#gaf4f674c5eecaaf0c15c43dcf51a39b65">polymesh2dmodule::polymesh2d::meshseed</a></div><div class="ttdeci">integer(kint) meshseed</div><div class="ttdoc">mesh seed as defined in NumberKinds </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00090">PolyMesh2d.f90:90</a></div></div>
<div class="ttc" id="group___number_kinds_html_ga8cddcd3d76142fa9d1c20388f293e1d5"><div class="ttname"><a href="group___number_kinds.html#ga8cddcd3d76142fa9d1c20388f293e1d5">numberkindsmodule::sphere_geom</a></div><div class="ttdeci">integer(kint), parameter sphere_geom</div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00053">NumberKinds.f90:53</a></div></div>
<div class="ttc" id="group___number_kinds_html_gae275628322d1dedf50a022f740d88e22"><div class="ttname"><a href="group___number_kinds.html#gae275628322d1dedf50a022f740d88e22">numberkindsmodule::read_unit</a></div><div class="ttdeci">integer(kint), parameter read_unit</div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00044">NumberKinds.f90:44</a></div></div>
<div class="ttc" id="group___edges_html_gad66ce7949274bca33fe7123d9ee2e229"><div class="ttname"><a href="group___edges.html#gad66ce7949274bca33fe7123d9ee2e229">edgesmodule::writeedgestomatlab</a></div><div class="ttdeci">subroutine, public writeedgestomatlab(self, fileunit)</div><div class="ttdoc">Writes the edges data structure to a .m file for later reading by Matlab. For debugging. </div><div class="ttdef"><b>Definition:</b> <a href="_edges_8f90_source.html#l00338">Edges.f90:338</a></div></div>
<div class="ttc" id="group___number_kinds_html_gaf2cfb545db8575bc18fc6253237e73c7"><div class="ttname"><a href="group___number_kinds.html#gaf2cfb545db8575bc18fc6253237e73c7">numberkindsmodule::tri_hex_seed</a></div><div class="ttdeci">integer(kint), parameter tri_hex_seed</div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00063">NumberKinds.f90:63</a></div></div>
<div class="ttc" id="interfacepolymesh2dmodule_1_1copy_html"><div class="ttname"><a href="interfacepolymesh2dmodule_1_1copy.html">polymesh2dmodule::copy</a></div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00107">PolyMesh2d.f90:107</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga12657c955905ee8e5450ba9861b3ae38"><div class="ttname"><a href="group___poly_mesh2d.html#ga12657c955905ee8e5450ba9861b3ae38">polymesh2dmodule::readseedfile</a></div><div class="ttdeci">subroutine readseedfile(self, seedFilename, nParticles, nEdges, nFaces, seedXYZ, seedEdgeOrigs, seedEdgeDests, seedEdgeLefts, seedEdgeRights, seedFaceVerts, seedFaceEdges, seedVertexDegree)</div><div class="ttdoc">Reads data from a mesh seed .dat file. </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00956">PolyMesh2d.f90:956</a></div></div>
<div class="ttc" id="classfacesmodule_html"><div class="ttname"><a href="classfacesmodule.html">facesmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00001">Faces.f90:1</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_gabe5ac653e50883a2ef9882c4a71db4e3"><div class="ttname"><a href="group___poly_mesh2d.html#gabe5ac653e50883a2ef9882c4a71db4e3">polymesh2dmodule::meshseedstring</a></div><div class="ttdeci">subroutine, public meshseedstring(seedString, msInt)</div><div class="ttdoc">Converts the integer definitions of mesh seeds (from NumberKinds) to their corresponding strings...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l01129">PolyMesh2d.f90:1129</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga492096c959c5c4ff457619c32a5a5ad0"><div class="ttname"><a href="group___poly_mesh2d.html#ga492096c959c5c4ff457619c32a5a5ad0">polymesh2dmodule::polymesh2d::amrlimit</a></div><div class="ttdeci">integer(kint) amrlimit</div><div class="ttdoc">Number of times a face may be divided beyond the initial refinement level. </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00092">PolyMesh2d.f90:92</a></div></div>
<div class="ttc" id="group___faces_html_gabe57e9083f933fd8fde83ca63c10ed27"><div class="ttname"><a href="group___faces.html#gabe57e9083f933fd8fde83ca63c10ed27">facesmodule::insertface</a></div><div class="ttdeci">subroutine, public insertface(self, centerParticle, vertIndices, edgeIndices)</div><div class="ttdoc">Inserts a new face into the faces data structure. Increases faces.N by 1. </div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00891">Faces.f90:891</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga1117b877c1ee6f1d5f023adafdd9c4fc"><div class="ttname"><a href="group___poly_mesh2d.html#ga1117b877c1ee6f1d5f023adafdd9c4fc">polymesh2dmodule::ccwedgesaroundface</a></div><div class="ttdeci">subroutine, public ccwedgesaroundface(self, leafEdges, faceIndex)</div><div class="ttdoc">Returns an STDIntVector containing indices of Edges around a face, listed in counter-clockwise order...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00336">PolyMesh2d.f90:336</a></div></div>
<div class="ttc" id="classspheregeommodule_html"><div class="ttname"><a href="classspheregeommodule.html">spheregeommodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_sphere_geometry_8f90_source.html#l00001">SphereGeometry.f90:1</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga082e5d07a4b57d70132a42b514cdec79"><div class="ttname"><a href="group___poly_mesh2d.html#ga082e5d07a4b57d70132a42b514cdec79">polymesh2dmodule::polymesh2d::t</a></div><div class="ttdeci">real(kreal) t</div><div class="ttdoc">time value represented by the mesh </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00093">PolyMesh2d.f90:93</a></div></div>
<div class="ttc" id="group___number_kinds_html_ga35a21a5cba53195488e52439e87ac646"><div class="ttname"><a href="group___number_kinds.html#ga35a21a5cba53195488e52439e87ac646">numberkindsmodule::icos_tri_sphere_seed</a></div><div class="ttdeci">integer(kint), parameter icos_tri_sphere_seed</div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00067">NumberKinds.f90:67</a></div></div>
<div class="ttc" id="structparticlesmodule_1_1particles_html"><div class="ttname"><a href="structparticlesmodule_1_1particles.html">particlesmodule::particles</a></div><div class="ttdoc">Class used to define a spatial discretization that may move in physical space. </div><div class="ttdef"><b>Definition:</b> <a href="_particles_8f90_source.html#l00060">Particles.f90:60</a></div></div>
<div class="ttc" id="group___edges_html_ga8d513bf915a852368881033ffc2d6e8c"><div class="ttname"><a href="group___edges.html#ga8d513bf915a852368881033ffc2d6e8c">edgesmodule::avgedgelength</a></div><div class="ttdeci">real(kreal) function, public avgedgelength(self, aParticles)</div><div class="ttdoc">Computes the average edge length amongst all leaf edges. </div><div class="ttdef"><b>Definition:</b> <a href="_edges_8f90_source.html#l00317">Edges.f90:317</a></div></div>
<div class="ttc" id="group___beta_plane_html_ga841833b0c71eea8360137b0dd71510b9"><div class="ttname"><a href="group___beta_plane.html#ga841833b0c71eea8360137b0dd71510b9">betaplanemeshmodule::log</a></div><div class="ttdeci">type(logger) log</div><div class="ttdef"><b>Definition:</b> <a href="_beta_plane_8f90_source.html#l00095">BetaPlane.f90:95</a></div></div>
<div class="ttc" id="structstdintvectormodule_1_1stdintvector_html"><div class="ttname"><a href="structstdintvectormodule_1_1stdintvector.html">stdintvectormodule::stdintvector</a></div><div class="ttdef"><b>Definition:</b> <a href="_s_t_d_int_vector_8f90_source.html#l00018">STDIntVector.f90:18</a></div></div>
<div class="ttc" id="classnumberkindsmodule_html"><div class="ttname"><a href="classnumberkindsmodule.html">numberkindsmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00001">NumberKinds.f90:1</a></div></div>
<div class="ttc" id="interfaceoutputwritermodule_1_1startsection_html"><div class="ttname"><a href="interfaceoutputwritermodule_1_1startsection.html">outputwritermodule::startsection</a></div><div class="ttdoc">Starts an indented section. </div><div class="ttdef"><b>Definition:</b> <a href="_output_writer_8f90_source.html#l00062">OutputWriter.f90:62</a></div></div>
<div class="ttc" id="group___beta_plane_html_ga20c169b731ae61d90e833c9348cd452a"><div class="ttname"><a href="group___beta_plane.html#ga20c169b731ae61d90e833c9348cd452a">betaplanemeshmodule::logstats::logstatsprivate</a></div><div class="ttdeci">subroutine logstatsprivate(self, aLog)</div><div class="ttdef"><b>Definition:</b> <a href="_beta_plane_8f90_source.html#l00197">BetaPlane.f90:197</a></div></div>
<div class="ttc" id="group___logger_html_ga1d52449f4ca792db29474f53836a6cc9"><div class="ttname"><a href="group___logger.html#ga1d52449f4ca792db29474f53836a6cc9">loggermodule::error_logging_level</a></div><div class="ttdeci">integer(kint), parameter, public error_logging_level</div><div class="ttdoc">Priority level for error messages. </div><div class="ttdef"><b>Definition:</b> <a href="_logger_8f90_source.html#l00045">Logger.f90:45</a></div></div>
<div class="ttc" id="group___faces_html_gaf6e475859ade30ee3b9481340bf46241"><div class="ttname"><a href="group___faces.html#gaf6e475859ade30ee3b9481340bf46241">facesmodule::facecentroid</a></div><div class="ttdeci">real(kreal) function, dimension(3), public facecentroid(self, index, aParticles)</div><div class="ttdoc">Computes the centroid (in physical space) of a face based on its vertices. </div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00982">Faces.f90:982</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga5939ae9ed03009c95328b9d189f3a3de"><div class="ttname"><a href="group___poly_mesh2d.html#ga5939ae9ed03009c95328b9d189f3a3de">polymesh2dmodule::locatepointwalksearch</a></div><div class="ttdeci">recursive integer(kint) function locatepointwalksearch(self, queryPt, index)</div><div class="ttdoc">Performs a walk search of a Faces object to locate the face containing a query point. Accelerated by using the output of a tree search for its first guess. </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00660">PolyMesh2d.f90:660</a></div></div>
<div class="ttc" id="group___number_kinds_html_ga35dcc64ada6c741826a800207006de61"><div class="ttname"><a href="group___number_kinds.html#ga35dcc64ada6c741826a800207006de61">numberkindsmodule::polar_disc_seed</a></div><div class="ttdeci">integer(kint), parameter polar_disc_seed</div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00065">NumberKinds.f90:65</a></div></div>
<div class="ttc" id="group___particles_html_gace4db7f6a46e05fbcde2d1b53de3d602"><div class="ttname"><a href="group___particles.html#gace4db7f6a46e05fbcde2d1b53de3d602">particlesmodule::writevtkpoints</a></div><div class="ttdeci">subroutine, public writevtkpoints(self, fileunit, title)</div><div class="ttdoc">Writes VTK point data to a .vtk file in vtk legacy version 2.0 PolyData format. Used for plotting wit...</div><div class="ttdef"><b>Definition:</b> <a href="_particles_8f90_source.html#l00367">Particles.f90:367</a></div></div>
<div class="ttc" id="group___number_kinds_html_ga636f1fabdc68cceaed7ec93ead08f5da"><div class="ttname"><a href="group___number_kinds.html#ga636f1fabdc68cceaed7ec93ead08f5da">numberkindsmodule::quad_rect_seed</a></div><div class="ttdeci">integer(kint), parameter quad_rect_seed</div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00064">NumberKinds.f90:64</a></div></div>
<div class="ttc" id="group___sphere_geom_html_ga842d3856281acd8492c9b00a4804f67b"><div class="ttname"><a href="group___sphere_geom.html#ga842d3856281acd8492c9b00a4804f67b">spheregeommodule::chorddistance</a></div><div class="ttdeci">pure real(kreal) function chorddistance(xyzA, xyzB)</div><div class="ttdoc">Euclidean distance between two points on the sphere. </div><div class="ttdef"><b>Definition:</b> <a href="_sphere_geometry_8f90_source.html#l00066">SphereGeometry.f90:66</a></div></div>
<div class="ttc" id="group___faces_html_ga6bb2ead1ad72a0789a4eef0de7d2ac02"><div class="ttname"><a href="group___faces.html#ga6bb2ead1ad72a0789a4eef0de7d2ac02">facesmodule::dividetriface</a></div><div class="ttdeci">subroutine, public dividetriface(self, faceIndex, aParticles, anEdges)</div><div class="ttdoc">This is a primary subroutine used by any triangular mesh (spherical or planar). It divides a triangul...</div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00701">Faces.f90:701</a></div></div>
<div class="ttc" id="group___number_kinds_html_ga7c6975d710b4d578d515c3d3312043fc"><div class="ttname"><a href="group___number_kinds.html#ga7c6975d710b4d578d515c3d3312043fc">numberkindsmodule::procrank</a></div><div class="ttdeci">integer(kint), save procrank</div><div class="ttdoc">process rank </div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00073">NumberKinds.f90:73</a></div></div>
<div class="ttc" id="group___edges_html_ga5b41877544b39672945e644eca1b46f9"><div class="ttname"><a href="group___edges.html#ga5b41877544b39672945e644eca1b46f9">edgesmodule::onboundary</a></div><div class="ttdeci">logical(klog) function, public onboundary(anEdges, edgeIndex)</div><div class="ttdoc">Returns .TRUE. if an edge is on the boundary of a mesh (does not apply to spherical meshes...</div><div class="ttdef"><b>Definition:</b> <a href="_edges_8f90_source.html#l00679">Edges.f90:679</a></div></div>
<div class="ttc" id="group___faces_html_ga4c3811ba7df19b43915c3fd70ceaa16d"><div class="ttname"><a href="group___faces.html#ga4c3811ba7df19b43915c3fd70ceaa16d">facesmodule::writefacestomatlab</a></div><div class="ttdeci">subroutine, public writefacestomatlab(self, fileunit)</div><div class="ttdoc">Outputs data associated with a faces object, including all connectivity information, to a Matlab-readable .m file. </div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00447">Faces.f90:447</a></div></div>
<div class="ttc" id="interfacepolymesh2dmodule_1_1delete_html"><div class="ttname"><a href="interfacepolymesh2dmodule_1_1delete.html">polymesh2dmodule::delete</a></div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00103">PolyMesh2d.f90:103</a></div></div>
<div class="ttc" id="group___beta_plane_html_ga0487cc8c35598f1803a4558f2f3f706b"><div class="ttname"><a href="group___beta_plane.html#ga0487cc8c35598f1803a4558f2f3f706b">betaplanemeshmodule::loglevel</a></div><div class="ttdeci">integer(kint), parameter loglevel</div><div class="ttdef"><b>Definition:</b> <a href="_beta_plane_8f90_source.html#l00097">BetaPlane.f90:97</a></div></div>
<div class="ttc" id="group___particles_html_ga99c4e2d0644382ee76091d7f5e695614"><div class="ttname"><a href="group___particles.html#ga99c4e2d0644382ee76091d7f5e695614">particlesmodule::writeparticlestomatlab</a></div><div class="ttdeci">subroutine, public writeparticlestomatlab(self, fileunit)</div><div class="ttdoc">Writes particles to a script .m file readable by Matlab. </div><div class="ttdef"><b>Definition:</b> <a href="_particles_8f90_source.html#l00650">Particles.f90:650</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_gafeeb682c17d2f3569c60dc52f8ef3cea"><div class="ttname"><a href="group___poly_mesh2d.html#gafeeb682c17d2f3569c60dc52f8ef3cea">polymesh2dmodule::facekindfromseed</a></div><div class="ttdeci">integer(kint) function facekindfromseed(seed)</div><div class="ttdoc">Determines the appropriate value of faceKind (as defined by NumberKinds) based on a specified mesh se...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00583">PolyMesh2d.f90:583</a></div></div>
<div class="ttc" id="group___output_writer_html_gac1138b013ddbabcd097387f0b2108edb"><div class="ttname"><a href="group___output_writer.html#gac1138b013ddbabcd097387f0b2108edb">outputwritermodule::writevtkpointdatasectionheader</a></div><div class="ttdeci">subroutine, public writevtkpointdatasectionheader(fileunit, nPoints)</div><div class="ttdoc">Writes the section header for VTK Point Data in a legacy formatted .vtk file. </div><div class="ttdef"><b>Definition:</b> <a href="_output_writer_8f90_source.html#l00265">OutputWriter.f90:265</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga65267322a5536d5acdf15f2ec649f516"><div class="ttname"><a href="group___poly_mesh2d.html#ga65267322a5536d5acdf15f2ec649f516">polymesh2dmodule::locatepointtreesearch</a></div><div class="ttdeci">recursive integer(kint) function locatepointtreesearch(self, queryPt, index)</div><div class="ttdoc">Performs a tree search of a Faces object to locate the face containing a query point. Used to initialize a walk search. </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00618">PolyMesh2d.f90:618</a></div></div>
<div class="ttc" id="group___edges_html_ga03cc8cee87e4a23dbab6d7c95def2a4e"><div class="ttname"><a href="group___edges.html#ga03cc8cee87e4a23dbab6d7c95def2a4e">edgesmodule::positiveedge</a></div><div class="ttdeci">logical(klog) function, public positiveedge(anEdges, faceIndex, edgeIndex)</div><div class="ttdoc">Returns .TRUE. if an edge has positive orientation relative to the selected face. ...</div><div class="ttdef"><b>Definition:</b> <a href="_edges_8f90_source.html#l00667">Edges.f90:667</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_gaec4398a712feb200a284a04c7da490ed"><div class="ttname"><a href="group___poly_mesh2d.html#gaec4398a712feb200a284a04c7da490ed">polymesh2dmodule::ccwverticesaroundface</a></div><div class="ttdeci">subroutine, public ccwverticesaroundface(self, verts, faceIndex)</div><div class="ttdoc">Returns an STDIntVector containing indices of vertex Particles around a face, listed in counter-clock...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00369">PolyMesh2d.f90:369</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_gacb9154c9633d010075c5c7827de64288"><div class="ttname"><a href="group___poly_mesh2d.html#gacb9154c9633d010075c5c7827de64288">polymesh2dmodule::nverticesinmesh</a></div><div class="ttdeci">integer(kint) function nverticesinmesh(self, initNest)</div><div class="ttdoc">Computes the number of vertices in a uniformly refined mesh. Used to compute memory allocation requir...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00717">PolyMesh2d.f90:717</a></div></div>
<div class="ttc" id="group___faces_html_gaee6c673285b09641f5a63f1f273f92f2"><div class="ttname"><a href="group___faces.html#gaee6c673285b09641f5a63f1f273f92f2">facesmodule::dividequadface</a></div><div class="ttdeci">subroutine, public dividequadface(self, faceIndex, aParticles, anEdges)</div><div class="ttdoc">This is a primary subroutine used by any quadrilateral mesh (spherical or planar). It divides a quadrilateral face into 4 children, adding a 4 leaves to the faces quadtree. It creates new particles and new edges. It replaces divided edges with their appropriate children. </div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00529">Faces.f90:529</a></div></div>
<div class="ttc" id="group___particles_html_ga0f39d7be727a5229816c5e1d1e3e531a"><div class="ttname"><a href="group___particles.html#ga0f39d7be727a5229816c5e1d1e3e531a">particlesmodule::writevtklagcoords</a></div><div class="ttdeci">subroutine, public writevtklagcoords(self, fileunit)</div><div class="ttdoc">Writes a particle set&#39;s Lagrangian coordinates to VTK PolyData Output. </div><div class="ttdef"><b>Definition:</b> <a href="_particles_8f90_source.html#l00394">Particles.f90:394</a></div></div>
<div class="ttc" id="group___beta_plane_html_ga4bae2f41688d6493cb2a5aa0b4451c86"><div class="ttname"><a href="group___beta_plane.html#ga4bae2f41688d6493cb2a5aa0b4451c86">betaplanemeshmodule::new::newprivate</a></div><div class="ttdeci">subroutine newprivate(self, initNest, maxNest, amrLimit, baseLat, rotRate)</div><div class="ttdef"><b>Definition:</b> <a href="_beta_plane_8f90_source.html#l00106">BetaPlane.f90:106</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga2061ff775ab982970e84df296a749336"><div class="ttname"><a href="group___poly_mesh2d.html#ga2061ff775ab982970e84df296a749336">polymesh2dmodule::nearestrootface</a></div><div class="ttdeci">integer(kint) function nearestrootface(self, queryPt)</div><div class="ttdoc">Finds the nearest root face (faces included in the mesh seed, with no parents) to an arbitrary query ...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00535">PolyMesh2d.f90:535</a></div></div>
<div class="ttc" id="group___number_kinds_html_ga37240f10dd8db77f985349602bd8844f"><div class="ttname"><a href="group___number_kinds.html#ga37240f10dd8db77f985349602bd8844f">numberkindsmodule::planar_geom</a></div><div class="ttdeci">integer(kint), parameter planar_geom</div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00052">NumberKinds.f90:52</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga468903cecff6b19516047d81fc186715"><div class="ttname"><a href="group___poly_mesh2d.html#ga468903cecff6b19516047d81fc186715">polymesh2dmodule::projectparticlestosphere</a></div><div class="ttdeci">subroutine, public projectparticlestosphere(self, radius)</div><div class="ttdoc">Projects all particles in a mesh to the surface of a sphere with a user-specified radius...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00395">PolyMesh2d.f90:395</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga9e3a8f08670e896630624fae230a6073"><div class="ttname"><a href="group___poly_mesh2d.html#ga9e3a8f08670e896630624fae230a6073">polymesh2dmodule::geomkindfromseed</a></div><div class="ttdeci">integer(kint) function geomkindfromseed(seed)</div><div class="ttdoc">Determines the geometry (as defined by NumberKinds) based on a specified mesh seed. </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00598">PolyMesh2d.f90:598</a></div></div>
<div class="ttc" id="interfaceoutputwritermodule_1_1endsection_html"><div class="ttname"><a href="interfaceoutputwritermodule_1_1endsection.html">outputwritermodule::endsection</a></div><div class="ttdoc">Ends an indented section. </div><div class="ttdef"><b>Definition:</b> <a href="_output_writer_8f90_source.html#l00068">OutputWriter.f90:68</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga319d43beccd27ec88cfed64503140304"><div class="ttname"><a href="group___poly_mesh2d.html#ga319d43beccd27ec88cfed64503140304">polymesh2dmodule::locatefacecontainingpoint</a></div><div class="ttdeci">integer(kint) function, public locatefacecontainingpoint(self, queryPt)</div><div class="ttdoc">Locates the face containing an arbitrary query point. This function assumes faces are convex polygons...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00273">PolyMesh2d.f90:273</a></div></div>
<div class="ttc" id="group___logger_html_gadb73c4aacaf084ae41abab66967cf5ca"><div class="ttname"><a href="group___logger.html#gadb73c4aacaf084ae41abab66967cf5ca">loggermodule::trace_logging_level</a></div><div class="ttdeci">integer(kint), parameter, public trace_logging_level</div><div class="ttdoc">Priority level for trace-related messages and general remarks. </div><div class="ttdef"><b>Definition:</b> <a href="_logger_8f90_source.html#l00043">Logger.f90:43</a></div></div>
<div class="ttc" id="interfacepolymesh2dmodule_1_1logstats_html"><div class="ttname"><a href="interfacepolymesh2dmodule_1_1logstats.html">polymesh2dmodule::logstats</a></div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00111">PolyMesh2d.f90:111</a></div></div>
<div class="ttc" id="group___edges_html_ga1d52efbbd14af28e7b9d83606cd664ce"><div class="ttname"><a href="group___edges.html#ga1d52efbbd14af28e7b9d83606cd664ce">edgesmodule::getleafedgesfromparent</a></div><div class="ttdeci">subroutine, public getleafedgesfromparent(anEdges, parentIndex, leafEdges)</div><div class="ttdoc">Builds a STDIntVector containing the indices of all of an edge&#39;s children. </div><div class="ttdef"><b>Definition:</b> <a href="_edges_8f90_source.html#l00691">Edges.f90:691</a></div></div>
<div class="ttc" id="group___faces_html_ga8fb7d3a1d52c5e3833987e29590c9845"><div class="ttname"><a href="group___faces.html#ga8fb7d3a1d52c5e3833987e29590c9845">facesmodule::writefaceareatovtkcelldata</a></div><div class="ttdeci">subroutine, public writefaceareatovtkcelldata(self, aParticles, fileunit)</div><div class="ttdoc">Outputs face areas data to a legacy format .vtk ASCII file. Note: This subroutine must be called in t...</div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00418">Faces.f90:418</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_gac803dbb3b64c4971577efb6a7d1389c2"><div class="ttname"><a href="group___poly_mesh2d.html#gac803dbb3b64c4971577efb6a7d1389c2">polymesh2dmodule::writemeshtovtkpolydata</a></div><div class="ttdeci">subroutine, public writemeshtovtkpolydata(self, fileunit, title)</div><div class="ttdoc">Outputs a mesh to a legacy formatted .vtk ASCII file. Does not output any Field data. </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l01093">PolyMesh2d.f90:1093</a></div></div>
<div class="ttc" id="classoutputwritermodule_html"><div class="ttname"><a href="classoutputwritermodule.html">outputwritermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_output_writer_8f90_source.html#l00001">OutputWriter.f90:1</a></div></div>
<div class="ttc" id="group___edges_html_gad2d36ea3105ac6652300c5a35f451978"><div class="ttname"><a href="group___edges.html#gad2d36ea3105ac6652300c5a35f451978">edgesmodule::minedgelength</a></div><div class="ttdeci">real(kreal) function, public minedgelength(self, aParticles)</div><div class="ttdoc">Computes the minimum edge length amongst all leaf edges. </div><div class="ttdef"><b>Definition:</b> <a href="_edges_8f90_source.html#l00296">Edges.f90:296</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga80dca1b2be22f127129a06a0723de065"><div class="ttname"><a href="group___poly_mesh2d.html#ga80dca1b2be22f127129a06a0723de065">polymesh2dmodule::writemeshtomatlab</a></div><div class="ttdeci">subroutine, public writemeshtomatlab(self, fileunit)</div><div class="ttdoc">Writes a mesh to a Matlab-readable .m file. </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l01049">PolyMesh2d.f90:1049</a></div></div>
<div class="ttc" id="group___particles_html_gae7a75e01ef357d8fc745565dd883acf8"><div class="ttname"><a href="group___particles.html#gae7a75e01ef357d8fc745565dd883acf8">particlesmodule::particles::geomkind</a></div><div class="ttdeci">integer(kint) geomkind</div><div class="ttdef"><b>Definition:</b> <a href="_particles_8f90_source.html#l00076">Particles.f90:76</a></div></div>
<div class="ttc" id="group___number_kinds_html_gafdb49bdf25b09548a91b78d18ff15dc8"><div class="ttname"><a href="group___number_kinds.html#gafdb49bdf25b09548a91b78d18ff15dc8">numberkindsmodule::beta_plane_seed</a></div><div class="ttdeci">integer(kint), parameter beta_plane_seed</div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00069">NumberKinds.f90:69</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_gadf892dde1a232cba2c3a18ad9cf8c724"><div class="ttname"><a href="group___poly_mesh2d.html#gadf892dde1a232cba2c3a18ad9cf8c724">polymesh2dmodule::nearestparticle</a></div><div class="ttdeci">integer(kint) function, public nearestparticle(self, queryPt)</div><div class="ttdoc">Finds the particle closest to an arbitrary query point. </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00296">PolyMesh2d.f90:296</a></div></div>
<div class="ttc" id="group___faces_html_ga6a872b75ce2c75e9f4d39c2ec44a367e"><div class="ttname"><a href="group___faces.html#ga6a872b75ce2c75e9f4d39c2ec44a367e">facesmodule::quadfacearea</a></div><div class="ttdeci">real(kreal) function, public quadfacearea(self, index, aParticles)</div><div class="ttdoc">Determines the area of a quadrilateral face. Assumes the face has exactly 4 edges (Does not account f...</div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00917">Faces.f90:917</a></div></div>
<div class="ttc" id="classparticlesmodule_html"><div class="ttname"><a href="classparticlesmodule.html">particlesmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_particles_8f90_source.html#l00001">Particles.f90:1</a></div></div>
<div class="ttc" id="group___edges_html_ga8102d56956d485a8dff75cb6d44d9195"><div class="ttname"><a href="group___edges.html#ga8102d56956d485a8dff75cb6d44d9195">edgesmodule::insertedge</a></div><div class="ttdeci">subroutine, public insertedge(self, aParticles, origIndex, destIndex, leftFace, rightFace)</div><div class="ttdoc">Inserts an edge to the end of an edges object. Increase edges.N by one. </div><div class="ttdef"><b>Definition:</b> <a href="_edges_8f90_source.html#l00204">Edges.f90:204</a></div></div>
<div class="ttc" id="classloggermodule_html"><div class="ttname"><a href="classloggermodule.html">loggermodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_logger_8f90_source.html#l00001">Logger.f90:1</a></div></div>
<div class="ttc" id="group___number_kinds_html_gac5f366e59a1a142274f1abf9a3895188"><div class="ttname"><a href="group___number_kinds.html#gac5f366e59a1a142274f1abf9a3895188">numberkindsmodule::tri_panel</a></div><div class="ttdeci">integer(kint), parameter tri_panel</div><div class="ttdoc">panelKind parameter for triangular panels </div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00051">NumberKinds.f90:51</a></div></div>
<div class="ttc" id="structpolymesh2dmodule_1_1polymesh2d_html"><div class="ttname"><a href="structpolymesh2dmodule_1_1polymesh2d.html">polymesh2dmodule::polymesh2d</a></div><div class="ttdoc">Combines mesh primitives into one complete mesh object. </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00084">PolyMesh2d.f90:84</a></div></div>
<div class="ttc" id="group___s_t_d_int_vector_html_gac9b58809dfdbc98ef87a4992e441b5fb"><div class="ttname"><a href="group___s_t_d_int_vector.html#gac9b58809dfdbc98ef87a4992e441b5fb">stdintvectormodule::stdintvector::print</a></div><div class="ttdeci">procedure, public print</div><div class="ttdef"><b>Definition:</b> <a href="_s_t_d_int_vector_8f90_source.html#l00033">STDIntVector.f90:33</a></div></div>
<div class="ttc" id="group___faces_html_ga3665511c613ed29b874eaaad1ca686a3"><div class="ttname"><a href="group___faces.html#ga3665511c613ed29b874eaaad1ca686a3">facesmodule::faces::facekind</a></div><div class="ttdeci">integer(kint) facekind</div><div class="ttdoc">identifies type of face (e.g., triangular, quadrilateral, etc.) </div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00057">Faces.f90:57</a></div></div>
<div class="ttc" id="group___faces_html_gacf7e3c70546c5d562a5a2de19f8553df"><div class="ttname"><a href="group___faces.html#gacf7e3c70546c5d562a5a2de19f8553df">facesmodule::trifacearea</a></div><div class="ttdeci">real(kreal) function, public trifacearea(self, index, aParticles)</div><div class="ttdoc">Determines the area of a triangular face. Assumes the face has exactly 3 edges (Does not account for ...</div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00950">Faces.f90:950</a></div></div>
<div class="ttc" id="group___particles_html_ga2d7dd758e03af6213d9b451bea2cd9cd"><div class="ttname"><a href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd">particlesmodule::physcoord</a></div><div class="ttdeci">pure real(kreal) function, dimension(3), public physcoord(self, index)</div><div class="ttdoc">Returns a particle&#39;s physical coordinate vector. </div><div class="ttdef"><b>Definition:</b> <a href="_particles_8f90_source.html#l00604">Particles.f90:604</a></div></div>
<div class="ttc" id="structloggermodule_1_1logger_html"><div class="ttname"><a href="structloggermodule_1_1logger.html">loggermodule::logger</a></div><div class="ttdef"><b>Definition:</b> <a href="_logger_8f90_source.html#l00047">Logger.f90:47</a></div></div>
<div class="ttc" id="group___particles_html_gad4afc4ad448d5d077be29dd1a7d1cc21"><div class="ttname"><a href="group___particles.html#gad4afc4ad448d5d077be29dd1a7d1cc21">particlesmodule::lagcoord</a></div><div class="ttdeci">pure real(kreal) function, dimension(3), public lagcoord(self, index)</div><div class="ttdoc">Returns a particle&#39;s Lagrangian coordinate vector. </div><div class="ttdef"><b>Definition:</b> <a href="_particles_8f90_source.html#l00618">Particles.f90:618</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_gac6d0b7794f35292c47d247c65d58582b"><div class="ttname"><a href="group___poly_mesh2d.html#gac6d0b7794f35292c47d247c65d58582b">polymesh2dmodule::polymesh2d::initnest</a></div><div class="ttdeci">integer(kint) initnest</div><div class="ttdoc">initial refinement level (in terms of the Faces quadtree) for a mesh </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00091">PolyMesh2d.f90:91</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga18991ddade171ee044e7d7dfb2694979"><div class="ttname"><a href="group___poly_mesh2d.html#ga18991ddade171ee044e7d7dfb2694979">polymesh2dmodule::nfacesinmesh</a></div><div class="ttdeci">integer(kint) function nfacesinmesh(self, initNest)</div><div class="ttdoc">Computes the number of faces in a uniformly refined mesh. Used to compute memory allocation requireme...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00750">PolyMesh2d.f90:750</a></div></div>
<div class="ttc" id="classedgesmodule_html"><div class="ttname"><a href="classedgesmodule.html">edgesmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_edges_8f90_source.html#l00001">Edges.f90:1</a></div></div>
<div class="ttc" id="group___particles_html_ga550e2ee3c6c4a9cc0e1c27cfb1071571"><div class="ttname"><a href="group___particles.html#ga550e2ee3c6c4a9cc0e1c27cfb1071571">particlesmodule::sortincidentedgesatparticle</a></div><div class="ttdeci">subroutine, public sortincidentedgesatparticle(self, index)</div><div class="ttdoc">Sorts the incident edges at a particle into counter-clockwise order using a bubble-sort algorithm...</div><div class="ttdef"><b>Definition:</b> <a href="_particles_8f90_source.html#l00544">Particles.f90:544</a></div></div>
<div class="ttc" id="structfacesmodule_1_1faces_html"><div class="ttname"><a href="structfacesmodule_1_1faces.html">facesmodule::faces</a></div><div class="ttdoc">Each faces knows the indices (to Particles) of its vertices and center and the indices (to Edges) of ...</div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00050">Faces.f90:50</a></div></div>
<div class="ttc" id="interfacestdintvectormodule_1_1initialize_html"><div class="ttname"><a href="interfacestdintvectormodule_1_1initialize.html">stdintvectormodule::initialize</a></div><div class="ttdef"><b>Definition:</b> <a href="_s_t_d_int_vector_8f90_source.html#l00039">STDIntVector.f90:39</a></div></div>
<div class="ttc" id="structedgesmodule_1_1edges_html"><div class="ttname"><a href="structedgesmodule_1_1edges.html">edgesmodule::edges</a></div><div class="ttdoc">Edges know the indices (to Particles) of their origin and destination, and the indices (to Faces) of ...</div><div class="ttdef"><b>Definition:</b> <a href="_edges_8f90_source.html#l00050">Edges.f90:50</a></div></div>
<div class="ttc" id="group___beta_plane_html_gab330e19580bc40d2bad4d63cf8df3bf1"><div class="ttname"><a href="group___beta_plane.html#gab330e19580bc40d2bad4d63cf8df3bf1">betaplanemeshmodule::loginit</a></div><div class="ttdeci">logical(klog), save loginit</div><div class="ttdef"><b>Definition:</b> <a href="_beta_plane_8f90_source.html#l00094">BetaPlane.f90:94</a></div></div>
<div class="ttc" id="group___edges_html_ga336ae9b8908174c080ab8c91bf665ed7"><div class="ttname"><a href="group___edges.html#ga336ae9b8908174c080ab8c91bf665ed7">edgesmodule::printdebuginfo::printdebugprivate</a></div><div class="ttdeci">subroutine printdebugprivate(self)</div><div class="ttdoc">Writes edges object values to the console. For debugging. </div><div class="ttdef"><b>Definition:</b> <a href="_edges_8f90_source.html#l00366">Edges.f90:366</a></div></div>
<div class="ttc" id="group___number_kinds_html_ga6f381220923147ab7b90625d35ed17d1"><div class="ttname"><a href="group___number_kinds.html#ga6f381220923147ab7b90625d35ed17d1">numberkindsmodule::euclidean_3d</a></div><div class="ttdeci">integer(kint), parameter euclidean_3d</div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00054">NumberKinds.f90:54</a></div></div>
<div class="ttc" id="group___number_kinds_html_ga640e4ff4348f2124291f7f9229f52a56"><div class="ttname"><a href="group___number_kinds.html#ga640e4ff4348f2124291f7f9229f52a56">numberkindsmodule::cubed_sphere_seed</a></div><div class="ttdeci">integer(kint), parameter cubed_sphere_seed</div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00068">NumberKinds.f90:68</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga515332a3f22d9fb7b09f408594eec185"><div class="ttname"><a href="group___poly_mesh2d.html#ga515332a3f22d9fb7b09f408594eec185">polymesh2dmodule::nedgesinmesh</a></div><div class="ttdeci">integer(kint) function nedgesinmesh(self, nVertices, nFaces)</div><div class="ttdoc">Uses the number of vertices and the number of faces (via Euler&#39;s formulas) to determine the the numbe...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00774">PolyMesh2d.f90:774</a></div></div>
<div class="ttc" id="classpolymesh2dmodule_html"><div class="ttname"><a href="classpolymesh2dmodule.html">polymesh2dmodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00001">PolyMesh2d.f90:1</a></div></div>
<div class="ttc" id="interfacepolymesh2dmodule_1_1new_html"><div class="ttname"><a href="interfacepolymesh2dmodule_1_1new.html">polymesh2dmodule::new</a></div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00099">PolyMesh2d.f90:99</a></div></div>
<div class="ttc" id="interfaceloggermodule_1_1logmessage_html"><div class="ttname"><a href="interfaceloggermodule_1_1logmessage.html">loggermodule::logmessage</a></div><div class="ttdoc">Common interface for logging various data types. </div><div class="ttdef"><b>Definition:</b> <a href="_logger_8f90_source.html#l00069">Logger.f90:69</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_gaa27f9cec0d6def839fbf8d2f388286a9"><div class="ttname"><a href="group___poly_mesh2d.html#gaa27f9cec0d6def839fbf8d2f388286a9">polymesh2dmodule::maxlagrangianvariationperface</a></div><div class="ttdeci">real(kreal) function, public maxlagrangianvariationperface(self)</div><div class="ttdoc">Computes the maximum variation of the Lagrangian parameter over all faces in a mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00231">PolyMesh2d.f90:231</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_gabfb6f53d3285a8e759173d4fc29f20d7"><div class="ttname"><a href="group___poly_mesh2d.html#gabfb6f53d3285a8e759173d4fc29f20d7">polymesh2dmodule::ccwfacesaroundvertex</a></div><div class="ttdeci">subroutine, public ccwfacesaroundvertex(self, adjFaces, vertexIndex)</div><div class="ttdoc">Returns an STDIntVector containing indices of Faces incident to a vertex, listed in counter-clockwise...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00500">PolyMesh2d.f90:500</a></div></div>
<div class="ttc" id="group___particles_html_ga97eb338e7996e4802d747fd46ae6a298"><div class="ttname"><a href="group___particles.html#ga97eb338e7996e4802d747fd46ae6a298">particlesmodule::makeparticleactive</a></div><div class="ttdeci">subroutine, public makeparticleactive(self, index)</div><div class="ttdoc">Changes a passive particle to an active particle. Area/volume must be set separately. </div><div class="ttdef"><b>Definition:</b> <a href="_particles_8f90_source.html#l00479">Particles.f90:479</a></div></div>
<div class="ttc" id="group___number_kinds_html_gab3062c50a0b035fca7077f04a8e49329"><div class="ttname"><a href="group___number_kinds.html#gab3062c50a0b035fca7077f04a8e49329">numberkindsmodule::quad_panel</a></div><div class="ttdeci">integer(kint), parameter quad_panel</div><div class="ttdoc">panelKind parameter for quadrilateral panels </div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00050">NumberKinds.f90:50</a></div></div>
<div class="ttc" id="group___sphere_geom_html_ga84b61f121a82f260ac48915a6826663f"><div class="ttname"><a href="group___sphere_geom.html#ga84b61f121a82f260ac48915a6826663f">spheregeommodule::spheretricenter</a></div><div class="ttdeci">pure real(kreal) function, dimension(3) spheretricenter(xyzA, xyzB, xyzC)</div><div class="ttdoc">Finds the centroid of a spherical triangle defined by three vertices. </div><div class="ttdef"><b>Definition:</b> <a href="_sphere_geometry_8f90_source.html#l00280">SphereGeometry.f90:280</a></div></div>
<div class="ttc" id="group___beta_plane_html_ga84602b5bc0f9100a75064e074f9432fc"><div class="ttname"><a href="group___beta_plane.html#ga84602b5bc0f9100a75064e074f9432fc">betaplanemeshmodule::betaplanemesh::deleteprivate</a></div><div class="ttdeci">final deleteprivate</div><div class="ttdef"><b>Definition:</b> <a href="_beta_plane_8f90_source.html#l00055">BetaPlane.f90:55</a></div></div>
<div class="ttc" id="group___beta_plane_html_ga420cd07c1487d63b43c3c0f5f31d67f4"><div class="ttname"><a href="group___beta_plane.html#ga420cd07c1487d63b43c3c0f5f31d67f4">betaplanemeshmodule::logkey</a></div><div class="ttdeci">character(len=28), save logkey</div><div class="ttdef"><b>Definition:</b> <a href="_beta_plane_8f90_source.html#l00096">BetaPlane.f90:96</a></div></div>
<div class="ttc" id="group___particles_html_gaf5dfbd586cef1f9579376c4624c65b02"><div class="ttname"><a href="group___particles.html#gaf5dfbd586cef1f9579376c4624c65b02">particlesmodule::insertparticle</a></div><div class="ttdeci">subroutine, public insertparticle(self, physX, lagX)</div><div class="ttdoc">Inserts a single particle into a particles object. </div><div class="ttdef"><b>Definition:</b> <a href="_particles_8f90_source.html#l00453">Particles.f90:453</a></div></div>
<div class="ttc" id="group___beta_plane_html_ga0c09fe438e6ad416b82181c0069ebb8e"><div class="ttname"><a href="group___beta_plane.html#ga0c09fe438e6ad416b82181c0069ebb8e">betaplanemeshmodule::logstring</a></div><div class="ttdeci">character(len=max_string_length) logstring</div><div class="ttdef"><b>Definition:</b> <a href="_beta_plane_8f90_source.html#l00098">BetaPlane.f90:98</a></div></div>
<div class="ttc" id="interfacespheregeommodule_1_1spheredistance_html"><div class="ttname"><a href="interfacespheregeommodule_1_1spheredistance.html">spheregeommodule::spheredistance</a></div><div class="ttdef"><b>Definition:</b> <a href="_sphere_geometry_8f90_source.html#l00030">SphereGeometry.f90:30</a></div></div>
<div class="ttc" id="group___logger_html_ga81b6e629b304bffe7abdd8de4a80e18e"><div class="ttname"><a href="group___logger.html#ga81b6e629b304bffe7abdd8de4a80e18e">loggermodule::warning_logging_level</a></div><div class="ttdeci">integer(kint), parameter, public warning_logging_level</div><div class="ttdoc">Priority level for warning messages. </div><div class="ttdef"><b>Definition:</b> <a href="_logger_8f90_source.html#l00044">Logger.f90:44</a></div></div>
<div class="ttc" id="_beta_plane_gaussian_vortex_8f90_html_ae520c3b11d9e6c51c35d5cd67b503523"><div class="ttname"><a href="_beta_plane_gaussian_vortex_8f90.html#ae520c3b11d9e6c51c35d5cd67b503523">initlogger</a></div><div class="ttdeci">subroutine initlogger(log, rank)</div><div class="ttdef"><b>Definition:</b> <a href="_beta_plane_gaussian_vortex_8f90_source.html#l00323">BetaPlaneGaussianVortex.f90:323</a></div></div>
<div class="ttc" id="group___faces_html_gaccf09c7b0e4d09609e2332db6595fef9"><div class="ttname"><a href="group___faces.html#gaccf09c7b0e4d09609e2332db6595fef9">facesmodule::writefacestovtkpolygons</a></div><div class="ttdeci">subroutine, public writefacestovtkpolygons(self, fileunit)</div><div class="ttdoc">Outputs connectivity data to a legacy format .vtk ASCII file. Note: This subroutine must be called in...</div><div class="ttdef"><b>Definition:</b> <a href="_faces_8f90_source.html#l00388">Faces.f90:388</a></div></div>
<div class="ttc" id="classstdintvectormodule_html"><div class="ttname"><a href="classstdintvectormodule.html">stdintvectormodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_s_t_d_int_vector_8f90_source.html#l00001">STDIntVector.f90:1</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga3afe4155924faf7adf8d9bcadd5dc942"><div class="ttname"><a href="group___poly_mesh2d.html#ga3afe4155924faf7adf8d9bcadd5dc942">polymesh2dmodule::initializemeshfromseed</a></div><div class="ttdeci">subroutine initializemeshfromseed(self, ampFactor)</div><div class="ttdoc">Initializes a mesh using a mesh seed .dat file to define the root set of Particles, Edges, and Faces. Mesh seeds are defined in both NumberKinds and via the corresponding .dat file. Multiplies particle postions by a specified amount to change the spatial domain (all mesh seeds approximately cover the unit sphere of their embedded space). </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00795">PolyMesh2d.f90:795</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_ga11edc13fe65bab9da5046f22850948f4"><div class="ttname"><a href="group___poly_mesh2d.html#ga11edc13fe65bab9da5046f22850948f4">polymesh2dmodule::pointisoutsidemesh</a></div><div class="ttdeci">logical(klog) function, public pointisoutsidemesh(self, xVec)</div><div class="ttdoc">Returns .TRUE. if a query point is outside the boundaries of a planar mesh. </div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00420">PolyMesh2d.f90:420</a></div></div>
<div class="ttc" id="group___number_kinds_html_ga25b568399757c4e2308aa806733bcd3d"><div class="ttname"><a href="group___number_kinds.html#ga25b568399757c4e2308aa806733bcd3d">numberkindsmodule::quad_rect_periodic_seed</a></div><div class="ttdeci">integer(kint), parameter quad_rect_periodic_seed</div><div class="ttdef"><b>Definition:</b> <a href="_number_kinds_8f90_source.html#l00066">NumberKinds.f90:66</a></div></div>
<div class="ttc" id="group___beta_plane_html_gaabc280102971514bee5e54008a9ee46b"><div class="ttname"><a href="group___beta_plane.html#gaabc280102971514bee5e54008a9ee46b">betaplanemeshmodule::copy::copyprivate</a></div><div class="ttdeci">subroutine copyprivate(self, other)</div><div class="ttdef"><b>Definition:</b> <a href="_beta_plane_8f90_source.html#l00163">BetaPlane.f90:163</a></div></div>
<div class="ttc" id="group___poly_mesh2d_html_gafea011e46aebdf0fe0d921c625d66ee5"><div class="ttname"><a href="group___poly_mesh2d.html#gafea011e46aebdf0fe0d921c625d66ee5">polymesh2dmodule::ccwadjacentfaces</a></div><div class="ttdeci">subroutine, public ccwadjacentfaces(self, adjFaces, faceIndex)</div><div class="ttdoc">Returns an STDIntVector containing indices of Faces adjacent to a face, listed in counter-clockwise o...</div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00471">PolyMesh2d.f90:471</a></div></div>
<div class="ttc" id="group___edges_html_gae1df14f49a6c66b9c7383b4b591f0f43"><div class="ttname"><a href="group___edges.html#gae1df14f49a6c66b9c7383b4b591f0f43">edgesmodule::maxedgelength</a></div><div class="ttdeci">real(kreal) function, public maxedgelength(self, aParticles)</div><div class="ttdoc">Computes the maximum edge length amongst all leaf edges. </div><div class="ttdef"><b>Definition:</b> <a href="_edges_8f90_source.html#l00253">Edges.f90:253</a></div></div>
<div class="ttc" id="classplanegeommodule_html"><div class="ttname"><a href="classplanegeommodule.html">planegeommodule</a></div><div class="ttdef"><b>Definition:</b> <a href="_plane_geometry_8f90_source.html#l00001">PlaneGeometry.f90:1</a></div></div>
<div class="ttc" id="interfacepolymesh2dmodule_1_1printdebuginfo_html"><div class="ttname"><a href="interfacepolymesh2dmodule_1_1printdebuginfo.html">polymesh2dmodule::printdebuginfo</a></div><div class="ttdef"><b>Definition:</b> <a href="_poly_mesh2d_8f90_source.html#l00115">PolyMesh2d.f90:115</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 11 2016 16:40:08 for LPM: Lagrangian Particle Methods by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
