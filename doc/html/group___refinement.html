<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>LPM: Lagrangian Particle Methods: Refinement</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LPM: Lagrangian Particle Methods
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">PDE solver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Refinement</div>  </div>
</div><!--header-->
<div class="contents">

<p>Data structure and methods for adaptively refining <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> objects.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Data structure and methods for adaptively refining <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> objects. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacerefinementmodule_1_1new.html">refinementmodule::new</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacerefinementmodule_1_1delete.html">refinementmodule::delete</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacerefinementmodule_1_1_flag_function.html">refinementmodule::FlagFunction</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic interface to a function that flags <a class="el" href="group___faces.html">Faces</a> for refinement.  <a href="interfacerefinementmodule_1_1_flag_function.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:gac4c01927f510cc7777bafa583dcb98c3"><td class="memItemLeft" align="right" valign="top">final&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#gac4c01927f510cc7777bafa583dcb98c3">refinementmodule::refinesetup::deleteprivate</a></td></tr>
<tr class="separator:gac4c01927f510cc7777bafa583dcb98c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3fa875bf35c2d46d068be4e4f9239256"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#ga3fa875bf35c2d46d068be4e4f9239256">refinementmodule::new::newprivate</a> (self, nMaxFaces)</td></tr>
<tr class="memdesc:ga3fa875bf35c2d46d068be4e4f9239256"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates memory for a RefineSetup object.  <a href="#ga3fa875bf35c2d46d068be4e4f9239256">More...</a><br /></td></tr>
<tr class="separator:ga3fa875bf35c2d46d068be4e4f9239256"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa873457e785c2b0b49c7794a6d160bfc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#gaa873457e785c2b0b49c7794a6d160bfc">refinementmodule::delete::deleteprivate</a> (self)</td></tr>
<tr class="memdesc:gaa873457e785c2b0b49c7794a6d160bfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes and frees memory associated with a RefineSetup object.  <a href="#gaa873457e785c2b0b49c7794a6d160bfc">More...</a><br /></td></tr>
<tr class="separator:gaa873457e785c2b0b49c7794a6d160bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga044065c8756a96337b8d0b724a5ce90f"><td class="memItemLeft" align="right" valign="top">logical(klog) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#ga044065c8756a96337b8d0b724a5ce90f">refinementmodule::FlagFunction::flagfunction</a> (mesh, dataField, tolerance, faceIndex)</td></tr>
<tr class="separator:ga044065c8756a96337b8d0b724a5ce90f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad5618f7b6077acd799be2ec2724b345f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#gad5618f7b6077acd799be2ec2724b345f">refinementmodule::newprivate</a> (self, nMaxFaces)</td></tr>
<tr class="memdesc:gad5618f7b6077acd799be2ec2724b345f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates memory for a RefineSetup object.  <a href="#gad5618f7b6077acd799be2ec2724b345f">More...</a><br /></td></tr>
<tr class="separator:gad5618f7b6077acd799be2ec2724b345f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae93c435bc2b2b66f2aa27cab286a0dd4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#gae93c435bc2b2b66f2aa27cab286a0dd4">refinementmodule::deleteprivate</a> (self)</td></tr>
<tr class="memdesc:gae93c435bc2b2b66f2aa27cab286a0dd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes and frees memory associated with a RefineSetup object.  <a href="#gae93c435bc2b2b66f2aa27cab286a0dd4">More...</a><br /></td></tr>
<tr class="separator:gae93c435bc2b2b66f2aa27cab286a0dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga850eb4e062f4d0f2313f9565c2bd972e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#ga850eb4e062f4d0f2313f9565c2bd972e">refinementmodule::divideflaggedfaces</a> (self, mesh)</td></tr>
<tr class="memdesc:ga850eb4e062f4d0f2313f9565c2bd972e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls the appropriate divide face subroutine on every flagged face. Note: New <a class="el" href="group___field.html">Field</a> values will need to be set after calling this routine for every new particle added here.  <a href="#ga850eb4e062f4d0f2313f9565c2bd972e">More...</a><br /></td></tr>
<tr class="separator:ga850eb4e062f4d0f2313f9565c2bd972e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga69845af6927bdbf1e4bb8b79d696195b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#ga69845af6927bdbf1e4bb8b79d696195b">refinementmodule::iteratemeshrefinementonevariable</a> (self, aMesh, aField, flagFn, tol, desc, nParticlesStart, nParticlesEnd)</td></tr>
<tr class="memdesc:ga69845af6927bdbf1e4bb8b79d696195b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs one iteration of mesh refinement using one criterion for one field variable.  <a href="#ga69845af6927bdbf1e4bb8b79d696195b">More...</a><br /></td></tr>
<tr class="separator:ga69845af6927bdbf1e4bb8b79d696195b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ca4c65b2e2c7bab9c522c8d4dcb41cc"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#ga3ca4c65b2e2c7bab9c522c8d4dcb41cc">refinementmodule::iteratemeshrefinementtwovariables</a> (self, aMesh, field1, flagFn1, tol1, desc1, field2, flagFn2, tol2, desc2, nParticlesStart, nParticlesEnd)</td></tr>
<tr class="memdesc:ga3ca4c65b2e2c7bab9c522c8d4dcb41cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs one iteration of mesh refinement using two criteria with two field variables.  <a href="#ga3ca4c65b2e2c7bab9c522c8d4dcb41cc">More...</a><br /></td></tr>
<tr class="separator:ga3ca4c65b2e2c7bab9c522c8d4dcb41cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1d0888022ca5062e962501c174ad88e5"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#ga1d0888022ca5062e962501c174ad88e5">refinementmodule::iteratemeshrefinementtwovariablesandflowmap</a> (self, aMesh, field1, flagFn1, tol1, desc1, field2, flagFn2, tol2, desc2, flowMapVarTol, nParticlesStart, nParticlesEnd)</td></tr>
<tr class="memdesc:ga1d0888022ca5062e962501c174ad88e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs one iteration of mesh refinement using two criteria with two field variables and flow map refinement.  <a href="#ga1d0888022ca5062e962501c174ad88e5">More...</a><br /></td></tr>
<tr class="separator:ga1d0888022ca5062e962501c174ad88e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad289956999f59972ec00e4be5f84742b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#gad289956999f59972ec00e4be5f84742b">refinementmodule::iteratemeshrefinementonevariableandflowmap</a> (self, aMesh, aField, flagFn, tol, desc, flowMapVarTol, nParticlesStart, nParticlesEnd)</td></tr>
<tr class="memdesc:gad289956999f59972ec00e4be5f84742b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs one iteration of mesh refinement using one criterion for one field variable and flow map refinement.  <a href="#gad289956999f59972ec00e4be5f84742b">More...</a><br /></td></tr>
<tr class="separator:gad289956999f59972ec00e4be5f84742b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef9ccbdf5d419fd3a6bb93b6adca0afe"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#gaef9ccbdf5d419fd3a6bb93b6adca0afe">refinementmodule::iteratemeshrefinementforflowmap</a> (self, aMesh, flowMapVarTol, nParticlesStart, nParticlesEnd)</td></tr>
<tr class="memdesc:gaef9ccbdf5d419fd3a6bb93b6adca0afe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs one iteration of mesh refinement using flow map refinement.  <a href="#gaef9ccbdf5d419fd3a6bb93b6adca0afe">More...</a><br /></td></tr>
<tr class="separator:gaef9ccbdf5d419fd3a6bb93b6adca0afe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf0656252394327c266a5d60d04eb057b"><td class="memItemLeft" align="right" valign="top">logical(klog) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#gaf0656252394327c266a5d60d04eb057b">refinementmodule::scalarintegralrefinement</a> (mesh, dataField, tol, faceIndex)</td></tr>
<tr class="memdesc:gaf0656252394327c266a5d60d04eb057b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Example Flag Function to refine panels whose scalar <a class="el" href="group___field.html">Field</a> integrals exceed a given tolerance.  <a href="#gaf0656252394327c266a5d60d04eb057b">More...</a><br /></td></tr>
<tr class="separator:gaf0656252394327c266a5d60d04eb057b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac4700fa1813a582514463242ae21369f"><td class="memItemLeft" align="right" valign="top">logical(klog) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#gac4700fa1813a582514463242ae21369f">refinementmodule::scalarvariationrefinement</a> (mesh, dataField, tol, faceIndex)</td></tr>
<tr class="memdesc:gac4700fa1813a582514463242ae21369f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Example Flag Function to refine panels whose scalar <a class="el" href="group___field.html">Field</a> variation per face exceed a given tolerance.  <a href="#gac4700fa1813a582514463242ae21369f">More...</a><br /></td></tr>
<tr class="separator:gac4700fa1813a582514463242ae21369f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga63f6791ee32cdeede413d5fc08e32aa1"><td class="memItemLeft" align="right" valign="top">logical(klog) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#ga63f6791ee32cdeede413d5fc08e32aa1">refinementmodule::flowmapvariationrefinement</a> (mesh, tol, faceIndex)</td></tr>
<tr class="memdesc:ga63f6791ee32cdeede413d5fc08e32aa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag Function to refine panels whose Lagrangian coordinate variation per face exceed a given tolerance.  <a href="#ga63f6791ee32cdeede413d5fc08e32aa1">More...</a><br /></td></tr>
<tr class="separator:ga63f6791ee32cdeede413d5fc08e32aa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4847bf4c976cad3ed0d8b4a7136bbb3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#gae4847bf4c976cad3ed0d8b4a7136bbb3">refinementmodule::initlogger</a> (aLog, rank)</td></tr>
<tr class="memdesc:gae4847bf4c976cad3ed0d8b4a7136bbb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a logger for the Refinement module.  <a href="#gae4847bf4c976cad3ed0d8b4a7136bbb3">More...</a><br /></td></tr>
<tr class="separator:gae4847bf4c976cad3ed0d8b4a7136bbb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gaf15b4507daa011b4f3719472674edcbf"><td class="memItemLeft" align="right" valign="top">logical(klog), dimension(:), <br class="typebreak" />
pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#gaf15b4507daa011b4f3719472674edcbf">refinementmodule::refinesetup::refineflag</a> =&gt; null()</td></tr>
<tr class="memdesc:gaf15b4507daa011b4f3719472674edcbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Face i will be refined if <code>refineSetup%refineFlag(i) = .TRUE.</code>  <a href="#gaf15b4507daa011b4f3719472674edcbf">More...</a><br /></td></tr>
<tr class="separator:gaf15b4507daa011b4f3719472674edcbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga68b8e3c6476efb1eb269903ad1e7e9ae"><td class="memItemLeft" align="right" valign="top">type(logger)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#ga68b8e3c6476efb1eb269903ad1e7e9ae">refinementmodule::log</a></td></tr>
<tr class="separator:ga68b8e3c6476efb1eb269903ad1e7e9ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23f850a99f38c7564e32b400de177605"><td class="memItemLeft" align="right" valign="top">character(len=28), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#ga23f850a99f38c7564e32b400de177605">refinementmodule::logkey</a> = 'Refine'</td></tr>
<tr class="separator:ga23f850a99f38c7564e32b400de177605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f0f9e5bad6fd3f1153736ca1385e7e0"><td class="memItemLeft" align="right" valign="top">character(len=max_string_length)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#ga4f0f9e5bad6fd3f1153736ca1385e7e0">refinementmodule::logstring</a></td></tr>
<tr class="separator:ga4f0f9e5bad6fd3f1153736ca1385e7e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad142138c94fa45a164444e296eda3e0f"><td class="memItemLeft" align="right" valign="top">integer(kint), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___refinement.html#gad142138c94fa45a164444e296eda3e0f">refinementmodule::loglevel</a> = DEBUG_LOGGING_LEVEL</td></tr>
<tr class="separator:gad142138c94fa45a164444e296eda3e0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="gae93c435bc2b2b66f2aa27cab286a0dd4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine refinementmodule::deleteprivate </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structrefinementmodule_1_1refinesetup.html">refinesetup</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deletes and frees memory associated with a RefineSetup object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>Target RefineSetup object </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00103">103</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

</div>
</div>
<a class="anchor" id="gac4c01927f510cc7777bafa583dcb98c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">final refinementmodule::refinesetup::deleteprivate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00041">41</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

<p>References <a class="el" href="_beta_plane_8f90_source.html#l00055">betaplanemeshmodule::betaplanemesh::deleteprivate()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___refinement_gac4c01927f510cc7777bafa583dcb98c3_cgraph.png" border="0" usemap="#group___refinement_gac4c01927f510cc7777bafa583dcb98c3_cgraph" alt=""/></div>
<map name="group___refinement_gac4c01927f510cc7777bafa583dcb98c3_cgraph" id="group___refinement_gac4c01927f510cc7777bafa583dcb98c3_cgraph">
<area shape="rect" id="node2" href="group___beta_plane.html#ga84602b5bc0f9100a75064e074f9432fc" title="betaplanemeshmodule\l::betaplanemesh::deleteprivate" alt="" coords="256,5,460,47"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaa873457e785c2b0b49c7794a6d160bfc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine refinementmodule::delete::deleteprivate </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structrefinementmodule_1_1refinesetup.html">refinesetup</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Deletes and frees memory associated with a RefineSetup object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>Target RefineSetup object </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00103">103</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

</div>
</div>
<a class="anchor" id="ga850eb4e062f4d0f2313f9565c2bd972e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine refinementmodule::divideflaggedfaces </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structrefinementmodule_1_1refinesetup.html">refinesetup</a>), intent(in)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(polymesh2d), intent(inout)&#160;</td>
          <td class="paramname"><em>mesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calls the appropriate divide face subroutine on every flagged face. Note: New <a class="el" href="group___field.html">Field</a> values will need to be set after calling this routine for every new particle added here. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">self</td><td>Target RefineSetup object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">mesh</td><td><a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> to be refined </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00113">113</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

<p>References <a class="el" href="_faces_8f90_source.html#l00529">facesmodule::dividequadface()</a>, <a class="el" href="_faces_8f90_source.html#l00701">facesmodule::dividetriface()</a>, <a class="el" href="_beta_plane_8f90_source.html#l00042">betaplanemeshmodule::betaplanemesh::mesh</a>, <a class="el" href="_number_kinds_8f90_source.html#l00050">numberkindsmodule::quad_panel</a>, and <a class="el" href="_number_kinds_8f90_source.html#l00051">numberkindsmodule::tri_panel</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___refinement_ga850eb4e062f4d0f2313f9565c2bd972e_cgraph.png" border="0" usemap="#group___refinement_ga850eb4e062f4d0f2313f9565c2bd972e_cgraph" alt=""/></div>
<map name="group___refinement_ga850eb4e062f4d0f2313f9565c2bd972e_cgraph" id="group___refinement_ga850eb4e062f4d0f2313f9565c2bd972e_cgraph">
<area shape="rect" id="node2" href="group___faces.html#gaee6c673285b09641f5a63f1f273f92f2" title="This is a primary subroutine used by any quadrilateral mesh (spherical or planar). It divides a quadrilateral face into 4 children, adding a 4 leaves to the faces quadtree. It creates new particles and new edges. It replaces divided edges with their appropriate children. " alt="" coords="300,385,495,412"/><area shape="rect" id="node22" href="group___faces.html#ga6bb2ead1ad72a0789a4eef0de7d2ac02" title="This is a primary subroutine used by any triangular mesh (spherical or planar). It divides a triangul..." alt="" coords="309,563,485,589"/><area shape="rect" id="node3" href="group___edges.html#ga7a0ad0d98da890af43aa04a3d88f6eee" title="Divides a parent edge, creating two child edges with the same orientation. " alt="" coords="583,360,757,387"/><area shape="rect" id="node4" href="group___particles.html#gaf5dfbd586cef1f9579376c4624c65b02" title="Inserts a single particle into a particles object. " alt="" coords="888,208,1087,235"/><area shape="rect" id="node5" href="group___particles.html#gad4afc4ad448d5d077be29dd1a7d1cc21" title="Returns a particle&#39;s Lagrangian coordinate vector. " alt="" coords="901,309,1074,336"/><area shape="rect" id="node6" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd" title="Returns a particle&#39;s physical coordinate vector. " alt="" coords="895,512,1079,539"/><area shape="rect" id="node14" href="group___edges.html#ga8102d56956d485a8dff75cb6d44d9195" title="Inserts an edge to the end of an edges object. Increase edges.N by one. " alt="" coords="584,461,756,488"/><area shape="rect" id="node15" href="group___particles.html#ga97eb338e7996e4802d747fd46ae6a298" title="Changes a passive particle to an active particle. Area/volume must be set separately. " alt="" coords="553,563,787,589"/><area shape="rect" id="node16" href="group___particles.html#ga035c6fec9878597f5412246e14c65d21" title="Changes an active particle to a passive particle. Area/volume may be set to zero separately. " alt="" coords="548,157,792,184"/><area shape="rect" id="node17" href="group___edges.html#ga03cc8cee87e4a23dbab6d7c95def2a4e" title="Returns .TRUE. if an edge has positive orientation relative to the selected face. ..." alt="" coords="578,613,762,640"/><area shape="rect" id="node18" href="group___plane_geom.html#ga297d26c2456e70f0ce79b8f3f643ddda" title="Cetroid of a quadrilateral created by four points in the plane. " alt="" coords="562,5,778,32"/><area shape="rect" id="node19" href="group___faces.html#ga6a872b75ce2c75e9f4d39c2ec44a367e" title="Determines the area of a quadrilateral face. Assumes the face has exactly 4 edges (Does not account f..." alt="" coords="577,512,763,539"/><area shape="rect" id="node21" href="group___sphere_geom.html#gaa449530ffa9bbaabafaff887f256b312" title="Finds the centroid of a spherical quadrilateral defined by four vertices. " alt="" coords="543,56,797,83"/><area shape="rect" id="node7" href="group___edges.html#gaa19f8588f987ef9300c94d5d464e0897" title="Records the index of an incident edge at its origin and destination particles. Enables dual mesh func..." alt="" coords="845,461,1129,488"/><area shape="rect" id="node12" href="group___edges.html#gaee5fff12baf37d99e8f2c9253dc2ff78" title="Replaces an edge recorded at its incident particles with the appropriate child edge index..." alt="" coords="847,411,1127,437"/><area shape="rect" id="node13" href="group___sphere_geom.html#gada71f0f28555055e323c24616b4e18f3" title="midpoint of a great&#45;circle segment connecting two points on the sphere " alt="" coords="868,360,1107,387"/><area shape="rect" id="node8" href="group___edges.html#ga284221d2767ec33c138d0b4411354cbf" title="Determines the angle of edge at edgeIndex relative to the positive x&#45;direction (for planar geometry) ..." alt="" coords="1177,436,1385,463"/><area shape="rect" id="node11" href="group___edges.html#gaba173030006ee81a8748e63f421eb5ae" title="Determines the angle relative to the positive x&#45;direction (for planar geometry) or the angle relative..." alt="" coords="1179,487,1384,513"/><area shape="rect" id="node9" href="group___sphere_geom.html#gae761eafa99d3fb63198828714880743d" title="Computes a vector cross product. " alt="" coords="1433,436,1657,463"/><area shape="rect" id="node10" href="group___edges.html#ga2016b49baf2784f69be4604c3968c383" title="Returns a vector pointing from an edge&#39;s origin particle to its destination particle. " alt="" coords="1457,487,1633,513"/><area shape="rect" id="node20" href="group___plane_geom.html#ga10de84dcd9fcf09d86cb544d7bdd4f9f" title="area of a planar triangle whose vertices are the input vectors " alt="" coords="899,639,1076,665"/><area shape="rect" id="node23" href="group___sphere_geom.html#ga84b61f121a82f260ac48915a6826663f" title="Finds the centroid of a spherical triangle defined by three vertices. " alt="" coords="552,765,788,792"/><area shape="rect" id="node24" href="group___plane_geom.html#ga64416ed494b2dc90ab24f1712db4154b" title="Cetroid of a triangle created by three points in the plane. " alt="" coords="571,816,769,843"/><area shape="rect" id="node25" href="group___faces.html#gacf7e3c70546c5d562a5a2de19f8553df" title="Determines the area of a triangular face. Assumes the face has exactly 3 edges (Does not account for ..." alt="" coords="586,715,754,741"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga044065c8756a96337b8d0b724a5ce90f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical(klog) function refinementmodule::FlagFunction::flagfunction </td>
          <td>(</td>
          <td class="paramtype">type(polymesh2d), intent(in)&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(field), intent(in)&#160;</td>
          <td class="paramname"><em>dataField</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(in)&#160;</td>
          <td class="paramname"><em>faceIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00058">58</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

</div>
</div>
<a class="anchor" id="ga63f6791ee32cdeede413d5fc08e32aa1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical(klog) function refinementmodule::flowmapvariationrefinement </td>
          <td>(</td>
          <td class="paramtype">type(polymesh2d), intent(in)&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(in)&#160;</td>
          <td class="paramname"><em>faceIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag Function to refine panels whose Lagrangian coordinate variation per face exceed a given tolerance. </p>
<p>The variation of the Lagrangian coordinates in face F_j is computed as \( \sum_{i=1}^3 \left(\max_{F_j} x0_i - \min_{F_j} x0_i\right) \), where the max and min are simply the maximum and minimum values of the Lagrangian coordinate components carried by all particles associated with face F_j (center and vertices).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td><a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>tolerance value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faceIndex</td><td>face to flag, if tolerance is exceeded </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Flag value </dd></dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00521">521</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

<p>References <a class="el" href="_particles_8f90_source.html#l00616">particlesmodule::lagcoord()</a>, and <a class="el" href="_beta_plane_8f90_source.html#l00042">betaplanemeshmodule::betaplanemesh::mesh</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___refinement_ga63f6791ee32cdeede413d5fc08e32aa1_cgraph.png" border="0" usemap="#group___refinement_ga63f6791ee32cdeede413d5fc08e32aa1_cgraph" alt=""/></div>
<map name="group___refinement_ga63f6791ee32cdeede413d5fc08e32aa1_cgraph" id="group___refinement_ga63f6791ee32cdeede413d5fc08e32aa1_cgraph">
<area shape="rect" id="node2" href="group___particles.html#gad4afc4ad448d5d077be29dd1a7d1cc21" title="Returns a particle&#39;s Lagrangian coordinate vector. " alt="" coords="352,5,525,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gae4847bf4c976cad3ed0d8b4a7136bbb3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine refinementmodule::initlogger </td>
          <td>(</td>
          <td class="paramtype">type(logger), intent(out)&#160;</td>
          <td class="paramname"><em>aLog</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(in)&#160;</td>
          <td class="paramname"><em>rank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a logger for the Refinement module. </p>
<p>Output is controlled both by message priority and by MPI Rank </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aLog</td><td>Target Logger object </td></tr>
    <tr><td class="paramname">rank</td><td>Rank of this processor </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00557">557</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

</div>
</div>
<a class="anchor" id="gaef9ccbdf5d419fd3a6bb93b6adca0afe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public refinementmodule::iteratemeshrefinementforflowmap </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structrefinementmodule_1_1refinesetup.html">refinesetup</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(polymesh2d), intent(inout)&#160;</td>
          <td class="paramname"><em>aMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>flowMapVarTol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(out)&#160;</td>
          <td class="paramname"><em>nParticlesStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(out)&#160;</td>
          <td class="paramname"><em>nParticlesEnd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs one iteration of mesh refinement using flow map refinement. </p>
<p>One iteration of mesh refinement is performed in the following steps:</p><ul>
<li>Loops over all active faces in a <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a>, records faces flagged by the flag function</li>
<li>Divides flagged faces</li>
</ul>
<p>Following a call to this routine, all <a class="el" href="group___field.html">Field</a> objects that accompany the <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> that was refined need to be updated with new values at all new particles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>target RefineSetup object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aMesh</td><td>target <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> mesh to be refined </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flowMapVarTol</td><td>tolerance for maximum Lagrangian coordinate variation per face </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nParticlesStart</td><td>the number of particles in the mesh upon entry to this subroutine </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nParticlesEnd</td><td>the number of particles in the mesh upon exit from this subroutine </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00427">427</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

<p>References <a class="el" href="_refinement_8f90_source.html#l00113">refinementmodule::divideflaggedfaces()</a>, and <a class="el" href="_refinement_8f90_source.html#l00521">refinementmodule::flowmapvariationrefinement()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___refinement_gaef9ccbdf5d419fd3a6bb93b6adca0afe_cgraph.png" border="0" usemap="#group___refinement_gaef9ccbdf5d419fd3a6bb93b6adca0afe_cgraph" alt=""/></div>
<map name="group___refinement_gaef9ccbdf5d419fd3a6bb93b6adca0afe_cgraph" id="group___refinement_gaef9ccbdf5d419fd3a6bb93b6adca0afe_cgraph">
<area shape="rect" id="node2" href="group___refinement.html#ga850eb4e062f4d0f2313f9565c2bd972e" title="Calls the appropriate divide face subroutine on every flagged face. Note: New Field values will need ..." alt="" coords="413,537,659,564"/><area shape="rect" id="node27" href="group___refinement.html#ga63f6791ee32cdeede413d5fc08e32aa1" title="Flag Function to refine panels whose Lagrangian coordinate variation per face exceed a given toleranc..." alt="" coords="387,791,685,817"/><area shape="rect" id="node3" href="group___faces.html#gaee6c673285b09641f5a63f1f273f92f2" title="This is a primary subroutine used by any quadrilateral mesh (spherical or planar). It divides a quadrilateral face into 4 children, adding a 4 leaves to the faces quadtree. It creates new particles and new edges. It replaces divided edges with their appropriate children. " alt="" coords="733,335,928,361"/><area shape="rect" id="node23" href="group___faces.html#ga6bb2ead1ad72a0789a4eef0de7d2ac02" title="This is a primary subroutine used by any triangular mesh (spherical or planar). It divides a triangul..." alt="" coords="743,537,919,564"/><area shape="rect" id="node4" href="group___edges.html#ga7a0ad0d98da890af43aa04a3d88f6eee" title="Divides a parent edge, creating two child edges with the same orientation. " alt="" coords="1017,563,1190,589"/><area shape="rect" id="node5" href="group___particles.html#gaf5dfbd586cef1f9579376c4624c65b02" title="Inserts a single particle into a particles object. " alt="" coords="1321,208,1520,235"/><area shape="rect" id="node6" href="group___particles.html#gad4afc4ad448d5d077be29dd1a7d1cc21" title="Returns a particle&#39;s Lagrangian coordinate vector. " alt="" coords="1334,740,1507,767"/><area shape="rect" id="node7" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd" title="Returns a particle&#39;s physical coordinate vector. " alt="" coords="1329,461,1513,488"/><area shape="rect" id="node15" href="group___edges.html#ga8102d56956d485a8dff75cb6d44d9195" title="Inserts an edge to the end of an edges object. Increase edges.N by one. " alt="" coords="1017,613,1189,640"/><area shape="rect" id="node16" href="group___particles.html#ga97eb338e7996e4802d747fd46ae6a298" title="Changes a passive particle to an active particle. Area/volume must be set separately. " alt="" coords="987,360,1220,387"/><area shape="rect" id="node17" href="group___particles.html#ga035c6fec9878597f5412246e14c65d21" title="Changes an active particle to a passive particle. Area/volume may be set to zero separately. " alt="" coords="981,107,1225,133"/><area shape="rect" id="node18" href="group___edges.html#ga03cc8cee87e4a23dbab6d7c95def2a4e" title="Returns .TRUE. if an edge has positive orientation relative to the selected face. ..." alt="" coords="1011,411,1195,437"/><area shape="rect" id="node19" href="group___plane_geom.html#ga297d26c2456e70f0ce79b8f3f643ddda" title="Cetroid of a quadrilateral created by four points in the plane. " alt="" coords="995,157,1211,184"/><area shape="rect" id="node20" href="group___faces.html#ga6a872b75ce2c75e9f4d39c2ec44a367e" title="Determines the area of a quadrilateral face. Assumes the face has exactly 4 edges (Does not account f..." alt="" coords="1010,259,1197,285"/><area shape="rect" id="node22" href="group___sphere_geom.html#gaa449530ffa9bbaabafaff887f256b312" title="Finds the centroid of a spherical quadrilateral defined by four vertices. " alt="" coords="976,5,1231,32"/><area shape="rect" id="node8" href="group___edges.html#gaa19f8588f987ef9300c94d5d464e0897" title="Records the index of an incident edge at its origin and destination particles. Enables dual mesh func..." alt="" coords="1279,613,1563,640"/><area shape="rect" id="node13" href="group___edges.html#gaee5fff12baf37d99e8f2c9253dc2ff78" title="Replaces an edge recorded at its incident particles with the appropriate child edge index..." alt="" coords="1281,512,1561,539"/><area shape="rect" id="node14" href="group___sphere_geom.html#gada71f0f28555055e323c24616b4e18f3" title="midpoint of a great&#45;circle segment connecting two points on the sphere " alt="" coords="1301,563,1540,589"/><area shape="rect" id="node9" href="group___edges.html#ga284221d2767ec33c138d0b4411354cbf" title="Determines the angle of edge at edgeIndex relative to the positive x&#45;direction (for planar geometry) ..." alt="" coords="1611,588,1819,615"/><area shape="rect" id="node12" href="group___edges.html#gaba173030006ee81a8748e63f421eb5ae" title="Determines the angle relative to the positive x&#45;direction (for planar geometry) or the angle relative..." alt="" coords="1612,639,1817,665"/><area shape="rect" id="node10" href="group___sphere_geom.html#gae761eafa99d3fb63198828714880743d" title="Computes a vector cross product. " alt="" coords="1867,588,2091,615"/><area shape="rect" id="node11" href="group___edges.html#ga2016b49baf2784f69be4604c3968c383" title="Returns a vector pointing from an edge&#39;s origin particle to its destination particle. " alt="" coords="1891,639,2067,665"/><area shape="rect" id="node21" href="group___plane_geom.html#ga10de84dcd9fcf09d86cb544d7bdd4f9f" title="area of a planar triangle whose vertices are the input vectors " alt="" coords="1332,335,1509,361"/><area shape="rect" id="node24" href="group___sphere_geom.html#ga84b61f121a82f260ac48915a6826663f" title="Finds the centroid of a spherical triangle defined by three vertices. " alt="" coords="985,715,1221,741"/><area shape="rect" id="node25" href="group___plane_geom.html#ga64416ed494b2dc90ab24f1712db4154b" title="Cetroid of a triangle created by three points in the plane. " alt="" coords="1005,765,1202,792"/><area shape="rect" id="node26" href="group___faces.html#gacf7e3c70546c5d562a5a2de19f8553df" title="Determines the area of a triangular face. Assumes the face has exactly 3 edges (Does not account for ..." alt="" coords="1019,461,1187,488"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga69845af6927bdbf1e4bb8b79d696195b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public refinementmodule::iteratemeshrefinementonevariable </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structrefinementmodule_1_1refinesetup.html">refinesetup</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(polymesh2d), intent(inout)&#160;</td>
          <td class="paramname"><em>aMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(field), intent(in)&#160;</td>
          <td class="paramname"><em>aField</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">procedure(flagfunction)&#160;</td>
          <td class="paramname"><em>flagFn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(out)&#160;</td>
          <td class="paramname"><em>nParticlesStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(out)&#160;</td>
          <td class="paramname"><em>nParticlesEnd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs one iteration of mesh refinement using one criterion for one field variable. </p>
<p>One iteration of mesh refinement is performed in the following steps:</p><ul>
<li>Loops over all active faces in a <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a>, records faces flagged by the flag function</li>
<li>Divides flagged faces</li>
</ul>
<p>Following a call to this routine, all <a class="el" href="group___field.html">Field</a> objects that accompany the <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> that was refined need to be updated with new values at all new particles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>target RefineSetup object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aMesh</td><td>target <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> mesh to be refined </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aField</td><td><a class="el" href="group___field.html">Field</a> whose values will be used to flag faces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flagFn</td><td>Flag function, must have same interface as <a class="el" href="interfacerefinementmodule_1_1_flag_function.html" title="Generic interface to a function that flags Faces for refinement. ">refinementmodule::FlagFunction</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>tolerance value for use with Flag Function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desc</td><td>String describing the type of refinement </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nParticlesStart</td><td>the number of particles in the mesh upon entry to this subroutine </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nParticlesEnd</td><td>the number of particles in the mesh upon exit from this subroutine </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00176">176</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

<p>References <a class="el" href="_refinement_8f90_source.html#l00113">refinementmodule::divideflaggedfaces()</a>, and <a class="el" href="_refinement_8f90_source.html#l00058">refinementmodule::FlagFunction::flagfunction()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___refinement_ga69845af6927bdbf1e4bb8b79d696195b_cgraph.png" border="0" usemap="#group___refinement_ga69845af6927bdbf1e4bb8b79d696195b_cgraph" alt=""/></div>
<map name="group___refinement_ga69845af6927bdbf1e4bb8b79d696195b_cgraph" id="group___refinement_ga69845af6927bdbf1e4bb8b79d696195b_cgraph">
<area shape="rect" id="node2" href="group___refinement.html#ga850eb4e062f4d0f2313f9565c2bd972e" title="Calls the appropriate divide face subroutine on every flagged face. Note: New Field values will need ..." alt="" coords="391,461,637,488"/><area shape="rect" id="node27" href="group___refinement.html#ga044065c8756a96337b8d0b724a5ce90f" title="refinementmodule::FlagFunction\l::flagfunction" alt="" coords="407,513,621,554"/><area shape="rect" id="node3" href="group___faces.html#gaee6c673285b09641f5a63f1f273f92f2" title="This is a primary subroutine used by any quadrilateral mesh (spherical or planar). It divides a quadrilateral face into 4 children, adding a 4 leaves to the faces quadtree. It creates new particles and new edges. It replaces divided edges with their appropriate children. " alt="" coords="685,385,880,412"/><area shape="rect" id="node23" href="group___faces.html#ga6bb2ead1ad72a0789a4eef0de7d2ac02" title="This is a primary subroutine used by any triangular mesh (spherical or planar). It divides a triangul..." alt="" coords="695,563,871,589"/><area shape="rect" id="node4" href="group___edges.html#ga7a0ad0d98da890af43aa04a3d88f6eee" title="Divides a parent edge, creating two child edges with the same orientation. " alt="" coords="969,360,1142,387"/><area shape="rect" id="node5" href="group___particles.html#gaf5dfbd586cef1f9579376c4624c65b02" title="Inserts a single particle into a particles object. " alt="" coords="1273,208,1472,235"/><area shape="rect" id="node6" href="group___particles.html#gad4afc4ad448d5d077be29dd1a7d1cc21" title="Returns a particle&#39;s Lagrangian coordinate vector. " alt="" coords="1286,309,1459,336"/><area shape="rect" id="node7" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd" title="Returns a particle&#39;s physical coordinate vector. " alt="" coords="1281,512,1465,539"/><area shape="rect" id="node15" href="group___edges.html#ga8102d56956d485a8dff75cb6d44d9195" title="Inserts an edge to the end of an edges object. Increase edges.N by one. " alt="" coords="969,461,1141,488"/><area shape="rect" id="node16" href="group___particles.html#ga97eb338e7996e4802d747fd46ae6a298" title="Changes a passive particle to an active particle. Area/volume must be set separately. " alt="" coords="939,563,1172,589"/><area shape="rect" id="node17" href="group___particles.html#ga035c6fec9878597f5412246e14c65d21" title="Changes an active particle to a passive particle. Area/volume may be set to zero separately. " alt="" coords="933,157,1177,184"/><area shape="rect" id="node18" href="group___edges.html#ga03cc8cee87e4a23dbab6d7c95def2a4e" title="Returns .TRUE. if an edge has positive orientation relative to the selected face. ..." alt="" coords="963,613,1147,640"/><area shape="rect" id="node19" href="group___plane_geom.html#ga297d26c2456e70f0ce79b8f3f643ddda" title="Cetroid of a quadrilateral created by four points in the plane. " alt="" coords="947,5,1163,32"/><area shape="rect" id="node20" href="group___faces.html#ga6a872b75ce2c75e9f4d39c2ec44a367e" title="Determines the area of a quadrilateral face. Assumes the face has exactly 4 edges (Does not account f..." alt="" coords="962,512,1149,539"/><area shape="rect" id="node22" href="group___sphere_geom.html#gaa449530ffa9bbaabafaff887f256b312" title="Finds the centroid of a spherical quadrilateral defined by four vertices. " alt="" coords="928,56,1183,83"/><area shape="rect" id="node8" href="group___edges.html#gaa19f8588f987ef9300c94d5d464e0897" title="Records the index of an incident edge at its origin and destination particles. Enables dual mesh func..." alt="" coords="1231,461,1515,488"/><area shape="rect" id="node13" href="group___edges.html#gaee5fff12baf37d99e8f2c9253dc2ff78" title="Replaces an edge recorded at its incident particles with the appropriate child edge index..." alt="" coords="1233,411,1513,437"/><area shape="rect" id="node14" href="group___sphere_geom.html#gada71f0f28555055e323c24616b4e18f3" title="midpoint of a great&#45;circle segment connecting two points on the sphere " alt="" coords="1253,360,1492,387"/><area shape="rect" id="node9" href="group___edges.html#ga284221d2767ec33c138d0b4411354cbf" title="Determines the angle of edge at edgeIndex relative to the positive x&#45;direction (for planar geometry) ..." alt="" coords="1563,436,1771,463"/><area shape="rect" id="node12" href="group___edges.html#gaba173030006ee81a8748e63f421eb5ae" title="Determines the angle relative to the positive x&#45;direction (for planar geometry) or the angle relative..." alt="" coords="1564,487,1769,513"/><area shape="rect" id="node10" href="group___sphere_geom.html#gae761eafa99d3fb63198828714880743d" title="Computes a vector cross product. " alt="" coords="1819,436,2043,463"/><area shape="rect" id="node11" href="group___edges.html#ga2016b49baf2784f69be4604c3968c383" title="Returns a vector pointing from an edge&#39;s origin particle to its destination particle. " alt="" coords="1843,487,2019,513"/><area shape="rect" id="node21" href="group___plane_geom.html#ga10de84dcd9fcf09d86cb544d7bdd4f9f" title="area of a planar triangle whose vertices are the input vectors " alt="" coords="1284,639,1461,665"/><area shape="rect" id="node24" href="group___sphere_geom.html#ga84b61f121a82f260ac48915a6826663f" title="Finds the centroid of a spherical triangle defined by three vertices. " alt="" coords="937,765,1173,792"/><area shape="rect" id="node25" href="group___plane_geom.html#ga64416ed494b2dc90ab24f1712db4154b" title="Cetroid of a triangle created by three points in the plane. " alt="" coords="957,816,1154,843"/><area shape="rect" id="node26" href="group___faces.html#gacf7e3c70546c5d562a5a2de19f8553df" title="Determines the area of a triangular face. Assumes the face has exactly 3 edges (Does not account for ..." alt="" coords="971,715,1139,741"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gad289956999f59972ec00e4be5f84742b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public refinementmodule::iteratemeshrefinementonevariableandflowmap </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structrefinementmodule_1_1refinesetup.html">refinesetup</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(polymesh2d), intent(inout)&#160;</td>
          <td class="paramname"><em>aMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(field), intent(in)&#160;</td>
          <td class="paramname"><em>aField</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">procedure(flagfunction)&#160;</td>
          <td class="paramname"><em>flagFn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>flowMapVarTol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(out)&#160;</td>
          <td class="paramname"><em>nParticlesStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(out)&#160;</td>
          <td class="paramname"><em>nParticlesEnd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs one iteration of mesh refinement using one criterion for one field variable and flow map refinement. </p>
<p>One iteration of mesh refinement is performed in the following steps:</p><ul>
<li>Loops over all active faces in a <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a>, records faces flagged by the flag function</li>
<li>Divides flagged faces</li>
</ul>
<p>Following a call to this routine, all <a class="el" href="group___field.html">Field</a> objects that accompany the <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> that was refined need to be updated with new values at all new particles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>target RefineSetup object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aMesh</td><td>target <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> mesh to be refined </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aField</td><td><a class="el" href="group___field.html">Field</a> whose values will be used to flag faces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flagFn</td><td>Flag function, must have same interface as <a class="el" href="interfacerefinementmodule_1_1_flag_function.html" title="Generic interface to a function that flags Faces for refinement. ">refinementmodule::FlagFunction</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>tolerance value for use with Flag Function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desc</td><td>String describing the type of refinement </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flowMapVarTol</td><td>tolerance for maximum Lagrangian coordinate variation per face </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nParticlesStart</td><td>the number of particles in the mesh upon entry to this subroutine </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nParticlesEnd</td><td>the number of particles in the mesh upon exit from this subroutine </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00367">367</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

<p>References <a class="el" href="_refinement_8f90_source.html#l00113">refinementmodule::divideflaggedfaces()</a>, <a class="el" href="_refinement_8f90_source.html#l00058">refinementmodule::FlagFunction::flagfunction()</a>, and <a class="el" href="_refinement_8f90_source.html#l00521">refinementmodule::flowmapvariationrefinement()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___refinement_gad289956999f59972ec00e4be5f84742b_cgraph.png" border="0" usemap="#group___refinement_gad289956999f59972ec00e4be5f84742b_cgraph" alt=""/></div>
<map name="group___refinement_gad289956999f59972ec00e4be5f84742b_cgraph" id="group___refinement_gad289956999f59972ec00e4be5f84742b_cgraph">
<area shape="rect" id="node2" href="group___refinement.html#ga850eb4e062f4d0f2313f9565c2bd972e" title="Calls the appropriate divide face subroutine on every flagged face. Note: New Field values will need ..." alt="" coords="463,537,709,564"/><area shape="rect" id="node27" href="group___refinement.html#ga044065c8756a96337b8d0b724a5ce90f" title="refinementmodule::FlagFunction\l::flagfunction" alt="" coords="479,615,693,657"/><area shape="rect" id="node28" href="group___refinement.html#ga63f6791ee32cdeede413d5fc08e32aa1" title="Flag Function to refine panels whose Lagrangian coordinate variation per face exceed a given toleranc..." alt="" coords="757,840,1056,867"/><area shape="rect" id="node3" href="group___faces.html#gaee6c673285b09641f5a63f1f273f92f2" title="This is a primary subroutine used by any quadrilateral mesh (spherical or planar). It divides a quadrilateral face into 4 children, adding a 4 leaves to the faces quadtree. It creates new particles and new edges. It replaces divided edges with their appropriate children. " alt="" coords="809,335,1004,361"/><area shape="rect" id="node23" href="group___faces.html#ga6bb2ead1ad72a0789a4eef0de7d2ac02" title="This is a primary subroutine used by any triangular mesh (spherical or planar). It divides a triangul..." alt="" coords="819,537,995,564"/><area shape="rect" id="node4" href="group___edges.html#ga7a0ad0d98da890af43aa04a3d88f6eee" title="Divides a parent edge, creating two child edges with the same orientation. " alt="" coords="1145,563,1318,589"/><area shape="rect" id="node5" href="group___particles.html#gaf5dfbd586cef1f9579376c4624c65b02" title="Inserts a single particle into a particles object. " alt="" coords="1449,208,1648,235"/><area shape="rect" id="node6" href="group___particles.html#gad4afc4ad448d5d077be29dd1a7d1cc21" title="Returns a particle&#39;s Lagrangian coordinate vector. " alt="" coords="1462,740,1635,767"/><area shape="rect" id="node7" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd" title="Returns a particle&#39;s physical coordinate vector. " alt="" coords="1457,461,1641,488"/><area shape="rect" id="node15" href="group___edges.html#ga8102d56956d485a8dff75cb6d44d9195" title="Inserts an edge to the end of an edges object. Increase edges.N by one. " alt="" coords="1145,613,1317,640"/><area shape="rect" id="node16" href="group___particles.html#ga97eb338e7996e4802d747fd46ae6a298" title="Changes a passive particle to an active particle. Area/volume must be set separately. " alt="" coords="1115,360,1348,387"/><area shape="rect" id="node17" href="group___particles.html#ga035c6fec9878597f5412246e14c65d21" title="Changes an active particle to a passive particle. Area/volume may be set to zero separately. " alt="" coords="1109,107,1353,133"/><area shape="rect" id="node18" href="group___edges.html#ga03cc8cee87e4a23dbab6d7c95def2a4e" title="Returns .TRUE. if an edge has positive orientation relative to the selected face. ..." alt="" coords="1139,411,1323,437"/><area shape="rect" id="node19" href="group___plane_geom.html#ga297d26c2456e70f0ce79b8f3f643ddda" title="Cetroid of a quadrilateral created by four points in the plane. " alt="" coords="1123,157,1339,184"/><area shape="rect" id="node20" href="group___faces.html#ga6a872b75ce2c75e9f4d39c2ec44a367e" title="Determines the area of a quadrilateral face. Assumes the face has exactly 4 edges (Does not account f..." alt="" coords="1138,259,1325,285"/><area shape="rect" id="node22" href="group___sphere_geom.html#gaa449530ffa9bbaabafaff887f256b312" title="Finds the centroid of a spherical quadrilateral defined by four vertices. " alt="" coords="1104,5,1359,32"/><area shape="rect" id="node8" href="group___edges.html#gaa19f8588f987ef9300c94d5d464e0897" title="Records the index of an incident edge at its origin and destination particles. Enables dual mesh func..." alt="" coords="1407,613,1691,640"/><area shape="rect" id="node13" href="group___edges.html#gaee5fff12baf37d99e8f2c9253dc2ff78" title="Replaces an edge recorded at its incident particles with the appropriate child edge index..." alt="" coords="1409,512,1689,539"/><area shape="rect" id="node14" href="group___sphere_geom.html#gada71f0f28555055e323c24616b4e18f3" title="midpoint of a great&#45;circle segment connecting two points on the sphere " alt="" coords="1429,563,1668,589"/><area shape="rect" id="node9" href="group___edges.html#ga284221d2767ec33c138d0b4411354cbf" title="Determines the angle of edge at edgeIndex relative to the positive x&#45;direction (for planar geometry) ..." alt="" coords="1739,588,1947,615"/><area shape="rect" id="node12" href="group___edges.html#gaba173030006ee81a8748e63f421eb5ae" title="Determines the angle relative to the positive x&#45;direction (for planar geometry) or the angle relative..." alt="" coords="1740,639,1945,665"/><area shape="rect" id="node10" href="group___sphere_geom.html#gae761eafa99d3fb63198828714880743d" title="Computes a vector cross product. " alt="" coords="1995,588,2219,615"/><area shape="rect" id="node11" href="group___edges.html#ga2016b49baf2784f69be4604c3968c383" title="Returns a vector pointing from an edge&#39;s origin particle to its destination particle. " alt="" coords="2019,639,2195,665"/><area shape="rect" id="node21" href="group___plane_geom.html#ga10de84dcd9fcf09d86cb544d7bdd4f9f" title="area of a planar triangle whose vertices are the input vectors " alt="" coords="1460,335,1637,361"/><area shape="rect" id="node24" href="group___sphere_geom.html#ga84b61f121a82f260ac48915a6826663f" title="Finds the centroid of a spherical triangle defined by three vertices. " alt="" coords="1113,715,1349,741"/><area shape="rect" id="node25" href="group___plane_geom.html#ga64416ed494b2dc90ab24f1712db4154b" title="Cetroid of a triangle created by three points in the plane. " alt="" coords="1133,765,1330,792"/><area shape="rect" id="node26" href="group___faces.html#gacf7e3c70546c5d562a5a2de19f8553df" title="Determines the area of a triangular face. Assumes the face has exactly 3 edges (Does not account for ..." alt="" coords="1147,461,1315,488"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga3ca4c65b2e2c7bab9c522c8d4dcb41cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public refinementmodule::iteratemeshrefinementtwovariables </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structrefinementmodule_1_1refinesetup.html">refinesetup</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(polymesh2d), intent(inout)&#160;</td>
          <td class="paramname"><em>aMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(field), intent(in)&#160;</td>
          <td class="paramname"><em>field1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">procedure(flagfunction)&#160;</td>
          <td class="paramname"><em>flagFn1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>tol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>desc1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(field), intent(in)&#160;</td>
          <td class="paramname"><em>field2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">procedure(flagfunction)&#160;</td>
          <td class="paramname"><em>flagFn2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>tol2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>desc2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(out)&#160;</td>
          <td class="paramname"><em>nParticlesStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(out)&#160;</td>
          <td class="paramname"><em>nParticlesEnd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs one iteration of mesh refinement using two criteria with two field variables. </p>
<p>One iteration of mesh refinement is performed in the following steps:</p><ul>
<li>Loops over all active faces in a <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a>, records faces flagged by the flag functions</li>
<li>Divides flagged faces</li>
</ul>
<p>Following a call to this routine, all <a class="el" href="group___field.html">Field</a> objects that accompany the <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> that was refined need to be updated with new values at all new particles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>target RefineSetup object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aMesh</td><td>target <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> mesh to be refined </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field1</td><td>First <a class="el" href="group___field.html">Field</a> whose values will be used to flag faces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flagFn1</td><td>Flag function for use with field1, must have same interface as <a class="el" href="interfacerefinementmodule_1_1_flag_function.html" title="Generic interface to a function that flags Faces for refinement. ">refinementmodule::FlagFunction</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol1</td><td>tolerance value for use with first Flag Function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desc1</td><td>String describing the first type of refinement </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field2</td><td>Second <a class="el" href="group___field.html">Field</a> whose values will be used to flag faces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flagFn2</td><td>Flag function for use with field2, must have same interface as <a class="el" href="interfacerefinementmodule_1_1_flag_function.html" title="Generic interface to a function that flags Faces for refinement. ">refinementmodule::FlagFunction</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol2</td><td>tolerance value for use with second Flag Function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desc2</td><td>String describing the second type of refinement </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nParticlesStart</td><td>the number of particles in the mesh upon entry to this subroutine </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nParticlesEnd</td><td>the number of particles in the mesh upon exit from this subroutine </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00228">228</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

<p>References <a class="el" href="_refinement_8f90_source.html#l00113">refinementmodule::divideflaggedfaces()</a>, and <a class="el" href="_refinement_8f90_source.html#l00058">refinementmodule::FlagFunction::flagfunction()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___refinement_ga3ca4c65b2e2c7bab9c522c8d4dcb41cc_cgraph.png" border="0" usemap="#group___refinement_ga3ca4c65b2e2c7bab9c522c8d4dcb41cc_cgraph" alt=""/></div>
<map name="group___refinement_ga3ca4c65b2e2c7bab9c522c8d4dcb41cc_cgraph" id="group___refinement_ga3ca4c65b2e2c7bab9c522c8d4dcb41cc_cgraph">
<area shape="rect" id="node2" href="group___refinement.html#ga850eb4e062f4d0f2313f9565c2bd972e" title="Calls the appropriate divide face subroutine on every flagged face. Note: New Field values will need ..." alt="" coords="396,461,643,488"/><area shape="rect" id="node27" href="group___refinement.html#ga044065c8756a96337b8d0b724a5ce90f" title="refinementmodule::FlagFunction\l::flagfunction" alt="" coords="413,513,626,554"/><area shape="rect" id="node3" href="group___faces.html#gaee6c673285b09641f5a63f1f273f92f2" title="This is a primary subroutine used by any quadrilateral mesh (spherical or planar). It divides a quadrilateral face into 4 children, adding a 4 leaves to the faces quadtree. It creates new particles and new edges. It replaces divided edges with their appropriate children. " alt="" coords="691,385,885,412"/><area shape="rect" id="node23" href="group___faces.html#ga6bb2ead1ad72a0789a4eef0de7d2ac02" title="This is a primary subroutine used by any triangular mesh (spherical or planar). It divides a triangul..." alt="" coords="700,563,876,589"/><area shape="rect" id="node4" href="group___edges.html#ga7a0ad0d98da890af43aa04a3d88f6eee" title="Divides a parent edge, creating two child edges with the same orientation. " alt="" coords="974,360,1147,387"/><area shape="rect" id="node5" href="group___particles.html#gaf5dfbd586cef1f9579376c4624c65b02" title="Inserts a single particle into a particles object. " alt="" coords="1279,208,1477,235"/><area shape="rect" id="node6" href="group___particles.html#gad4afc4ad448d5d077be29dd1a7d1cc21" title="Returns a particle&#39;s Lagrangian coordinate vector. " alt="" coords="1291,309,1465,336"/><area shape="rect" id="node7" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd" title="Returns a particle&#39;s physical coordinate vector. " alt="" coords="1286,512,1470,539"/><area shape="rect" id="node15" href="group___edges.html#ga8102d56956d485a8dff75cb6d44d9195" title="Inserts an edge to the end of an edges object. Increase edges.N by one. " alt="" coords="975,461,1147,488"/><area shape="rect" id="node16" href="group___particles.html#ga97eb338e7996e4802d747fd46ae6a298" title="Changes a passive particle to an active particle. Area/volume must be set separately. " alt="" coords="944,563,1177,589"/><area shape="rect" id="node17" href="group___particles.html#ga035c6fec9878597f5412246e14c65d21" title="Changes an active particle to a passive particle. Area/volume may be set to zero separately. " alt="" coords="939,157,1183,184"/><area shape="rect" id="node18" href="group___edges.html#ga03cc8cee87e4a23dbab6d7c95def2a4e" title="Returns .TRUE. if an edge has positive orientation relative to the selected face. ..." alt="" coords="969,613,1153,640"/><area shape="rect" id="node19" href="group___plane_geom.html#ga297d26c2456e70f0ce79b8f3f643ddda" title="Cetroid of a quadrilateral created by four points in the plane. " alt="" coords="953,5,1169,32"/><area shape="rect" id="node20" href="group___faces.html#ga6a872b75ce2c75e9f4d39c2ec44a367e" title="Determines the area of a quadrilateral face. Assumes the face has exactly 4 edges (Does not account f..." alt="" coords="967,512,1154,539"/><area shape="rect" id="node22" href="group___sphere_geom.html#gaa449530ffa9bbaabafaff887f256b312" title="Finds the centroid of a spherical quadrilateral defined by four vertices. " alt="" coords="933,56,1188,83"/><area shape="rect" id="node8" href="group___edges.html#gaa19f8588f987ef9300c94d5d464e0897" title="Records the index of an incident edge at its origin and destination particles. Enables dual mesh func..." alt="" coords="1236,461,1520,488"/><area shape="rect" id="node13" href="group___edges.html#gaee5fff12baf37d99e8f2c9253dc2ff78" title="Replaces an edge recorded at its incident particles with the appropriate child edge index..." alt="" coords="1238,411,1518,437"/><area shape="rect" id="node14" href="group___sphere_geom.html#gada71f0f28555055e323c24616b4e18f3" title="midpoint of a great&#45;circle segment connecting two points on the sphere " alt="" coords="1259,360,1497,387"/><area shape="rect" id="node9" href="group___edges.html#ga284221d2767ec33c138d0b4411354cbf" title="Determines the angle of edge at edgeIndex relative to the positive x&#45;direction (for planar geometry) ..." alt="" coords="1568,436,1776,463"/><area shape="rect" id="node12" href="group___edges.html#gaba173030006ee81a8748e63f421eb5ae" title="Determines the angle relative to the positive x&#45;direction (for planar geometry) or the angle relative..." alt="" coords="1569,487,1775,513"/><area shape="rect" id="node10" href="group___sphere_geom.html#gae761eafa99d3fb63198828714880743d" title="Computes a vector cross product. " alt="" coords="1824,436,2048,463"/><area shape="rect" id="node11" href="group___edges.html#ga2016b49baf2784f69be4604c3968c383" title="Returns a vector pointing from an edge&#39;s origin particle to its destination particle. " alt="" coords="1848,487,2024,513"/><area shape="rect" id="node21" href="group___plane_geom.html#ga10de84dcd9fcf09d86cb544d7bdd4f9f" title="area of a planar triangle whose vertices are the input vectors " alt="" coords="1289,639,1467,665"/><area shape="rect" id="node24" href="group___sphere_geom.html#ga84b61f121a82f260ac48915a6826663f" title="Finds the centroid of a spherical triangle defined by three vertices. " alt="" coords="943,765,1179,792"/><area shape="rect" id="node25" href="group___plane_geom.html#ga64416ed494b2dc90ab24f1712db4154b" title="Cetroid of a triangle created by three points in the plane. " alt="" coords="962,816,1159,843"/><area shape="rect" id="node26" href="group___faces.html#gacf7e3c70546c5d562a5a2de19f8553df" title="Determines the area of a triangular face. Assumes the face has exactly 3 edges (Does not account for ..." alt="" coords="977,715,1145,741"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga1d0888022ca5062e962501c174ad88e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public refinementmodule::iteratemeshrefinementtwovariablesandflowmap </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structrefinementmodule_1_1refinesetup.html">refinesetup</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(polymesh2d), intent(inout)&#160;</td>
          <td class="paramname"><em>aMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(field), intent(in)&#160;</td>
          <td class="paramname"><em>field1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">procedure(flagfunction)&#160;</td>
          <td class="paramname"><em>flagFn1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>tol1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>desc1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(field), intent(in)&#160;</td>
          <td class="paramname"><em>field2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">procedure(flagfunction)&#160;</td>
          <td class="paramname"><em>flagFn2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>tol2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>desc2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>flowMapVarTol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(out)&#160;</td>
          <td class="paramname"><em>nParticlesStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(out)&#160;</td>
          <td class="paramname"><em>nParticlesEnd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs one iteration of mesh refinement using two criteria with two field variables and flow map refinement. </p>
<p>One iteration of mesh refinement is performed in the following steps:</p><ul>
<li>Loops over all active faces in a <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a>, records faces flagged by the flag functions</li>
<li>Divides flagged faces</li>
</ul>
<p>Following a call to this routine, all <a class="el" href="group___field.html">Field</a> objects that accompany the <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> that was refined need to be updated with new values at all new particles.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">self</td><td>target RefineSetup object </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aMesh</td><td>target <a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> mesh to be refined </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field1</td><td>First <a class="el" href="group___field.html">Field</a> whose values will be used to flag faces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flagFn1</td><td>Flag function for use with field1, must have same interface as <a class="el" href="interfacerefinementmodule_1_1_flag_function.html" title="Generic interface to a function that flags Faces for refinement. ">refinementmodule::FlagFunction</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol1</td><td>tolerance value for use with first Flag Function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desc1</td><td>String describing the first type of refinement </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field2</td><td>Second <a class="el" href="group___field.html">Field</a> whose values will be used to flag faces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flagFn2</td><td>Flag function for use with field2, must have same interface as <a class="el" href="interfacerefinementmodule_1_1_flag_function.html" title="Generic interface to a function that flags Faces for refinement. ">refinementmodule::FlagFunction</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol2</td><td>tolerance value for use with second Flag Function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desc2</td><td>String describing the second type of refinement </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flowMapVarTol</td><td>tolerance for maximum Lagrangian coordinate variation per face </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nParticlesStart</td><td>the number of particles in the mesh upon entry to this subroutine </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nParticlesEnd</td><td>the number of particles in the mesh upon exit from this subroutine </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00293">293</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

<p>References <a class="el" href="_refinement_8f90_source.html#l00113">refinementmodule::divideflaggedfaces()</a>, <a class="el" href="_refinement_8f90_source.html#l00058">refinementmodule::FlagFunction::flagfunction()</a>, and <a class="el" href="_refinement_8f90_source.html#l00521">refinementmodule::flowmapvariationrefinement()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___refinement_ga1d0888022ca5062e962501c174ad88e5_cgraph.png" border="0" usemap="#group___refinement_ga1d0888022ca5062e962501c174ad88e5_cgraph" alt=""/></div>
<map name="group___refinement_ga1d0888022ca5062e962501c174ad88e5_cgraph" id="group___refinement_ga1d0888022ca5062e962501c174ad88e5_cgraph">
<area shape="rect" id="node2" href="group___refinement.html#ga850eb4e062f4d0f2313f9565c2bd972e" title="Calls the appropriate divide face subroutine on every flagged face. Note: New Field values will need ..." alt="" coords="468,537,715,564"/><area shape="rect" id="node27" href="group___refinement.html#ga044065c8756a96337b8d0b724a5ce90f" title="refinementmodule::FlagFunction\l::flagfunction" alt="" coords="485,615,698,657"/><area shape="rect" id="node28" href="group___refinement.html#ga63f6791ee32cdeede413d5fc08e32aa1" title="Flag Function to refine panels whose Lagrangian coordinate variation per face exceed a given toleranc..." alt="" coords="763,840,1061,867"/><area shape="rect" id="node3" href="group___faces.html#gaee6c673285b09641f5a63f1f273f92f2" title="This is a primary subroutine used by any quadrilateral mesh (spherical or planar). It divides a quadrilateral face into 4 children, adding a 4 leaves to the faces quadtree. It creates new particles and new edges. It replaces divided edges with their appropriate children. " alt="" coords="815,335,1009,361"/><area shape="rect" id="node23" href="group___faces.html#ga6bb2ead1ad72a0789a4eef0de7d2ac02" title="This is a primary subroutine used by any triangular mesh (spherical or planar). It divides a triangul..." alt="" coords="824,537,1000,564"/><area shape="rect" id="node4" href="group___edges.html#ga7a0ad0d98da890af43aa04a3d88f6eee" title="Divides a parent edge, creating two child edges with the same orientation. " alt="" coords="1150,563,1323,589"/><area shape="rect" id="node5" href="group___particles.html#gaf5dfbd586cef1f9579376c4624c65b02" title="Inserts a single particle into a particles object. " alt="" coords="1455,208,1653,235"/><area shape="rect" id="node6" href="group___particles.html#gad4afc4ad448d5d077be29dd1a7d1cc21" title="Returns a particle&#39;s Lagrangian coordinate vector. " alt="" coords="1467,740,1641,767"/><area shape="rect" id="node7" href="group___particles.html#ga2d7dd758e03af6213d9b451bea2cd9cd" title="Returns a particle&#39;s physical coordinate vector. " alt="" coords="1462,461,1646,488"/><area shape="rect" id="node15" href="group___edges.html#ga8102d56956d485a8dff75cb6d44d9195" title="Inserts an edge to the end of an edges object. Increase edges.N by one. " alt="" coords="1151,613,1323,640"/><area shape="rect" id="node16" href="group___particles.html#ga97eb338e7996e4802d747fd46ae6a298" title="Changes a passive particle to an active particle. Area/volume must be set separately. " alt="" coords="1120,360,1353,387"/><area shape="rect" id="node17" href="group___particles.html#ga035c6fec9878597f5412246e14c65d21" title="Changes an active particle to a passive particle. Area/volume may be set to zero separately. " alt="" coords="1115,107,1359,133"/><area shape="rect" id="node18" href="group___edges.html#ga03cc8cee87e4a23dbab6d7c95def2a4e" title="Returns .TRUE. if an edge has positive orientation relative to the selected face. ..." alt="" coords="1145,411,1329,437"/><area shape="rect" id="node19" href="group___plane_geom.html#ga297d26c2456e70f0ce79b8f3f643ddda" title="Cetroid of a quadrilateral created by four points in the plane. " alt="" coords="1129,157,1345,184"/><area shape="rect" id="node20" href="group___faces.html#ga6a872b75ce2c75e9f4d39c2ec44a367e" title="Determines the area of a quadrilateral face. Assumes the face has exactly 4 edges (Does not account f..." alt="" coords="1143,259,1330,285"/><area shape="rect" id="node22" href="group___sphere_geom.html#gaa449530ffa9bbaabafaff887f256b312" title="Finds the centroid of a spherical quadrilateral defined by four vertices. " alt="" coords="1109,5,1364,32"/><area shape="rect" id="node8" href="group___edges.html#gaa19f8588f987ef9300c94d5d464e0897" title="Records the index of an incident edge at its origin and destination particles. Enables dual mesh func..." alt="" coords="1412,613,1696,640"/><area shape="rect" id="node13" href="group___edges.html#gaee5fff12baf37d99e8f2c9253dc2ff78" title="Replaces an edge recorded at its incident particles with the appropriate child edge index..." alt="" coords="1414,512,1694,539"/><area shape="rect" id="node14" href="group___sphere_geom.html#gada71f0f28555055e323c24616b4e18f3" title="midpoint of a great&#45;circle segment connecting two points on the sphere " alt="" coords="1435,563,1673,589"/><area shape="rect" id="node9" href="group___edges.html#ga284221d2767ec33c138d0b4411354cbf" title="Determines the angle of edge at edgeIndex relative to the positive x&#45;direction (for planar geometry) ..." alt="" coords="1744,588,1952,615"/><area shape="rect" id="node12" href="group___edges.html#gaba173030006ee81a8748e63f421eb5ae" title="Determines the angle relative to the positive x&#45;direction (for planar geometry) or the angle relative..." alt="" coords="1745,639,1951,665"/><area shape="rect" id="node10" href="group___sphere_geom.html#gae761eafa99d3fb63198828714880743d" title="Computes a vector cross product. " alt="" coords="2000,588,2224,615"/><area shape="rect" id="node11" href="group___edges.html#ga2016b49baf2784f69be4604c3968c383" title="Returns a vector pointing from an edge&#39;s origin particle to its destination particle. " alt="" coords="2024,639,2200,665"/><area shape="rect" id="node21" href="group___plane_geom.html#ga10de84dcd9fcf09d86cb544d7bdd4f9f" title="area of a planar triangle whose vertices are the input vectors " alt="" coords="1465,335,1643,361"/><area shape="rect" id="node24" href="group___sphere_geom.html#ga84b61f121a82f260ac48915a6826663f" title="Finds the centroid of a spherical triangle defined by three vertices. " alt="" coords="1119,715,1355,741"/><area shape="rect" id="node25" href="group___plane_geom.html#ga64416ed494b2dc90ab24f1712db4154b" title="Cetroid of a triangle created by three points in the plane. " alt="" coords="1138,765,1335,792"/><area shape="rect" id="node26" href="group___faces.html#gacf7e3c70546c5d562a5a2de19f8553df" title="Determines the area of a triangular face. Assumes the face has exactly 3 edges (Does not account for ..." alt="" coords="1153,461,1321,488"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gad5618f7b6077acd799be2ec2724b345f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine refinementmodule::newprivate </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structrefinementmodule_1_1refinesetup.html">refinesetup</a>), intent(out)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(in)&#160;</td>
          <td class="paramname"><em>nMaxFaces</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocates memory for a RefineSetup object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">self</td><td>Target RefineSetup object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nMaxFaces</td><td>number of maximum faces allowed in memory </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00091">91</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

<p>References <a class="el" href="_beta_plane_gaussian_vortex_8f90_source.html#l00323">initlogger()</a>, and <a class="el" href="_number_kinds_8f90_source.html#l00073">numberkindsmodule::procrank</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___refinement_gad5618f7b6077acd799be2ec2724b345f_cgraph.png" border="0" usemap="#group___refinement_gad5618f7b6077acd799be2ec2724b345f_cgraph" alt=""/></div>
<map name="group___refinement_gad5618f7b6077acd799be2ec2724b345f_cgraph" id="group___refinement_gad5618f7b6077acd799be2ec2724b345f_cgraph">
<area shape="rect" id="node2" href="_beta_plane_gaussian_vortex_8f90.html#ae520c3b11d9e6c51c35d5cd67b503523" title="initlogger" alt="" coords="253,5,329,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga3fa875bf35c2d46d068be4e4f9239256"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine refinementmodule::new::newprivate </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structrefinementmodule_1_1refinesetup.html">refinesetup</a>), intent(out)&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(in)&#160;</td>
          <td class="paramname"><em>nMaxFaces</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocates memory for a RefineSetup object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">self</td><td>Target RefineSetup object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nMaxFaces</td><td>number of maximum faces allowed in memory </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00091">91</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

</div>
</div>
<a class="anchor" id="gaf0656252394327c266a5d60d04eb057b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical(klog) function, public refinementmodule::scalarintegralrefinement </td>
          <td>(</td>
          <td class="paramtype">type(polymesh2d), intent(in)&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(field), intent(in)&#160;</td>
          <td class="paramname"><em>dataField</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(in)&#160;</td>
          <td class="paramname"><em>faceIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Example Flag Function to refine panels whose scalar <a class="el" href="group___field.html">Field</a> integrals exceed a given tolerance. </p>
<p>Scalar integrals on face i are approximated using the midpoint rule \( \int_{F_i} f(x)\,dx \approx \) <code>field%scalar(i) * field%area(i)</code>. If this value exceeds the tolerance, this function returns .TRUE.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td><a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataField</td><td>scalar <a class="el" href="group___field.html">Field</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>tolerance value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faceIndex</td><td>face to flag, if tolerance is exceeded </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Flag value </dd></dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00466">466</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

<p>References <a class="el" href="_beta_plane_8f90_source.html#l00042">betaplanemeshmodule::betaplanemesh::mesh</a>.</p>

</div>
</div>
<a class="anchor" id="gac4700fa1813a582514463242ae21369f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical(klog) function, public refinementmodule::scalarvariationrefinement </td>
          <td>(</td>
          <td class="paramtype">type(polymesh2d), intent(in)&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(field), intent(in)&#160;</td>
          <td class="paramname"><em>dataField</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kreal), intent(in)&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint), intent(in)&#160;</td>
          <td class="paramname"><em>faceIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Example Flag Function to refine panels whose scalar <a class="el" href="group___field.html">Field</a> variation per face exceed a given tolerance. </p>
<p>The scalar variation scalar f(x) of face F_i is computed as \( \max_{F_i} f(x) - \min_{F_i} f(x) \), where the max and min are simply the maximum and minimum values of the scalar field carried by all particles associated with face F_i (center and vertices).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td><a class="el" href="group___poly_mesh2d.html">PolyMesh2d</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataField</td><td>scalar <a class="el" href="group___field.html">Field</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>tolerance value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faceIndex</td><td>face to flag, if tolerance is exceeded </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Flag value </dd></dl>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00489">489</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

<p>References <a class="el" href="_poly_mesh2d_8f90_source.html#l00361">polymesh2dmodule::ccwverticesaroundface()</a>, and <a class="el" href="_beta_plane_8f90_source.html#l00042">betaplanemeshmodule::betaplanemesh::mesh</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___refinement_gac4700fa1813a582514463242ae21369f_cgraph.png" border="0" usemap="#group___refinement_gac4700fa1813a582514463242ae21369f_cgraph" alt=""/></div>
<map name="group___refinement_gac4700fa1813a582514463242ae21369f_cgraph" id="group___refinement_gac4700fa1813a582514463242ae21369f_cgraph">
<area shape="rect" id="node2" href="group___poly_mesh2d.html#gaec4398a712feb200a284a04c7da490ed" title="Returns an STDIntVector containing indices of vertex Particles around a face, listed in counter&#45;clock..." alt="" coords="339,31,619,57"/><area shape="rect" id="node3" href="group___poly_mesh2d.html#ga1117b877c1ee6f1d5f023adafdd9c4fc" title="Returns an STDIntVector containing indices of Edges around a face, listed in counter&#45;clockwise order..." alt="" coords="667,5,937,32"/><area shape="rect" id="node5" href="group___edges.html#ga03cc8cee87e4a23dbab6d7c95def2a4e" title="Returns .TRUE. if an edge has positive orientation relative to the selected face. ..." alt="" coords="710,56,894,83"/><area shape="rect" id="node4" href="group___edges.html#ga1d52efbbd14af28e7b9d83606cd664ce" title="Builds a STDIntVector containing the indices of all of an edge&#39;s children. " alt="" coords="985,5,1236,32"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ga68b8e3c6476efb1eb269903ad1e7e9ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">type(logger) refinementmodule::log</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00076">76</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

</div>
</div>
<a class="anchor" id="ga23f850a99f38c7564e32b400de177605"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=28), save refinementmodule::logkey = 'Refine'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00077">77</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

</div>
</div>
<a class="anchor" id="gad142138c94fa45a164444e296eda3e0f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(kint), parameter refinementmodule::loglevel = DEBUG_LOGGING_LEVEL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00079">79</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

</div>
</div>
<a class="anchor" id="ga4f0f9e5bad6fd3f1153736ca1385e7e0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">character(len=max_string_length) refinementmodule::logstring</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00078">78</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

</div>
</div>
<a class="anchor" id="gaf15b4507daa011b4f3719472674edcbf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical(klog), dimension(:), pointer refinementmodule::refinesetup::refineflag =&gt; null()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Face i will be refined if <code>refineSetup%refineFlag(i) = .TRUE.</code> </p>

<p>Definition at line <a class="el" href="_refinement_8f90_source.html#l00039">39</a> of file <a class="el" href="_refinement_8f90_source.html">Refinement.f90</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 7 2016 18:18:05 for LPM: Lagrangian Particle Methods by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
